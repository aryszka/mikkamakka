var env = (function () {
    var isSymbol = function (s) {
        return !!s &&
            s instanceof Array &&
            s.length === 1 &&
            typeof s[0] === "string";
    };

    var symbolName = function (symbol) {
        return symbol[0];
    };

    var stringToSymbol = function (name) {
        return [name];
    };

    var peq = function (left, right) {
        return left === right;
    };

    var filter = function (pred, l) {
        if (isNull(l)) {
            return list();
        }
        return pred(car(l)) ?
            cons(car(l), filter(pred, cdr(l))) :
            filter(pred, cdr(l));
    };

    var isTable = function (t) {
        return !!(t && t.isTable);
    };

    var makeNameTable = function () {
        var names = [];
        var table = {};
        var t = function (modNames, op) {
            names = modNames(names, table);
            return op(names, table);
        };
        t.isTable = true;
        return t;
    };

    var tableNoop = function (names, _) {
        return names;
    };

    var tableNames = function (table) {
        return table(tableNoop, tableNoop);
    };

    var tableHasName = function (table, name) {
        return table(tableNoop, function (_, table) {
            return symbolName(name) in table;
        });
    };

    var tableLookup = function (table, name) {
        return table(tableNoop, function (_, table) {
            name = symbolName(name);
            var val = table[name];
            if (val === undefined) {
                return cerror("tableLookup", "name is not defined", name);
            }
            return val;
        });
    };

    var tableDefine = function (table, name, val) {
        var sname = symbolName(name);
        return table(function (names, table) {
            return sname in table ? names : [name, names];
        }, function (_, table) {
            table[sname] = val;
            return val;
        });
    };

    var tableSet = function (table, name, val) {
        return table(tableNoop, function (_, table) {
            name = symbolName(name);
            if (!(name in table)) {
                return cerror("tableSet", "name is not defined", name);
            }
            table[name] = val;
            return val;
        });
    };

    var tableDelete = function (table, name) {
        return table(function (names, _) {
            return filter(function (i) { return i[0] !== name[0]; }, names);
        }, function (_, table) {
            var has = name[0] in table;
            delete table[name[0]];
            return has;
        });
    };

    var isNull = function (l) {
        return !!l &&
            l instanceof Array &&
            l.length === 0;
    };

    var cons = function (left, right) {
        return [left, right];
    };

    var isPair = function (p) {
        return !!p &&
            p instanceof Array &&
            p.length === 2;
    };

    var car = function (p) {
        return p[0];
    };

    var cdr = function (p) {
        return p[1];
    };

    var list = function () {
        var l = [];
        for (var i = arguments.length - 1; i >= 0; i--) {
            l = cons(arguments[i], l);
        }
        return l;
    };

    var isCompiledProcedure = function (p) {
        return !!p && typeof p === "function";
    };

    var capply = function (p, args) {
        var jsArgs = [];
        for (;;) {
            if (isNull(args)) {
                break;
            }
            jsArgs[jsArgs.length] = car(args);
            args = cdr(args);
        }
        return p.apply(undefined, jsArgs);
    };

    var tryc = function (t, c) {
        try {
            return env("apply")(t, list());
        } catch (error) {
            return env("apply")(c, list(error));
        }
    };

    var forLoop = function (body) {
        for (;;) {
            var result = env("apply")(body, list());
            if (false !== result) {
                return result;
            }
        }
    };

    var readFile = function (f, clb) {
        require("fs").readFile(f, function (err, data) {
            if (err) {
                return cerror("readFile", "error while reading file", err);
            }
            return env("apply")(clb, list(data.toString()));
        });
        return noPrint;
    };

    var readLine = function (clb, prompt) {
        var rl = require("readline").createInterface(process.stdin, process.stdout);
        var frl = function (f) {
            return f(rl);
        };
        rl.on("line", function (l) {
            env("apply")(clb, list(frl, l));
        });
        return frl;
    };

    var prompt = function (rl) {
        return rl(function (rrl) {
            rrl.prompt();
            return noPrint;
        });
    };

    var setPrompt = function (rl, p) {
        return rl(function (rrl) {
            rrl.setPrompt(p);
            return noPrint;
        });
    };

    var isNumber = function (n) {
        return typeof n === "number" && !Number.isNaN(n);
    };

    var parseNumber = function (s) {
        var num = parseFloat(s);
        if (isNumber(num)) {
            return num;
        }
        return s;
    };

    var identity = function (x) { return x; };

    var mkNumOp = function (initial, single, reduce) {
        return function () {
            var args = Array.prototype.slice.call(arguments);
            if (!args.length) {
                return initial;
            }
            if (args.length === 1) {
                return single(args[0]);
            }
            return args.slice(1).reduce(function (previous, current) {
                return reduce(previous, current);
            }, args[0]);
        };
    };

    var add = mkNumOp(0, identity, function (x, y) { return x + y; });

    var sub = mkNumOp(0, function (x) {
        return 0 - x;
    }, function (x, y) {
        return x - y;
    });

    var mul = mkNumOp(1, identity, function (x, y) { return x * y; });

    var div = mkNumOp(1, function (x) {
        return 1 / x;
    }, function (x, y) {
        return x / y;
    });

    var mod = function (dnd, dvs) {
        return dnd % dvs;
    };

    var gt = function (left, right) {
        return left > right;
    };

    var lt = function (left, right) {
        return left < right;
    };

    var gte = function (left, right) {
        return left >= right;
    };

    var lte = function (left, right) {
        return left <= right;
    };

    var isString = function (s) {
        return typeof s === "string";
    };

    var slen = function (s) {
        return s.length;
    };

    var sidx = function (s, expression) {
        var m = s.match(new RegExp(expression), "");
        if (!m) {
            return -1;
        }
        return m.index;
    };

    var charAt = function (s, i) {
        return s[i];
    };

    var charCodeAt = function (s, i) {
        return s.charCodeAt(s, i);
    };

    var subs = function (s, offset, count) {
        if (count < 0) {
            return s.substr(offset);
        }
        return s.substr(offset, count);
    };

    var sreplace = function (s, expression, replace) {
        return s.replace(new RegExp(expression, "g"), replace);
    };

    var mkStringBuilder = function () {
        return {sb: []};
    };

    var isStringBuilder = function (b) {
        return !!b && b.sb;
    };

    var sbempty = function (b) {
        for (var i = 0; i < b.sb.length; i++) {
            if (b.sb[i].length) {
                return false;
            }
        }
        return true;
    };

    var sbappend = function (b, s) {
        if (isStringBuilder(s)) {
            return {
                sb: b.sb.concat(s.sb)
            };
        }
        return {
            sb: b.sb.concat(s)
        }
    };

    var builderToString = function (b) {
        return b.sb.join("");
    };

    // no-head, once variadic arguments
    var cats = function () {
        var b = mkStringBuilder();
        for (var i = 0; i < arguments.length; i++) {
            b = sbappend(b, arguments[i]);
        }
        return builderToString(b);
    };

    var noPrint = function () { return noPrint; };

    var out = process && process.stdout && function (str) {
        if (str !== noPrint) {
            process.stdout.write(String(str));
        }
        return noPrint;
    };

    var log = process && process.stderr && function (s) {
        if (s !== noPrint) {
            process.stderr.write(String(s));
        }
        process.stderr.write("\n");
        return noPrint;
    } || function (s) {
        if (s !== noPrint) {
            console.log(s);
        } else {
            console.log();
        }
        return noPrint;
    };

    var cerror = function (where, what, arg) {
        throw new Error(String(where) + ":" + String(what) + ":" + String(arg));
        return noPrint;
    };

    var isError = function (error) {
        return error instanceof Error;
    };

    var sprintError = function (error) {
        return error && error.message || "error";
    };

    var sprintStack = function (error) {
        return error && error.stack || "";
    };

    var now = function () {
        return {t: new Date()};
    };

    var isTime = function (t) {
        return !!t && t.t instanceof Date;
    };

    var numberToTime = function (n) {
        return new Date(n);
    };

    var timeToNumber = function (t) {
        return t.t.valueOf();
    };

    var timeToString = function (t) {
        return t.t.toString();
    };

    var exit = function (val) {
        process.exit(val);
    };

    var argv = function () {
        return list.apply(undefined, process.argv);
    };

    var makeRegexp = function (expression, flags) {
        var regexp = new RegExp(expression, flags);
        return function (text) {
            return vector.apply(undefined, text.match(regexp) || []);
        };
    };

    var isVector = function (exp) {
        return !!exp &&
            exp.vector instanceof Array;
    };

    var vector = function () {
        return {vector: Array.prototype.slice.call(arguments)};
    };

    var vlen = function (v) {
        return v.vector.length;
    };

    var vref = function (v, i) {
        return v.vector[i];
    };

    var listToVector = function (list, reverse) {
        var v = vector();
        for (;;) {
            if (isNull(list)) {
                return v;
            }
            v.vector[reverse ? "unshift" : "push"](car(list));
            list = cdr(list);
        }
    };

    var vectorToList = function (v, reverse) {
        var l = list();
        var len = vlen(v);
        for (var i = 0; i < len; i++) {
            l = cons(vref(reverse ? len - i - 1 : i), l);
        }
        return l;
    };

    var shared = makeNameTable();
    var share = function (name, member) {
        return tableDefine(shared, [name], member);
    };
    share("compiled-procedure?", isCompiledProcedure);
    share("capply", capply);
    share("symbol?", isSymbol);
    share("symbol-name", symbolName);
    share("string->symbol", stringToSymbol);
    share("identity", identity);
    share("null?", isNull);
    share("cons", cons);
    share("pair?", isPair);
    share("car", car);
    share("cdr", cdr);
    share("list", list);
    share("peq?", peq);
    share("try", tryc);
    share("for", forLoop);
    share("read-file", readFile);
    share("read-line", readLine);
    share("prompt", prompt);
    share("set-prompt", setPrompt);
    share("number?", isNumber);
    share("parse-number", parseNumber);
    share("+", add);
    share("-", sub);
    share("*", mul);
    share("/", div);
    share("%", mod);
    share(">", gt);
    share("<", lt);
    share(">=", gte);
    share("<=", lte);
    share("string?", isString);
    share("number->string", String);
    share("slen", slen);
    share("sidx", sidx);
    share("char-at", charAt);
    share("char-code-at", charCodeAt);
    share("subs", subs);
    share("sreplace", sreplace);
    share("make-string-builder", mkStringBuilder);
    share("string-builder?", isStringBuilder);
    share("sbempty?", sbempty);
    share("sbappend", sbappend);
    share("builder->string", builderToString);
    share("cats", cats);
    share("out", out);
    share("clog", log);
    share("now", now);
    share("time?", isTime);
    share("number->time", numberToTime);
    share("time->number", timeToNumber);
    share("time->string", timeToString);
    share("filter", filter);
    share("table?", isTable);
    share("make-name-table", makeNameTable);
    share("table-has-name?", tableHasName);
    share("table-names", tableNames);
    share("table-lookup", tableLookup);
    share("table-define", tableDefine);
    share("table-set!", tableSet);
    share("table-delete!", tableDelete);
    share("cerror", cerror);
    share("error?", isError);
    share("sprint-error", sprintError);
    share("sprint-stack", sprintStack);
    share("exit", exit);
    share("proc-argv", argv);
    share("make-regexp", makeRegexp);
    share("true", true);
    share("false", false);
    share("no-print", noPrint);
    share("vector?", isVector);
    share("vector", vector);
    share("vlen", vlen);
    share("vref", vref);
    share("list->vector", listToVector);
    share("vector->list", vectorToList);

    // patch
    var extendEnv = function (env, shared) {
        var current = {
            parent: env,
            shared: shared || makeNameTable()
        };
        return function () {
            if (arguments.length === 4 && arguments[3]) {
                return tableNames(current.shared);
            }
            if (arguments.length === 1) {
                if (tableHasName(current.shared, [arguments[0]])) {
                    return tableLookup(current.shared, [arguments[0]]);
                }
                if (!current.parent) {
                    return cerror("extend-env", "unbound variable", arguments[0]);
                }
                return current.parent(arguments[0]);
            }
            if (arguments[1]) {
                return tableDefine(current.shared, [arguments[0]], arguments[2]);
            }
            if (tableHasName(current.shared, [arguments[0]])) {
                return tableSet(current.shared, [arguments[0]], arguments[2]);
            }
            if (!current.parent) {
                return cerror("extend-env", "unbound variable", arguments[0]);
            }
            return current.parent(arguments[0], false, arguments[2]);
        };
    };
    var isDefined = function (env, name) {
        try {
            env(name);
            return true;
        } catch (_) {
            return false;
        }
    };
    var head = extendEnv(null, shared);
    var mikkamakka = extendEnv(head);
    share("extend-env", extendEnv);
    share("defined?", isDefined);
    share("head", head);
    share("mikkamakka", mikkamakka);
    return mikkamakka;
})();
/*eval*/ var _eval;_eval=(function(_exp){return _eval_45_env(_mikkamakka,_exp);});env("eval",true,_eval);/*compound-procedure?*/ var _compound_45_procedure_63_;_compound_45_procedure_63_=(function(_p){return _tagged_45_list_63_(_p,["compound"]);});env("compound-procedure?",true,_compound_45_procedure_63_);/*self-evaluating?*/ var _self_45_evaluating_63_;_self_45_evaluating_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:_string_63_(_exp));})(_number_63_(_exp)));})(_peq_63_(_exp,_no_45_print)));})(_peq_63_(_exp,_false)));})(_peq_63_(_exp,_true));});env("self-evaluating?",true,_self_45_evaluating_63_);/*check-quote*/ var _check_45_quote;_check_45_quote=(function(_exp){return (false!==((function(_predicate){return (false!==(_predicate)?_predicate:_not(_peq_63_(_len(_exp),2)));})(_not(_tagged_45_list_63_(_exp,["quote"]))))?_error(["check-quote"],"invalid quotation",["???"]):_true);});env("check-quote",true,_check_45_quote);/*assignment?*/ var _assignment_63_;_assignment_63_=(function(_exp){return _tagged_45_list_63_(_exp,["set!"]);});env("assignment?",true,_assignment_63_);/*check-assignment*/ var _check_45_assignment;_check_45_assignment=(function(_exp){return (false!==(_not(_peq_63_(_len(_exp),3)))?_error(["check-assignment"],"invalid arity",_exp):(false!==(_not(_symbol_63_(_assignment_45_variable(_exp))))?_error(["check-assignment"],"invalid variable name",_exp):_true));});env("check-assignment",true,_check_45_assignment);/*assignment-variable*/ var _assignment_45_variable;_assignment_45_variable=(function(_exp){return _exp[1][0];});env("assignment-variable",true,_assignment_45_variable);/*assignment-value*/ var _assignment_45_value;_assignment_45_value=(function(_exp){return _exp[1][1][0];});env("assignment-value",true,_assignment_45_value);/*eval-assignment*/ var _eval_45_assignment;_eval_45_assignment=(function(_env,_exp){return _env(_assignment_45_variable(_exp),_false,_eval_45_env(_env,_assignment_45_value(_exp)));});env("eval-assignment",true,_eval_45_assignment);/*definition?*/ var _definition_63_;_definition_63_=(function(_exp){return _tagged_45_list_63_(_exp,["define"]);});env("definition?",true,_definition_63_);/*check-definition*/ var _check_45_definition;_check_45_definition=(function(_exp){return (false!==(_not((function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?__62_(_len(_exp),2):_predicate);})(_pair_63_(_exp[1][0])));})((function(_predicate){return (false!==(_predicate)?_peq_63_(_len(_exp),3):_predicate);})(_symbol_63_(_exp[1][0])))))?_error(["check-definition"],"invalid format",_exp):(false!==(_not(_symbol_63_(_definition_45_variable(_exp))))?_error(["check-definition"],"invalid variable name",_exp):_true));});env("check-definition",true,_check_45_definition);/*definition-variable*/ var _definition_45_variable;_definition_45_variable=(function(_exp){return (false!==(_symbol_63_(_exp[1][0]))?_exp[1][0]:_exp[1][0][0]);});env("definition-variable",true,_definition_45_variable);/*definition-value*/ var _definition_45_value;_definition_45_value=(function(_exp){return (false!==(_symbol_63_(_exp[1][0]))?_exp[1][1][0]:_make_45_lambda(_exp[1][0][1],_exp[1][1]));});env("definition-value",true,_definition_45_value);/*eval-definition*/ var _eval_45_definition;_eval_45_definition=(function(_env,_exp){return _env(_definition_45_variable(_exp),_true,_eval_45_env(_env,_definition_45_value(_exp)));});env("eval-definition",true,_eval_45_definition);/*if?*/ var _if_63_;_if_63_=(function(_exp){return _tagged_45_list_63_(_exp,["if"]);});env("if?",true,_if_63_);/*check-if*/ var _check_45_if;_check_45_if=(function(_exp){return (false!==(_not(_peq_63_(_len(_exp),4)))?_error(["check-if"],"invalid arity",_exp):_true);});env("check-if",true,_check_45_if);/*true?*/ var _true_63_;_true_63_=(function(_exp){return _not(_peq_63_(_exp,_false));});env("true?",true,_true_63_);/*if-predicate*/ var _if_45_predicate;_if_45_predicate=(function(_exp){return _exp[1][0];});env("if-predicate",true,_if_45_predicate);/*if-consequent*/ var _if_45_consequent;_if_45_consequent=(function(_exp){return _exp[1][1][0];});env("if-consequent",true,_if_45_consequent);/*if-alternative*/ var _if_45_alternative;_if_45_alternative=(function(_exp){return _exp[1][1][1][0];});env("if-alternative",true,_if_45_alternative);/*eval-if*/ var _eval_45_if;_eval_45_if=(function(_env,_exp){return (false!==(_true_63_(_eval_45_env(_env,_if_45_predicate(_exp))))?_eval_45_env(_env,_if_45_consequent(_exp)):_eval_45_env(_env,_if_45_alternative(_exp)));});env("eval-if",true,_eval_45_if);/*lambda?*/ var _lambda_63_;_lambda_63_=(function(_exp){return _tagged_45_list_63_(_exp,["lambda"]);});env("lambda?",true,_lambda_63_);/*check-lambda*/ var _check_45_lambda;_check_45_lambda=(function(_exp){return (false!==(__60_(_len(_exp),3))?_error(["check-lambda"],"invalid arity",_exp):(false!==((function(_predicate){return (false!==(_predicate)?_not(_pair_63_(_exp[1][0])):_predicate);})(_not(_null_63_(_exp[1][0]))))?_error(["check-lambda"],"invalid argument list",_exp):_true));});env("check-lambda",true,_check_45_lambda);/*make-procedure*/ var _make_45_procedure;_make_45_procedure=(function(_parameters,_body,_env){return [["compound"],[_parameters,[_body,[_env,[]]]]];});env("make-procedure",true,_make_45_procedure);/*lambda-parameters*/ var _lambda_45_parameters;_lambda_45_parameters=(function(_exp){return _exp[1][0];});env("lambda-parameters",true,_lambda_45_parameters);/*lambda-body*/ var _lambda_45_body;_lambda_45_body=(function(_exp){return _exp[1][1];});env("lambda-body",true,_lambda_45_body);/*begin?*/ var _begin_63_;_begin_63_=(function(_exp){return _tagged_45_list_63_(_exp,["begin"]);});env("begin?",true,_begin_63_);/*check-begin*/ var _check_45_begin;_check_45_begin=(function(_exp){return (false!==(__60_(_len(_exp),2))?_error(["check-begin"],"invalid arity",_exp):_true);});env("check-begin",true,_check_45_begin);/*begin-actions*/ var _begin_45_actions;_begin_45_actions=(function(_exp){return _exp[1];});env("begin-actions",true,_begin_45_actions);/*cond?*/ var _cond_63_;_cond_63_=(function(_exp){return _tagged_45_list_63_(_exp,["cond"]);});env("cond?",true,_cond_63_);/*cond-else-clause?*/ var _cond_45_else_45_clause_63_;_cond_45_else_45_clause_63_=(function(_clause){return _eq_63_(_cond_45_predicate(_clause),["else"]);});env("cond-else-clause?",true,_cond_45_else_45_clause_63_);/*make-begin*/ var _make_45_begin;_make_45_begin=(function(_seq){return [["begin"],_seq];});env("make-begin",true,_make_45_begin);/*sequence->exp*/ var _sequence_45__62_exp;_sequence_45__62_exp=(function(_seq){return (false!==(_null_63_(_seq))?[]:(false!==(_null_63_(_seq[1]))?_seq[0]:_make_45_begin(_seq)));});env("sequence->exp",true,_sequence_45__62_exp);/*cond-actions*/ var _cond_45_actions;_cond_45_actions=(function(_clause){return _clause[1];});env("cond-actions",true,_cond_45_actions);/*make-if*/ var _make_45_if;_make_45_if=(function(_predicate,_consequent,_alternative){return [["if"],[_predicate,[_consequent,[_alternative,[]]]]];});env("make-if",true,_make_45_if);/*cond-predicate*/ var _cond_45_predicate;_cond_45_predicate=(function(_clause){return _clause[0];});env("cond-predicate",true,_cond_45_predicate);/*expand-clauses*/ var _expand_45_clauses;_expand_45_clauses=(function(_clauses){return (false!==(_null_63_(_clauses))?["true"]:(function(_first,_the_45_rest){return (false!==(_not(_pair_63_(_first)))?_error(["expand-clauses"],"invalid syntax",_first):(false!==(_cond_45_else_45_clause_63_(_first))?(false!==(_null_63_(_the_45_rest))?_sequence_45__62_exp(_cond_45_actions(_first)):_error(["expand-clauses"],"else clause isn't last",_clauses)):_make_45_if(_cond_45_predicate(_first),_sequence_45__62_exp(_cond_45_actions(_first)),_expand_45_clauses(_the_45_rest))));})(_clauses[0],_clauses[1]));});env("expand-clauses",true,_expand_45_clauses);/*cond-clauses*/ var _cond_45_clauses;_cond_45_clauses=(function(_exp){return _exp[1];});env("cond-clauses",true,_cond_45_clauses);/*cond->if*/ var _cond_45__62_if;_cond_45__62_if=(function(_exp){return _expand_45_clauses(_cond_45_clauses(_exp));});env("cond->if",true,_cond_45__62_if);/*and?*/ var _and_63_;_and_63_=(function(_exp){return _tagged_45_list_63_(_exp,["and"]);});env("and?",true,_and_63_);/*expand-and*/ var _expand_45_and;_expand_45_and=(function(_exps){return (false!==(_null_63_(_exps))?["true"]:(function(_first,_the_45_rest){return (false!==(_null_63_(_the_45_rest))?_first:[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[_expand_45_and(_the_45_rest),[["predicate"],[]]]]],[]]]],[_first,[]]]);})(_exps[0],_exps[1]));});env("expand-and",true,_expand_45_and);/*and-expressions*/ var _and_45_expressions;_and_45_expressions=(function(_exp){return _exp[1];});env("and-expressions",true,_and_45_expressions);/*and->if*/ var _and_45__62_if;_and_45__62_if=(function(_exp){return _expand_45_and(_and_45_expressions(_exp));});env("and->if",true,_and_45__62_if);/*or?*/ var _or_63_;_or_63_=(function(_exp){return _tagged_45_list_63_(_exp,["or"]);});env("or?",true,_or_63_);/*expand-or*/ var _expand_45_or;_expand_45_or=(function(_exps){return (false!==(_null_63_(_exps))?["false"]:(function(_first,_the_45_rest){return (false!==(_null_63_(_the_45_rest))?_first:[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[_expand_45_or(_the_45_rest),[]]]]],[]]]],[_first,[]]]);})(_exps[0],_exps[1]));});env("expand-or",true,_expand_45_or);/*or-expressions*/ var _or_45_expressions;_or_45_expressions=(function(_exp){return _exp[1];});env("or-expressions",true,_or_45_expressions);/*or->if*/ var _or_45__62_if;_or_45__62_if=(function(_exp){return _expand_45_or(_or_45_expressions(_exp));});env("or->if",true,_or_45__62_if);/*let?*/ var _let_63_;_let_63_=(function(_exp){return _tagged_45_list_63_(_exp,["let"]);});env("let?",true,_let_63_);/*len*/ var _len;_len=(function(_l){return (false!==(_null_63_(_l))?0:__43_(1,_len(_l[1])));});env("len",true,_len);/*check-let*/ var _check_45_let;_check_45_let=(function(_exp){return (false!==(__60_(_len(_exp),3))?_error(["check-let"],"invalid arity",_exp):(false!==(_not(_pair_63_(_exp[1][0])))?_error(["check-let"],"invalid syntax",_exp):_true));});env("check-let",true,_check_45_let);/*make-lambda*/ var _make_45_lambda;_make_45_lambda=(function(_parameters,_body){return [["lambda"],[_parameters,_body]];});env("make-lambda",true,_make_45_lambda);/*let-variables*/ var _let_45_variables;_let_45_variables=(function(_defs){return _map(_car,_defs);});env("let-variables",true,_let_45_variables);/*let-defs*/ var _let_45_defs;_let_45_defs=(function(_exp){return _exp[1][0];});env("let-defs",true,_let_45_defs);/*let-body*/ var _let_45_body;_let_45_body=(function(_exp){return _exp[1][1];});env("let-body",true,_let_45_body);/*map*/ var _map;_map=(function(_p,_l){return (false!==(_null_63_(_l))?[]:[_p(_l[0]),_map(_p,_l[1])]);});env("map",true,_map);/*let-values*/ var _let_45_values;_let_45_values=(function(_defs){return _map(_cadr,_defs);});env("let-values",true,_let_45_values);/*let->procedure*/ var _let_45__62_procedure;_let_45__62_procedure=(function(_exp){return [_make_45_lambda(_let_45_variables(_let_45_defs(_exp)),_let_45_body(_exp)),_let_45_values(_let_45_defs(_exp))];});env("let->procedure",true,_let_45__62_procedure);/*application?*/ var _application_63_;_application_63_=(function(_exp){return _pair_63_(_exp);});env("application?",true,_application_63_);/*operator*/ var _operator;_operator=(function(_exp){return _exp[0];});env("operator",true,_operator);/*no-operands?*/ var _no_45_operands_63_;_no_45_operands_63_=(function(_ops){return _null_63_(_ops);});env("no-operands?",true,_no_45_operands_63_);/*first-operand*/ var _first_45_operand;_first_45_operand=(function(_ops){return _ops[0];});env("first-operand",true,_first_45_operand);/*rest-operands*/ var _rest_45_operands;_rest_45_operands=(function(_ops){return _ops[1];});env("rest-operands",true,_rest_45_operands);/*list-of-values*/ var _list_45_of_45_values;_list_45_of_45_values=(function(_env,_exps){return (false!==(_no_45_operands_63_(_exps))?[]:[_eval_45_env(_env,_first_45_operand(_exps)),_list_45_of_45_values(_env,_rest_45_operands(_exps))]);});env("list-of-values",true,_list_45_of_45_values);/*operands*/ var _operands;_operands=(function(_exp){return _exp[1];});env("operands",true,_operands);/*eval-env*/ var _eval_45_env;_eval_45_env=(function(_env,_exp){return (false!==(_self_45_evaluating_63_(_exp))?_exp:(false!==(_symbol_63_(_exp))?_env(_exp):(false!==(_vector_63_(_exp))?_exp:(false!==(_quote_63_(_exp))?(function(){_check_45_quote(_exp);return _quote_45_text(_exp);})():(false!==(_assignment_63_(_exp))?(function(){_check_45_assignment(_exp);return _eval_45_assignment(_env,_exp);})():(false!==(_definition_63_(_exp))?(function(){_check_45_definition(_exp);return _eval_45_definition(_env,_exp);})():(false!==(_if_63_(_exp))?(function(){_check_45_if(_exp);return _eval_45_if(_env,_exp);})():(false!==(_lambda_63_(_exp))?(function(){_check_45_lambda(_exp);return _make_45_procedure(_lambda_45_parameters(_exp),_lambda_45_body(_exp),_env);})():(false!==(_begin_63_(_exp))?(function(){_check_45_begin(_exp);return _eval_45_sequence(_env,_begin_45_actions(_exp));})():(false!==(_cond_63_(_exp))?_eval_45_env(_env,_cond_45__62_if(_exp)):(false!==(_and_63_(_exp))?_eval_45_env(_env,_and_45__62_if(_exp)):(false!==(_or_63_(_exp))?_eval_45_env(_env,_or_45__62_if(_exp)):(false!==(_let_63_(_exp))?(function(){_check_45_let(_exp);return _eval_45_env(_env,_let_45__62_procedure(_exp));})():(false!==(_application_63_(_exp))?_apply(_eval_45_env(_env,_operator(_exp)),_list_45_of_45_values(_env,_operands(_exp))):_error(["eval-env"],"unknown expression type",_exp)))))))))))))));});env("eval-env",true,_eval_45_env);/*eval-sequence*/ var _eval_45_sequence;_eval_45_sequence=(function(_env,_seq){return (false!==(_null_63_(_seq))?_error(["eval-sequence"],"unspecified sequence",_seq):(false!==(_null_63_(_seq[1]))?_eval_45_env(_env,_seq[0]):(function(){_eval_45_env(_env,_seq[0]);return _eval_45_sequence(_env,_seq[1]);})()));});env("eval-sequence",true,_eval_45_sequence);/*extend-procedure-environment*/ var _extend_45_procedure_45_environment;_extend_45_procedure_45_environment=(function(_env,_names,_values){/*define-args*/ var _define_45_args;_define_45_args=(function(_env,_names,_values){return (false!==(_null_63_(_names))?(false!==(_not(_null_63_(_values)))?_error(["procedure-environment"],"too many values",[_names,[_values,[]]]):_true):(false!==(_null_63_(_values))?_error(["procedure-environment"],"too many names",[_names,[_values,[]]]):(function(){_env(_names[0],_true,_values[0]);return _define_45_args(_env,_names[1],_values[1]);})()));});return (function(_env){_define_45_args(_env,_names,_values);return _env;})(_extend_45_env(_env));});env("extend-procedure-environment",true,_extend_45_procedure_45_environment);/*procedure-environment*/ var _procedure_45_environment;_procedure_45_environment=(function(_p){return _p[1][1][1][0];});env("procedure-environment",true,_procedure_45_environment);/*procedure-parameters*/ var _procedure_45_parameters;_procedure_45_parameters=(function(_p){return _p[1][0];});env("procedure-parameters",true,_procedure_45_parameters);/*procedure-body*/ var _procedure_45_body;_procedure_45_body=(function(_p){return _p[1][1][0];});env("procedure-body",true,_procedure_45_body);/*apply*/ var _apply;_apply=(function(_proc,_args){return (false!==(_compiled_45_procedure_63_(_proc))?_capply(_proc,_args):(false!==(_compound_45_procedure_63_(_proc))?_eval_45_sequence(_extend_45_procedure_45_environment(_procedure_45_environment(_proc),_procedure_45_parameters(_proc),_args),_procedure_45_body(_proc)):_error(["apply"],"unknown procedure type",_proc)));});env("apply",true,_apply);/*log*/ var _log;_log=(function(_exp){return _clog(_sprint(_exp));});env("log",true,_log);/*print*/ var _print;_print=(function(_s){return _out(_sprint(_s));});env("print",true,_print);/*quote-eq?*/ var _quote_45_eq_63_;_quote_45_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?_predicate:_eq_63_(_quote_45_text(_left),_quote_45_text(_right)));})((function(_predicate){return (false!==(_predicate)?_null_63_(_right[1]):_predicate);})(_null_63_(_left[1]))):_predicate);})(_quote_63_(_right)):_predicate);})(_quote_63_(_left));});env("quote-eq?",true,_quote_45_eq_63_);/*symbol-eq?*/ var _symbol_45_eq_63_;_symbol_45_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?_peq_63_(_symbol_45_name(_left),_symbol_45_name(_right)):_predicate);})(_symbol_63_(_right)):_predicate);})(_symbol_63_(_left));});env("symbol-eq?",true,_symbol_45_eq_63_);/*eq?*/ var _eq_63_;_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:_peq_63_(_left,_right));})(_quote_45_eq_63_(_left,_right)));})(_symbol_45_eq_63_(_left,_right)));})((function(_predicate){return (false!==(_predicate)?_null_63_(_right):_predicate);})(_null_63_(_left)));});env("eq?",true,_eq_63_);/*newline*/ var _newline;_newline=(function(){return _out("\n");});env("newline",true,_newline);/*sprint-quoted*/ var _sprint_45_quoted;_sprint_45_quoted=(function(_exp){return _sprintq(_exp,_true,_false);});env("sprint-quoted",true,_sprint_45_quoted);/*error*/ var _error;_error=(function(_where,_what,_arg){return _cerror(_sprint_45_quoted(_where),_what,_sprint(_arg));});env("error",true,_error);/*not*/ var _not;_not=(function(_exp){return (false!==(_peq_63_(_exp,_false))?_true:_false);});env("not",true,_not);/*append*/ var _append;_append=(function(_left,_right){return (false!==(_null_63_(_left))?_right:[_left[0],_append(_left[1],_right)]);});env("append",true,_append);/*escape-char?*/ var _escape_45_char_63_;_escape_45_char_63_=(function(_char){return _not(_peq_63_(_sescape_45_char(_char),_char));});env("escape-char?",true,_escape_45_char_63_);/*sescape-symbol-name*/ var _sescape_45_symbol_45_name;_sescape_45_symbol_45_name=(function(_sn){/*find-escape-char*/ var _find_45_escape_45_char;_find_45_escape_45_char=(function(_ss){return (false!==(_peq_63_(_slen(_ss),0))?_sn:(false!==(_escape_45_char_63_(_subs(_ss,0,1)))?_cats("|",_sn,"|"):_find_45_escape_45_char(_subs(_ss,1,-1))));});return _find_45_escape_45_char(_sn);});env("sescape-symbol-name",true,_sescape_45_symbol_45_name);/*tagged-list?*/ var _tagged_45_list_63_;_tagged_45_list_63_=(function(_exp,_tag){return (function(_predicate){return (false!==(_predicate)?_eq_63_(_exp[0],_tag):_predicate);})(_pair_63_(_exp));});env("tagged-list?",true,_tagged_45_list_63_);/*quote?*/ var _quote_63_;_quote_63_=(function(_exp){return _tagged_45_list_63_(_exp,["quote"]);});env("quote?",true,_quote_63_);/*quote-text*/ var _quote_45_text;_quote_45_text=(function(_q){return _q[1][0];});env("quote-text",true,_quote_45_text);/*sprintq-vector*/ var _sprintq_45_vector;_sprintq_45_vector=(function(_vector){return (function(_builder){_builder=_sbappend(_builder,"#(");(function(_ref,_in_45_list_63_){return _for((function(){return (false!==(_eq_63_(_ref,_vlen(_vector)))?_true:(function(){(false!==(__62_(_ref,0))?_builder=_sbappend(_builder," "):_true);_builder=_sbappend(_builder,_sprintq(_vref(_vector,_ref),_true,_false));_in_45_list_63_=_true;_ref=__43_(_ref,1);return _false;})());}));})(0,_false);_builder=_sbappend(_builder,")");return _builder_45__62_string(_builder);})(_make_45_string_45_builder());});env("sprintq-vector",true,_sprintq_45_vector);/*sprintq*/ var _sprintq;_sprintq=(function(_exp,_quoted_63_,_in_45_list_63_){return (false!==(_peq_63_(_exp,_false))?"false":(false!==(_peq_63_(_exp,_true))?"true":(false!==(_peq_63_(_exp,_no_45_print))?"":(false!==(_number_63_(_exp))?_number_45__62_string(_exp):(false!==(_string_63_(_exp))?_cats("\"",_sescape(_exp),"\""):(false!==(_symbol_63_(_exp))?(false!==(_quoted_63_)?_sescape_45_symbol_45_name(_symbol_45_name(_exp)):_cats("'",_sescape_45_symbol_45_name(_symbol_45_name(_exp)))):(false!==(_null_63_(_exp))?(false!==(_quoted_63_)?"()":"'()"):(false!==(_quote_63_(_exp))?(function(_text){return _cats("'",_sprintq(_text,_true,_false));})(_try((function(){return _quote_45_text(_exp);}),(function(__){return "???";}))):(false!==(_vector_63_(_exp))?_sprintq_45_vector(_exp):(false!==(_pair_63_(_exp))?_cats((false!==(_not(_quoted_63_))?"'(":(false!==(_not(_in_45_list_63_))?"(":"")),(false!==(_in_45_list_63_)?" ":""),_sprintq(_exp[0],_true,_false),(false!==(_null_63_(_exp[1]))?")":(false!==(_pair_63_(_exp[1]))?_sprintq(_exp[1],_true,_true):_cats(" . ",_sprintq(_exp[1],_true,_true),")")))):(false!==(_table_63_(_exp))?"[table]":(false!==(_error_63_(_exp))?_sprint_45_error(_exp):"unknown type"))))))))))));});env("sprintq",true,_sprintq);/*sprint*/ var _sprint;_sprint=(function(_exp){return _sprintq(_exp,_false,_false);});env("sprint",true,_sprint);/*reverse*/ var _reverse;_reverse=(function(_l){return (false!==(_null_63_(_l))?[]:_append(_reverse(_l[1]),[_l[0],[]]));});env("reverse",true,_reverse);/*sescaped-char*/ var _sescaped_45_char;_sescaped_45_char=(function(_char_45_symbol){return (false!==(_peq_63_(_char_45_symbol,"b"))?"\b":(false!==(_peq_63_(_char_45_symbol,"t"))?"\t":(false!==(_peq_63_(_char_45_symbol,"n"))?"\n":(false!==(_peq_63_(_char_45_symbol,"v"))?"\v":(false!==(_peq_63_(_char_45_symbol,"f"))?"\f":(false!==(_peq_63_(_char_45_symbol,"r"))?"\r":_char_45_symbol))))));});env("sescaped-char",true,_sescaped_45_char);/*sunescape*/ var _sunescape;_sunescape=(function(_s){/*sunescapes*/ var _sunescapes;_sunescapes=(function(_ss,_ps,_escaped){return (false!==(_peq_63_(_slen(_ss),0))?(false!==(_escaped)?_error(["sunescape"],"invalid escape sequence",_s):_ps):(false!==(_escaped)?_sunescapes(_subs(_ss,1,-1),_cats(_ps,_sescaped_45_char(_subs(_ss,0,1))),_false):(false!==(_peq_63_(_subs(_ss,0,1),"\\"))?_sunescapes(_subs(_ss,1,-1),_ps,_true):_sunescapes(_subs(_ss,1,-1),_cats(_ps,_subs(_ss,0,1)),_false))));});return _sunescapes(_s,"",_false);});env("sunescape",true,_sunescape);/*display*/ var _display;_display=(function(_s){return _out(_sunescape(_sprint(_s)));});env("display",true,_display);/*sescape-char*/ var _sescape_45_char;_sescape_45_char=(function(_char){return (false!==(_peq_63_(_char,"\b"))?"\\b":(false!==(_peq_63_(_char,"\t"))?"\\t":(false!==(_peq_63_(_char,"\n"))?"\\n":(false!==(_peq_63_(_char,"\v"))?"\\v":(false!==(_peq_63_(_char,"\f"))?"\\f":(false!==(_peq_63_(_char,"\r"))?"\\r":(false!==(_peq_63_(_char,"\""))?"\\\"":(false!==(_peq_63_(_char,"\\"))?"\\\\":_char))))))));});env("sescape-char",true,_sescape_45_char);/*sescape*/ var _sescape;_sescape=(function(_s){/*sescapes*/ var _sescapes;_sescapes=(function(_ss,_ps){return (false!==(_peq_63_(_slen(_ss),0))?_ps:_sescapes(_subs(_ss,1,-1),_cats(_ps,_sescape_45_char(_subs(_ss,0,1)))));});return _sescapes(_s,"");});env("sescape",true,_sescape);/*caar*/ var _caar;_caar=(function(_l){return _l[0][0];});env("caar",true,_caar);/*cadr*/ var _cadr;_cadr=(function(_l){return _l[1][0];});env("cadr",true,_cadr);/*cdar*/ var _cdar;_cdar=(function(_l){return _l[0][1];});env("cdar",true,_cdar);/*cddr*/ var _cddr;_cddr=(function(_l){return _l[1][1];});env("cddr",true,_cddr);/*caaar*/ var _caaar;_caaar=(function(_l){return _l[0][0][0];});env("caaar",true,_caaar);/*caadr*/ var _caadr;_caadr=(function(_l){return _l[1][0][0];});env("caadr",true,_caadr);/*cadar*/ var _cadar;_cadar=(function(_l){return _l[0][1][0];});env("cadar",true,_cadar);/*cdaar*/ var _cdaar;_cdaar=(function(_l){return _l[0][0][1];});env("cdaar",true,_cdaar);/*caddr*/ var _caddr;_caddr=(function(_l){return _l[1][1][0];});env("caddr",true,_caddr);/*cdadr*/ var _cdadr;_cdadr=(function(_l){return _l[1][0][1];});env("cdadr",true,_cdadr);/*cddar*/ var _cddar;_cddar=(function(_l){return _l[0][1][1];});env("cddar",true,_cddar);/*cdddr*/ var _cdddr;_cdddr=(function(_l){return _l[1][1][1];});env("cdddr",true,_cdddr);/*caaaar*/ var _caaaar;_caaaar=(function(_l){return _l[0][0][0][0];});env("caaaar",true,_caaaar);/*caaadr*/ var _caaadr;_caaadr=(function(_l){return _l[1][0][0][0];});env("caaadr",true,_caaadr);/*caadar*/ var _caadar;_caadar=(function(_l){return _l[0][1][0][0];});env("caadar",true,_caadar);/*cadaar*/ var _cadaar;_cadaar=(function(_l){return _l[0][0][1][0];});env("cadaar",true,_cadaar);/*cdaaar*/ var _cdaaar;_cdaaar=(function(_l){return _l[0][0][0][1];});env("cdaaar",true,_cdaaar);/*caaddr*/ var _caaddr;_caaddr=(function(_l){return _l[1][1][0][0];});env("caaddr",true,_caaddr);/*cadadr*/ var _cadadr;_cadadr=(function(_l){return _l[1][0][1][0];});env("cadadr",true,_cadadr);/*cdaadr*/ var _cdaadr;_cdaadr=(function(_l){return _l[1][0][0][1];});env("cdaadr",true,_cdaadr);/*caddar*/ var _caddar;_caddar=(function(_l){return _l[0][1][1][0];});env("caddar",true,_caddar);/*cdadar*/ var _cdadar;_cdadar=(function(_l){return _l[0][1][0][1];});env("cdadar",true,_cdadar);/*cddaar*/ var _cddaar;_cddaar=(function(_l){return _l[0][0][1][1];});env("cddaar",true,_cddaar);/*cadddr*/ var _cadddr;_cadddr=(function(_l){return _l[1][1][1][0];});env("cadddr",true,_cadddr);/*cdaddr*/ var _cdaddr;_cdaddr=(function(_l){return _l[1][1][0][1];});env("cdaddr",true,_cdaddr);/*cddadr*/ var _cddadr;_cddadr=(function(_l){return _l[1][0][1][1];});env("cddadr",true,_cddadr);/*cdddar*/ var _cdddar;_cdddar=(function(_l){return _l[0][1][1][1];});env("cdddar",true,_cdddar);/*cddddr*/ var _cddddr;_cddddr=(function(_l){return _l[1][1][1][1];});env("cddddr",true,_cddddr);var _mikkamakka=env("mikkamakka");var _head=env("head");var _defined_63_=env("defined?");var _extend_45_env=env("extend-env");var _vector_45__62_list=env("vector->list");var _list_45__62_vector=env("list->vector");var _vref=env("vref");var _vlen=env("vlen");var _vector=env("vector");var _vector_63_=env("vector?");var _no_45_print=env("no-print");var _false=env("false");var _true=env("true");var _make_45_regexp=env("make-regexp");var _proc_45_argv=env("proc-argv");var _exit=env("exit");var _sprint_45_stack=env("sprint-stack");var _sprint_45_error=env("sprint-error");var _error_63_=env("error?");var _cerror=env("cerror");var _table_45_delete_33_=env("table-delete!");var _table_45_set_33_=env("table-set!");var _table_45_define=env("table-define");var _table_45_lookup=env("table-lookup");var _table_45_names=env("table-names");var _table_45_has_45_name_63_=env("table-has-name?");var _make_45_name_45_table=env("make-name-table");var _table_63_=env("table?");var _filter=env("filter");var _time_45__62_string=env("time->string");var _time_45__62_number=env("time->number");var _number_45__62_time=env("number->time");var _time_63_=env("time?");var _now=env("now");var _clog=env("clog");var _out=env("out");var _cats=env("cats");var _builder_45__62_string=env("builder->string");var _sbappend=env("sbappend");var _sbempty_63_=env("sbempty?");var _string_45_builder_63_=env("string-builder?");var _make_45_string_45_builder=env("make-string-builder");var _sreplace=env("sreplace");var _subs=env("subs");var _char_45_code_45_at=env("char-code-at");var _char_45_at=env("char-at");var _sidx=env("sidx");var _slen=env("slen");var _number_45__62_string=env("number->string");var _string_63_=env("string?");var __60__61_=env("<=");var __62__61_=env(">=");var __60_=env("<");var __62_=env(">");var __37_=env("%");var __47_=env("/");var __42_=env("*");var __45_=env("-");var __43_=env("+");var _parse_45_number=env("parse-number");var _number_63_=env("number?");var _set_45_prompt=env("set-prompt");var _prompt=env("prompt");var _read_45_line=env("read-line");var _read_45_file=env("read-file");var _for=env("for");var _try=env("try");var _peq_63_=env("peq?");var _list=env("list");var _cdr=env("cdr");var _car=env("car");var _pair_63_=env("pair?");var _cons=env("cons");var _null_63_=env("null?");var _identity=env("identity");var _string_45__62_symbol=env("string->symbol");var _symbol_45_name=env("symbol-name");var _symbol_63_=env("symbol?");var _capply=env("capply");var _compiled_45_procedure_63_=env("compiled-procedure?");/*shared-precompiled*/ var _shared_45_precompiled;_shared_45_precompiled=[];_shared_45_precompiled=[[["define"],[[["cddddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdddar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cddadr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdaddr"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cadddr"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cddaar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdadar"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caddar"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdaadr"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cadadr"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caaddr"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdaaar"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cadaar"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caadar"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caaadr"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caaaar"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cddar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdadr"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caddr"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdaar"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cadar"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caadr"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caaar"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cdar"],[["l"],[]]],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cadr"],[["l"],[]]],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["caar"],[["l"],[]]],[[["car"],[[["car"],[["l"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sescape"],[["s"],[]]],[[["define"],[[["sescapes"],[["ss"],[["ps"],[]]]],[[["if"],[[["peq?"],[[["slen"],[["ss"],[]]],[0,[]]]],[["ps"],[[["sescapes"],[[["subs"],[["ss"],[1,[-1,[]]]]],[[["cats"],[["ps"],[[["sescape-char"],[[["subs"],[["ss"],[0,[1,[]]]]],[]]],[]]]],[]]]],[]]]]],[]]]],[[["sescapes"],[["s"],["",[]]]],[]]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sescape-char"],[["char"],[]]],[[["cond"],[[[["peq?"],[["char"],["\b",[]]]],["\\b",[]]],[[[["peq?"],[["char"],["\t",[]]]],["\\t",[]]],[[[["peq?"],[["char"],["\n",[]]]],["\\n",[]]],[[[["peq?"],[["char"],["\v",[]]]],["\\v",[]]],[[[["peq?"],[["char"],["\f",[]]]],["\\f",[]]],[[[["peq?"],[["char"],["\r",[]]]],["\\r",[]]],[[[["peq?"],[["char"],["\"",[]]]],["\\\"",[]]],[[[["peq?"],[["char"],["\\",[]]]],["\\\\",[]]],[[["else"],[["char"],[]]],[]]]]]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["display"],[["s"],[]]],[[["out"],[[["sunescape"],[[["sprint"],[["s"],[]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sunescape"],[["s"],[]]],[[["define"],[[["sunescapes"],[["ss"],[["ps"],[["escaped"],[]]]]],[[["cond"],[[[["peq?"],[[["slen"],[["ss"],[]]],[0,[]]]],[[["if"],[["escaped"],[[["error"],[[["quote"],[["sunescape"],[]]],["invalid escape sequence",[["s"],[]]]]],[["ps"],[]]]]],[]]],[[["escaped"],[[["sunescapes"],[[["subs"],[["ss"],[1,[-1,[]]]]],[[["cats"],[["ps"],[[["sescaped-char"],[[["subs"],[["ss"],[0,[1,[]]]]],[]]],[]]]],[["false"],[]]]]],[]]],[[[["peq?"],[[["subs"],[["ss"],[0,[1,[]]]]],["\\",[]]]],[[["sunescapes"],[[["subs"],[["ss"],[1,[-1,[]]]]],[["ps"],[["true"],[]]]]],[]]],[[["else"],[[["sunescapes"],[[["subs"],[["ss"],[1,[-1,[]]]]],[[["cats"],[["ps"],[[["subs"],[["ss"],[0,[1,[]]]]],[]]]],[["false"],[]]]]],[]]],[]]]]]],[]]]],[[["sunescapes"],[["s"],["",[["false"],[]]]]],[]]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sescaped-char"],[["char-symbol"],[]]],[[["cond"],[[[["peq?"],[["char-symbol"],["b",[]]]],["\b",[]]],[[[["peq?"],[["char-symbol"],["t",[]]]],["\t",[]]],[[[["peq?"],[["char-symbol"],["n",[]]]],["\n",[]]],[[[["peq?"],[["char-symbol"],["v",[]]]],["\v",[]]],[[[["peq?"],[["char-symbol"],["f",[]]]],["\f",[]]],[[[["peq?"],[["char-symbol"],["r",[]]]],["\r",[]]],[[["else"],[["char-symbol"],[]]],[]]]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["reverse"],[["l"],[]]],[[["if"],[[["null?"],[["l"],[]]],[[["quote"],[[],[]]],[[["append"],[[["reverse"],[[["cdr"],[["l"],[]]],[]]],[[["list"],[[["car"],[["l"],[]]],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sprint"],[["exp"],[]]],[[["sprintq"],[["exp"],[["false"],[["false"],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sprintq"],[["exp"],[["quoted?"],[["in-list?"],[]]]]],[[["cond"],[[[["peq?"],[["exp"],[["false"],[]]]],["false",[]]],[[[["peq?"],[["exp"],[["true"],[]]]],["true",[]]],[[[["peq?"],[["exp"],[["no-print"],[]]]],["",[]]],[[[["number?"],[["exp"],[]]],[[["number->string"],[["exp"],[]]],[]]],[[[["string?"],[["exp"],[]]],[[["cats"],["\"",[[["sescape"],[["exp"],[]]],["\"",[]]]]],[]]],[[[["symbol?"],[["exp"],[]]],[[["if"],[["quoted?"],[[["sescape-symbol-name"],[[["symbol-name"],[["exp"],[]]],[]]],[[["cats"],["'",[[["sescape-symbol-name"],[[["symbol-name"],[["exp"],[]]],[]]],[]]]],[]]]]],[]]],[[[["null?"],[["exp"],[]]],[[["if"],[["quoted?"],["()",["'()",[]]]]],[]]],[[[["quote?"],[["exp"],[]]],[[["let"],[[[["text"],[[["try"],[[["lambda"],[[],[[["quote-text"],[["exp"],[]]],[]]]],[[["lambda"],[[["_"],[]],["???",[]]]],[]]]],[]]],[]],[[["cats"],["'",[[["sprintq"],[["text"],[["true"],[["false"],[]]]]],[]]]],[]]]],[]]],[[[["vector?"],[["exp"],[]]],[[["sprintq-vector"],[["exp"],[]]],[]]],[[[["pair?"],[["exp"],[]]],[[["cats"],[[["cond"],[[[["not"],[["quoted?"],[]]],["'(",[]]],[[[["not"],[["in-list?"],[]]],["(",[]]],[[["else"],["",[]]],[]]]]],[[["cond"],[[["in-list?"],[" ",[]]],[[["else"],["",[]]],[]]]],[[["sprintq"],[[["car"],[["exp"],[]]],[["true"],[["false"],[]]]]],[[["cond"],[[[["null?"],[[["cdr"],[["exp"],[]]],[]]],[")",[]]],[[[["pair?"],[[["cdr"],[["exp"],[]]],[]]],[[["sprintq"],[[["cdr"],[["exp"],[]]],[["true"],[["true"],[]]]]],[]]],[[["else"],[[["cats"],[" . ",[[["sprintq"],[[["cdr"],[["exp"],[]]],[["true"],[["true"],[]]]]],[")",[]]]]],[]]],[]]]]],[]]]]]],[]]],[[[["table?"],[["exp"],[]]],["[table]",[]]],[[[["error?"],[["exp"],[]]],[[["sprint-error"],[["exp"],[]]],[]]],[[["else"],["unknown type",[]]],[]]]]]]]]]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sprintq-vector"],[["vector"],[]]],[[["let"],[[[["builder"],[[["make-string-builder"],[]],[]]],[]],[[["set!"],[["builder"],[[["sbappend"],[["builder"],["#(",[]]]],[]]]],[[["let"],[[[["ref"],[0,[]]],[[["in-list?"],[["false"],[]]],[]]],[[["for"],[[["lambda"],[[],[[["if"],[[["eq?"],[["ref"],[[["vlen"],[["vector"],[]]],[]]]],[["true"],[[["begin"],[[["cond"],[[[[">"],[["ref"],[0,[]]]],[[["set!"],[["builder"],[[["sbappend"],[["builder"],[" ",[]]]],[]]]],[]]],[]]],[[["set!"],[["builder"],[[["sbappend"],[["builder"],[[["sprintq"],[[["vref"],[["vector"],[["ref"],[]]]],[["true"],[["false"],[]]]]],[]]]],[]]]],[[["set!"],[["in-list?"],[["true"],[]]]],[[["set!"],[["ref"],[[["+"],[["ref"],[1,[]]]],[]]]],[["false"],[]]]]]]],[]]]]],[]]]],[]]],[]]]],[[["set!"],[["builder"],[[["sbappend"],[["builder"],[")",[]]]],[]]]],[[["builder->string"],[["builder"],[]]],[]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["quote-text"],[["q"],[]]],[[["cadr"],[["q"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["quote?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["quote"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["tagged-list?"],[["exp"],[["tag"],[]]]],[[["and"],[[["pair?"],[["exp"],[]]],[[["eq?"],[[["car"],[["exp"],[]]],[["tag"],[]]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sescape-symbol-name"],[["sn"],[]]],[[["define"],[[["find-escape-char"],[["ss"],[]]],[[["cond"],[[[["peq?"],[[["slen"],[["ss"],[]]],[0,[]]]],[["sn"],[]]],[[[["escape-char?"],[[["subs"],[["ss"],[0,[1,[]]]]],[]]],[[["cats"],["|",[["sn"],["|",[]]]]],[]]],[[["else"],[[["find-escape-char"],[[["subs"],[["ss"],[1,[-1,[]]]]],[]]],[]]],[]]]]],[]]]],[[["find-escape-char"],[["sn"],[]]],[]]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["escape-char?"],[["char"],[]]],[[["not"],[[["peq?"],[[["sescape-char"],[["char"],[]]],[["char"],[]]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["append"],[["left"],[["right"],[]]]],[[["if"],[[["null?"],[["left"],[]]],[["right"],[[["cons"],[[["car"],[["left"],[]]],[[["append"],[[["cdr"],[["left"],[]]],[["right"],[]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["not"],[["exp"],[]]],[[["if"],[[["peq?"],[["exp"],[["false"],[]]]],[["true"],[["false"],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["error"],[["where"],[["what"],[["arg"],[]]]]],[[["cerror"],[[["sprint-quoted"],[["where"],[]]],[["what"],[[["sprint"],[["arg"],[]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sprint-quoted"],[["exp"],[]]],[[["sprintq"],[["exp"],[["true"],[["false"],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["newline"],[]],[[["out"],["\n",[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eq?"],[["left"],[["right"],[]]]],[[["or"],[[["and"],[[["null?"],[["left"],[]]],[[["null?"],[["right"],[]]],[]]]],[[["symbol-eq?"],[["left"],[["right"],[]]]],[[["quote-eq?"],[["left"],[["right"],[]]]],[[["peq?"],[["left"],[["right"],[]]]],[]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["symbol-eq?"],[["left"],[["right"],[]]]],[[["and"],[[["symbol?"],[["left"],[]]],[[["symbol?"],[["right"],[]]],[[["peq?"],[[["symbol-name"],[["left"],[]]],[[["symbol-name"],[["right"],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["quote-eq?"],[["left"],[["right"],[]]]],[[["and"],[[["quote?"],[["left"],[]]],[[["quote?"],[["right"],[]]],[[["or"],[[["and"],[[["null?"],[[["cdr"],[["left"],[]]],[]]],[[["null?"],[[["cdr"],[["right"],[]]],[]]],[]]]],[[["eq?"],[[["quote-text"],[["left"],[]]],[[["quote-text"],[["right"],[]]],[]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["print"],[["s"],[]]],[[["out"],[[["sprint"],[["s"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["log"],[["exp"],[]]],[[["clog"],[[["sprint"],[["exp"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["apply"],[["proc"],[["args"],[]]]],[[["cond"],[[[["compiled-procedure?"],[["proc"],[]]],[[["capply"],[["proc"],[["args"],[]]]],[]]],[[[["compound-procedure?"],[["proc"],[]]],[[["eval-sequence"],[[["extend-procedure-environment"],[[["procedure-environment"],[["proc"],[]]],[[["procedure-parameters"],[["proc"],[]]],[["args"],[]]]]],[[["procedure-body"],[["proc"],[]]],[]]]],[]]],[[["else"],[[["error"],[[["quote"],[["apply"],[]]],["unknown procedure type",[["proc"],[]]]]],[]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["procedure-body"],[["p"],[]]],[[["caddr"],[["p"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["procedure-parameters"],[["p"],[]]],[[["cadr"],[["p"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["procedure-environment"],[["p"],[]]],[[["cadddr"],[["p"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["extend-procedure-environment"],[["env"],[["names"],[["values"],[]]]]],[[["define"],[[["define-args"],[["env"],[["names"],[["values"],[]]]]],[[["cond"],[[[["null?"],[["names"],[]]],[[["cond"],[[[["not"],[[["null?"],[["values"],[]]],[]]],[[["error"],[[["quote"],[["procedure-environment"],[]]],["too many values",[[["list"],[["names"],[["values"],[]]]],[]]]]],[]]],[]]],[]]],[[[["null?"],[["values"],[]]],[[["error"],[[["quote"],[["procedure-environment"],[]]],["too many names",[[["list"],[["names"],[["values"],[]]]],[]]]]],[]]],[[["else"],[[["env"],[[["car"],[["names"],[]]],[["true"],[[["car"],[["values"],[]]],[]]]]],[[["define-args"],[["env"],[[["cdr"],[["names"],[]]],[[["cdr"],[["values"],[]]],[]]]]],[]]]],[]]]]],[]]]],[[["let"],[[[["env"],[[["extend-env"],[["env"],[]]],[]]],[]],[[["define-args"],[["env"],[["names"],[["values"],[]]]]],[["env"],[]]]]],[]]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval-sequence"],[["env"],[["seq"],[]]]],[[["cond"],[[[["null?"],[["seq"],[]]],[[["error"],[[["quote"],[["eval-sequence"],[]]],["unspecified sequence",[["seq"],[]]]]],[]]],[[[["null?"],[[["cdr"],[["seq"],[]]],[]]],[[["eval-env"],[["env"],[[["car"],[["seq"],[]]],[]]]],[]]],[[["else"],[[["eval-env"],[["env"],[[["car"],[["seq"],[]]],[]]]],[[["eval-sequence"],[["env"],[[["cdr"],[["seq"],[]]],[]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval-env"],[["env"],[["exp"],[]]]],[[["cond"],[[[["self-evaluating?"],[["exp"],[]]],[["exp"],[]]],[[[["symbol?"],[["exp"],[]]],[[["env"],[["exp"],[]]],[]]],[[[["vector?"],[["exp"],[]]],[["exp"],[]]],[[[["quote?"],[["exp"],[]]],[[["check-quote"],[["exp"],[]]],[[["quote-text"],[["exp"],[]]],[]]]],[[[["assignment?"],[["exp"],[]]],[[["check-assignment"],[["exp"],[]]],[[["eval-assignment"],[["env"],[["exp"],[]]]],[]]]],[[[["definition?"],[["exp"],[]]],[[["check-definition"],[["exp"],[]]],[[["eval-definition"],[["env"],[["exp"],[]]]],[]]]],[[[["if?"],[["exp"],[]]],[[["check-if"],[["exp"],[]]],[[["eval-if"],[["env"],[["exp"],[]]]],[]]]],[[[["lambda?"],[["exp"],[]]],[[["check-lambda"],[["exp"],[]]],[[["make-procedure"],[[["lambda-parameters"],[["exp"],[]]],[[["lambda-body"],[["exp"],[]]],[["env"],[]]]]],[]]]],[[[["begin?"],[["exp"],[]]],[[["check-begin"],[["exp"],[]]],[[["eval-sequence"],[["env"],[[["begin-actions"],[["exp"],[]]],[]]]],[]]]],[[[["cond?"],[["exp"],[]]],[[["eval-env"],[["env"],[[["cond->if"],[["exp"],[]]],[]]]],[]]],[[[["and?"],[["exp"],[]]],[[["eval-env"],[["env"],[[["and->if"],[["exp"],[]]],[]]]],[]]],[[[["or?"],[["exp"],[]]],[[["eval-env"],[["env"],[[["or->if"],[["exp"],[]]],[]]]],[]]],[[[["let?"],[["exp"],[]]],[[["check-let"],[["exp"],[]]],[[["eval-env"],[["env"],[[["let->procedure"],[["exp"],[]]],[]]]],[]]]],[[[["application?"],[["exp"],[]]],[[["apply"],[[["eval-env"],[["env"],[[["operator"],[["exp"],[]]],[]]]],[[["list-of-values"],[["env"],[[["operands"],[["exp"],[]]],[]]]],[]]]],[]]],[[["else"],[[["error"],[[["quote"],[["eval-env"],[]]],["unknown expression type",[["exp"],[]]]]],[]]],[]]]]]]]]]]]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["operands"],[["exp"],[]]],[[["cdr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["list-of-values"],[["env"],[["exps"],[]]]],[[["if"],[[["no-operands?"],[["exps"],[]]],[[["quote"],[[],[]]],[[["cons"],[[["eval-env"],[["env"],[[["first-operand"],[["exps"],[]]],[]]]],[[["list-of-values"],[["env"],[[["rest-operands"],[["exps"],[]]],[]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["rest-operands"],[["ops"],[]]],[[["cdr"],[["ops"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["first-operand"],[["ops"],[]]],[[["car"],[["ops"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["no-operands?"],[["ops"],[]]],[[["null?"],[["ops"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["operator"],[["exp"],[]]],[[["car"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["application?"],[["exp"],[]]],[[["pair?"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let->procedure"],[["exp"],[]]],[[["cons"],[[["make-lambda"],[[["let-variables"],[[["let-defs"],[["exp"],[]]],[]]],[[["let-body"],[["exp"],[]]],[]]]],[[["let-values"],[[["let-defs"],[["exp"],[]]],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let-values"],[["defs"],[]]],[[["map"],[["cadr"],[["defs"],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["map"],[["p"],[["l"],[]]]],[[["if"],[[["null?"],[["l"],[]]],[[["quote"],[[],[]]],[[["cons"],[[["p"],[[["car"],[["l"],[]]],[]]],[[["map"],[["p"],[[["cdr"],[["l"],[]]],[]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let-body"],[["exp"],[]]],[[["cddr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let-defs"],[["exp"],[]]],[[["cadr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let-variables"],[["defs"],[]]],[[["map"],[["car"],[["defs"],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["make-lambda"],[["parameters"],[["body"],[]]]],[[["cons"],[[["quote"],[["lambda"],[]]],[[["cons"],[["parameters"],[["body"],[]]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-let"],[["exp"],[]]],[[["cond"],[[[["<"],[[["len"],[["exp"],[]]],[3,[]]]],[[["error"],[[["quote"],[["check-let"],[]]],["invalid arity",[["exp"],[]]]]],[]]],[[[["not"],[[["pair?"],[[["cadr"],[["exp"],[]]],[]]],[]]],[[["error"],[[["quote"],[["check-let"],[]]],["invalid syntax",[["exp"],[]]]]],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["len"],[["l"],[]]],[[["if"],[[["null?"],[["l"],[]]],[0,[[["+"],[1,[[["len"],[[["cdr"],[["l"],[]]],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["let?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["let"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["or->if"],[["exp"],[]]],[[["expand-or"],[[["or-expressions"],[["exp"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["or-expressions"],[["exp"],[]]],[[["cdr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["expand-or"],[["exps"],[]]],[[["if"],[[["null?"],[["exps"],[]]],[[["quote"],[["false"],[]]],[[["let"],[[[["first"],[[["car"],[["exps"],[]]],[]]],[[["the-rest"],[[["cdr"],[["exps"],[]]],[]]],[]]],[[["if"],[[["null?"],[["the-rest"],[]]],[["first"],[[["list"],[[["list"],[[["quote"],[["lambda"],[]]],[[["quote"],[[["predicate"],[]],[]]],[[["list"],[[["quote"],[["if"],[]]],[[["quote"],[["predicate"],[]]],[[["quote"],[["predicate"],[]]],[[["expand-or"],[["the-rest"],[]]],[]]]]]],[]]]]],[["first"],[]]]],[]]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["or?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["or"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["and->if"],[["exp"],[]]],[[["expand-and"],[[["and-expressions"],[["exp"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["and-expressions"],[["exp"],[]]],[[["cdr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["expand-and"],[["exps"],[]]],[[["if"],[[["null?"],[["exps"],[]]],[[["quote"],[["true"],[]]],[[["let"],[[[["first"],[[["car"],[["exps"],[]]],[]]],[[["the-rest"],[[["cdr"],[["exps"],[]]],[]]],[]]],[[["if"],[[["null?"],[["the-rest"],[]]],[["first"],[[["list"],[[["list"],[[["quote"],[["lambda"],[]]],[[["quote"],[[["predicate"],[]],[]]],[[["list"],[[["quote"],[["if"],[]]],[[["quote"],[["predicate"],[]]],[[["expand-and"],[["the-rest"],[]]],[[["quote"],[["predicate"],[]]],[]]]]]],[]]]]],[["first"],[]]]],[]]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["and?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["and"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond->if"],[["exp"],[]]],[[["expand-clauses"],[[["cond-clauses"],[["exp"],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond-clauses"],[["exp"],[]]],[[["cdr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["expand-clauses"],[["clauses"],[]]],[[["if"],[[["null?"],[["clauses"],[]]],[[["quote"],[["true"],[]]],[[["let"],[[[["first"],[[["car"],[["clauses"],[]]],[]]],[[["the-rest"],[[["cdr"],[["clauses"],[]]],[]]],[]]],[[["cond"],[[[["not"],[[["pair?"],[["first"],[]]],[]]],[[["error"],[[["quote"],[["expand-clauses"],[]]],["invalid syntax",[["first"],[]]]]],[]]],[[[["cond-else-clause?"],[["first"],[]]],[[["if"],[[["null?"],[["the-rest"],[]]],[[["sequence->exp"],[[["cond-actions"],[["first"],[]]],[]]],[[["error"],[[["quote"],[["expand-clauses"],[]]],["else clause isn't last",[["clauses"],[]]]]],[]]]]],[]]],[[["else"],[[["make-if"],[[["cond-predicate"],[["first"],[]]],[[["sequence->exp"],[[["cond-actions"],[["first"],[]]],[]]],[[["expand-clauses"],[["the-rest"],[]]],[]]]]],[]]],[]]]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond-predicate"],[["clause"],[]]],[[["car"],[["clause"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["make-if"],[["predicate"],[["consequent"],[["alternative"],[]]]]],[[["list"],[[["quote"],[["if"],[]]],[["predicate"],[["consequent"],[["alternative"],[]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond-actions"],[["clause"],[]]],[[["cdr"],[["clause"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["sequence->exp"],[["seq"],[]]],[[["cond"],[[[["null?"],[["seq"],[]]],[[["quote"],[[],[]]],[]]],[[[["null?"],[[["cdr"],[["seq"],[]]],[]]],[[["car"],[["seq"],[]]],[]]],[[["else"],[[["make-begin"],[["seq"],[]]],[]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["make-begin"],[["seq"],[]]],[[["cons"],[[["quote"],[["begin"],[]]],[["seq"],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond-else-clause?"],[["clause"],[]]],[[["eq?"],[[["cond-predicate"],[["clause"],[]]],[[["quote"],[["else"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["cond?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["cond"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["begin-actions"],[["exp"],[]]],[[["cdr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-begin"],[["exp"],[]]],[[["cond"],[[[["<"],[[["len"],[["exp"],[]]],[2,[]]]],[[["error"],[[["quote"],[["check-begin"],[]]],["invalid arity",[["exp"],[]]]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["begin?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["begin"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["lambda-body"],[["exp"],[]]],[[["cddr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["lambda-parameters"],[["exp"],[]]],[[["cadr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["make-procedure"],[["parameters"],[["body"],[["env"],[]]]]],[[["list"],[[["quote"],[["compound"],[]]],[["parameters"],[["body"],[["env"],[]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-lambda"],[["exp"],[]]],[[["cond"],[[[["<"],[[["len"],[["exp"],[]]],[3,[]]]],[[["error"],[[["quote"],[["check-lambda"],[]]],["invalid arity",[["exp"],[]]]]],[]]],[[[["and"],[[["not"],[[["null?"],[[["cadr"],[["exp"],[]]],[]]],[]]],[[["not"],[[["pair?"],[[["cadr"],[["exp"],[]]],[]]],[]]],[]]]],[[["error"],[[["quote"],[["check-lambda"],[]]],["invalid argument list",[["exp"],[]]]]],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["lambda?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["lambda"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval-if"],[["env"],[["exp"],[]]]],[[["if"],[[["true?"],[[["eval-env"],[["env"],[[["if-predicate"],[["exp"],[]]],[]]]],[]]],[[["eval-env"],[["env"],[[["if-consequent"],[["exp"],[]]],[]]]],[[["eval-env"],[["env"],[[["if-alternative"],[["exp"],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["if-alternative"],[["exp"],[]]],[[["cadddr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["if-consequent"],[["exp"],[]]],[[["caddr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["if-predicate"],[["exp"],[]]],[[["cadr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["true?"],[["exp"],[]]],[[["not"],[[["peq?"],[["exp"],[["false"],[]]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-if"],[["exp"],[]]],[[["cond"],[[[["not"],[[["peq?"],[[["len"],[["exp"],[]]],[4,[]]]],[]]],[[["error"],[[["quote"],[["check-if"],[]]],["invalid arity",[["exp"],[]]]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["if?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["if"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval-definition"],[["env"],[["exp"],[]]]],[[["env"],[[["definition-variable"],[["exp"],[]]],[["true"],[[["eval-env"],[["env"],[[["definition-value"],[["exp"],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["definition-value"],[["exp"],[]]],[[["if"],[[["symbol?"],[[["cadr"],[["exp"],[]]],[]]],[[["caddr"],[["exp"],[]]],[[["make-lambda"],[[["cdadr"],[["exp"],[]]],[[["cddr"],[["exp"],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["definition-variable"],[["exp"],[]]],[[["if"],[[["symbol?"],[[["cadr"],[["exp"],[]]],[]]],[[["cadr"],[["exp"],[]]],[[["caadr"],[["exp"],[]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-definition"],[["exp"],[]]],[[["cond"],[[[["not"],[[["or"],[[["and"],[[["symbol?"],[[["cadr"],[["exp"],[]]],[]]],[[["peq?"],[[["len"],[["exp"],[]]],[3,[]]]],[]]]],[[["and"],[[["pair?"],[[["cadr"],[["exp"],[]]],[]]],[[[">"],[[["len"],[["exp"],[]]],[2,[]]]],[]]]],[]]]],[]]],[[["error"],[[["quote"],[["check-definition"],[]]],["invalid format",[["exp"],[]]]]],[]]],[[[["not"],[[["symbol?"],[[["definition-variable"],[["exp"],[]]],[]]],[]]],[[["error"],[[["quote"],[["check-definition"],[]]],["invalid variable name",[["exp"],[]]]]],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["definition?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["define"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval-assignment"],[["env"],[["exp"],[]]]],[[["env"],[[["assignment-variable"],[["exp"],[]]],[["false"],[[["eval-env"],[["env"],[[["assignment-value"],[["exp"],[]]],[]]]],[]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["assignment-value"],[["exp"],[]]],[[["caddr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["assignment-variable"],[["exp"],[]]],[[["cadr"],[["exp"],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-assignment"],[["exp"],[]]],[[["cond"],[[[["not"],[[["peq?"],[[["len"],[["exp"],[]]],[3,[]]]],[]]],[[["error"],[[["quote"],[["check-assignment"],[]]],["invalid arity",[["exp"],[]]]]],[]]],[[[["not"],[[["symbol?"],[[["assignment-variable"],[["exp"],[]]],[]]],[]]],[[["error"],[[["quote"],[["check-assignment"],[]]],["invalid variable name",[["exp"],[]]]]],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["assignment?"],[["exp"],[]]],[[["tagged-list?"],[["exp"],[[["quote"],[["set!"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["check-quote"],[["exp"],[]]],[[["cond"],[[[["or"],[[["not"],[[["tagged-list?"],[["exp"],[[["quote"],[["quote"],[]]],[]]]],[]]],[[["not"],[[["peq?"],[[["len"],[["exp"],[]]],[2,[]]]],[]]],[]]]],[[["error"],[[["quote"],[["check-quote"],[]]],["invalid quotation",[[["quote"],[["???"],[]]],[]]]]],[]]],[]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["self-evaluating?"],[["exp"],[]]],[[["or"],[[["peq?"],[["exp"],[["true"],[]]]],[[["peq?"],[["exp"],[["false"],[]]]],[[["peq?"],[["exp"],[["no-print"],[]]]],[[["number?"],[["exp"],[]]],[[["string?"],[["exp"],[]]],[]]]]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["compound-procedure?"],[["p"],[]]],[[["tagged-list?"],[["p"],[[["quote"],[["compound"],[]]],[]]]],[]]]],_shared_45_precompiled];_shared_45_precompiled=[[["define"],[[["eval"],[["exp"],[]]],[[["eval-env"],[["mikkamakka"],[["exp"],[]]]],[]]]],_shared_45_precompiled];/*error*/ var _error;_error=(function(_where,_what,_arg){return _cerror(_sprint_45_quoted(_where),_what,_sprint(_arg));});/*symbol-eq?*/ var _symbol_45_eq_63_;_symbol_45_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?_peq_63_(_symbol_45_name(_left),_symbol_45_name(_right)):_predicate);})(_symbol_63_(_right)):_predicate);})(_symbol_63_(_left));});/*print*/ var _print;_print=(function(_s){return _out(_sprint(_s));});/*log*/ var _log;_log=(function(_exp){return _clog(_sprint(_exp));});/*newline*/ var _newline;_newline=(function(){return _out("\n");});/*print-stack*/ var _print_45_stack;_print_45_stack=(function(_error){_out(_sprint_45_stack(_error));return _newline();});/*display*/ var _display;_display=(function(_s){return _out(_sunescape(_sprint(_s)));});/*self-evaluating?*/ var _self_45_evaluating_63_;_self_45_evaluating_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:_string_63_(_exp));})(_number_63_(_exp)));})(_peq_63_(_exp,_no_45_print)));})(_peq_63_(_exp,_false)));})(_peq_63_(_exp,_true));});/*quote-text*/ var _quote_45_text;_quote_45_text=(function(_q){return _q[1][0];});/*quote-eq?*/ var _quote_45_eq_63_;_quote_45_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?_predicate:_eq_63_(_quote_45_text(_left),_quote_45_text(_right)));})((function(_predicate){return (false!==(_predicate)?_null_63_(_right[1]):_predicate);})(_null_63_(_left[1]))):_predicate);})(_quote_63_(_right)):_predicate);})(_quote_63_(_left));});/*eq?*/ var _eq_63_;_eq_63_=(function(_left,_right){return (function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:_peq_63_(_left,_right));})(_quote_45_eq_63_(_left,_right)));})(_symbol_45_eq_63_(_left,_right)));})((function(_predicate){return (false!==(_predicate)?_null_63_(_right):_predicate);})(_null_63_(_left)));});/*not*/ var _not;_not=(function(_exp){return (false!==(_peq_63_(_exp,_false))?_true:_false);});/*sescape-char*/ var _sescape_45_char;_sescape_45_char=(function(_char){return (false!==(_peq_63_(_char,"\b"))?"\\b":(false!==(_peq_63_(_char,"\t"))?"\\t":(false!==(_peq_63_(_char,"\n"))?"\\n":(false!==(_peq_63_(_char,"\v"))?"\\v":(false!==(_peq_63_(_char,"\f"))?"\\f":(false!==(_peq_63_(_char,"\r"))?"\\r":(false!==(_peq_63_(_char,"\""))?"\\\"":(false!==(_peq_63_(_char,"\\"))?"\\\\":_char))))))));});/*escape-char?*/ var _escape_45_char_63_;_escape_45_char_63_=(function(_char){return _not(_peq_63_(_sescape_45_char(_char),_char));});/*sescaped-char*/ var _sescaped_45_char;_sescaped_45_char=(function(_char_45_symbol){return (false!==(_peq_63_(_char_45_symbol,"b"))?"\b":(false!==(_peq_63_(_char_45_symbol,"t"))?"\t":(false!==(_peq_63_(_char_45_symbol,"n"))?"\n":(false!==(_peq_63_(_char_45_symbol,"v"))?"\v":(false!==(_peq_63_(_char_45_symbol,"f"))?"\f":(false!==(_peq_63_(_char_45_symbol,"r"))?"\r":_char_45_symbol))))));});/*sescape*/ var _sescape;_sescape=(function(_s){/*sescapes*/ var _sescapes;_sescapes=(function(_ss,_ps){return (false!==(_peq_63_(_slen(_ss),0))?_ps:_sescapes(_subs(_ss,1,-1),_cats(_ps,_sescape_45_char(_subs(_ss,0,1)))));});return _sescapes(_s,"");});/*sescape-symbol-name*/ var _sescape_45_symbol_45_name;_sescape_45_symbol_45_name=(function(_sn){/*find-escape-char*/ var _find_45_escape_45_char;_find_45_escape_45_char=(function(_ss){return (false!==(_peq_63_(_slen(_ss),0))?_sn:(false!==(_escape_45_char_63_(_subs(_ss,0,1)))?_cats("|",_sn,"|"):_find_45_escape_45_char(_subs(_ss,1,-1))));});return _find_45_escape_45_char(_sn);});/*sunescape*/ var _sunescape;_sunescape=(function(_s){/*sunescapes*/ var _sunescapes;_sunescapes=(function(_ss,_ps,_escaped){return (false!==(_peq_63_(_slen(_ss),0))?(false!==(_escaped)?_error(["sunescape"],"invalid escape sequence",_s):_ps):(false!==(_escaped)?_sunescapes(_subs(_ss,1,-1),_cats(_ps,_sescaped_45_char(_subs(_ss,0,1))),_false):(false!==(_peq_63_(_subs(_ss,0,1),"\\"))?_sunescapes(_subs(_ss,1,-1),_ps,_true):_sunescapes(_subs(_ss,1,-1),_cats(_ps,_subs(_ss,0,1)),_false))));});return _sunescapes(_s,"",_false);});/*sprintq-vector*/ var _sprintq_45_vector;_sprintq_45_vector=(function(_vector){return (function(_builder){_builder=_sbappend(_builder,"#(");(function(_ref,_in_45_list_63_){return _for((function(){return (false!==(_eq_63_(_ref,_vlen(_vector)))?_true:(function(){(false!==(__62_(_ref,0))?_builder=_sbappend(_builder," "):_true);_builder=_sbappend(_builder,_sprintq(_vref(_vector,_ref),_true,_false));_in_45_list_63_=_true;_ref=__43_(_ref,1);return _false;})());}));})(0,_false);_builder=_sbappend(_builder,")");return _builder_45__62_string(_builder);})(_make_45_string_45_builder());});/*sprintq*/ var _sprintq;_sprintq=(function(_exp,_quoted_63_,_in_45_list_63_){return (false!==(_peq_63_(_exp,_false))?"false":(false!==(_peq_63_(_exp,_true))?"true":(false!==(_peq_63_(_exp,_no_45_print))?"":(false!==(_number_63_(_exp))?_number_45__62_string(_exp):(false!==(_string_63_(_exp))?_cats("\"",_sescape(_exp),"\""):(false!==(_symbol_63_(_exp))?(false!==(_quoted_63_)?_sescape_45_symbol_45_name(_symbol_45_name(_exp)):_cats("'",_sescape_45_symbol_45_name(_symbol_45_name(_exp)))):(false!==(_null_63_(_exp))?(false!==(_quoted_63_)?"()":"'()"):(false!==(_quote_63_(_exp))?(function(_text){return _cats("'",_sprintq(_text,_true,_false));})(_try((function(){return _quote_45_text(_exp);}),(function(__){return "???";}))):(false!==(_vector_63_(_exp))?_sprintq_45_vector(_exp):(false!==(_pair_63_(_exp))?_cats((false!==(_not(_quoted_63_))?"'(":(false!==(_not(_in_45_list_63_))?"(":"")),(false!==(_in_45_list_63_)?" ":""),_sprintq(_exp[0],_true,_false),(false!==(_null_63_(_exp[1]))?")":(false!==(_pair_63_(_exp[1]))?_sprintq(_exp[1],_true,_true):_cats(" . ",_sprintq(_exp[1],_true,_true),")")))):(false!==(_table_63_(_exp))?"[table]":(false!==(_error_63_(_exp))?_sprint_45_error(_exp):"unknown type"))))))))))));});/*sprint*/ var _sprint;_sprint=(function(_exp){return _sprintq(_exp,_false,_false);});/*sprint-quoted*/ var _sprint_45_quoted;_sprint_45_quoted=(function(_exp){return _sprintq(_exp,_true,_false);});/*tagged-list?*/ var _tagged_45_list_63_;_tagged_45_list_63_=(function(_exp,_tag){return (function(_predicate){return (false!==(_predicate)?_eq_63_(_exp[0],_tag):_predicate);})(_pair_63_(_exp));});/*len*/ var _len;_len=(function(_l){return (false!==(_null_63_(_l))?0:__43_(1,_len(_l[1])));});/*append*/ var _append;_append=(function(_left,_right){return (false!==(_null_63_(_left))?_right:[_left[0],_append(_left[1],_right)]);});/*reverse*/ var _reverse;_reverse=(function(_l){return (false!==(_null_63_(_l))?[]:_append(_reverse(_l[1]),[_l[0],[]]));});/*map*/ var _map;_map=(function(_p,_l){return (false!==(_null_63_(_l))?[]:[_p(_l[0]),_map(_p,_l[1])]);});/*deep-reverse*/ var _deep_45_reverse;_deep_45_reverse=(function(_l){return _map((function(_i){return (false!==(_pair_63_(_i))?_deep_45_reverse(_i):_i);}),_reverse(_l));});/*copy-table-filtered*/ var _copy_45_table_45_filtered;_copy_45_table_45_filtered=(function(_from,_to,_f){/*iterate*/ var _iterate;_iterate=(function(_names,_copied_45_names){return (false!==(_null_63_(_names))?_copied_45_names:(function(_name){(false!==(_f(_name))?(function(){_table_45_define(_to,_name,_table_45_lookup(_from,_name));return _copied_45_names=[_name,_copied_45_names];})():_true);return _iterate(_names[1],_copied_45_names);})(_names[0]));});return _iterate(_table_45_names(_from),[]);});/*to-table*/ var _to_45_table;_to_45_table=(function(_l,_map_45_name,_map_45_value){return (function(_table){_map((function(_i){return _table_45_define(_table,_map_45_name(_i),_map_45_value(_i));}),_l);return _table;})(_make_45_name_45_table());});/*quote?*/ var _quote_63_;_quote_63_=(function(_exp){return _tagged_45_list_63_(_exp,["quote"]);});/*check-quote*/ var _check_45_quote;_check_45_quote=(function(_exp){return (false!==((function(_predicate){return (false!==(_predicate)?_predicate:_not(_peq_63_(_len(_exp),2)));})(_not(_tagged_45_list_63_(_exp,["quote"]))))?_error(["check-quote"],"invalid quotation",["???"]):_true);});/*assignment-variable*/ var _assignment_45_variable;_assignment_45_variable=(function(_exp){return _exp[1][0];});/*assignment?*/ var _assignment_63_;_assignment_63_=(function(_exp){return _tagged_45_list_63_(_exp,["set!"]);});/*check-assignment*/ var _check_45_assignment;_check_45_assignment=(function(_exp){return (false!==(_not(_peq_63_(_len(_exp),3)))?_error(["check-assignment"],"invalid arity",_exp):(false!==(_not(_symbol_63_(_assignment_45_variable(_exp))))?_error(["check-assignment"],"invalid variable name",_exp):_true));});/*assignment-variable*/ var _assignment_45_variable;_assignment_45_variable=(function(_exp){return _exp[1][0];});/*assignment-value*/ var _assignment_45_value;_assignment_45_value=(function(_exp){return _exp[1][1][0];});/*eval-assignment*/ var _eval_45_assignment;_eval_45_assignment=(function(_env,_exp){return _env(_assignment_45_variable(_exp),_false,_eval_45_env(_env,_assignment_45_value(_exp)));});/*definition?*/ var _definition_63_;_definition_63_=(function(_exp){return _tagged_45_list_63_(_exp,["define"]);});/*definition-variable*/ var _definition_45_variable;_definition_45_variable=(function(_exp){return (false!==(_symbol_63_(_exp[1][0]))?_exp[1][0]:_exp[1][0][0]);});/*definition-value*/ var _definition_45_value;_definition_45_value=(function(_exp){return (false!==(_symbol_63_(_exp[1][0]))?_exp[1][1][0]:_make_45_lambda(_exp[1][0][1],_exp[1][1]));});/*check-definition*/ var _check_45_definition;_check_45_definition=(function(_exp){return (false!==(_not((function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?__62_(_len(_exp),2):_predicate);})(_pair_63_(_exp[1][0])));})((function(_predicate){return (false!==(_predicate)?_peq_63_(_len(_exp),3):_predicate);})(_symbol_63_(_exp[1][0])))))?_error(["check-definition"],"invalid format",_exp):(false!==(_not(_symbol_63_(_definition_45_variable(_exp))))?_error(["check-definition"],"invalid variable name",_exp):_true));});/*eval-definition*/ var _eval_45_definition;_eval_45_definition=(function(_env,_exp){return _env(_definition_45_variable(_exp),_true,_eval_45_env(_env,_definition_45_value(_exp)));});/*if?*/ var _if_63_;_if_63_=(function(_exp){return _tagged_45_list_63_(_exp,["if"]);});/*check-if*/ var _check_45_if;_check_45_if=(function(_exp){return (false!==(_not(_peq_63_(_len(_exp),4)))?_error(["check-if"],"invalid arity",_exp):_true);});/*if-predicate*/ var _if_45_predicate;_if_45_predicate=(function(_exp){return _exp[1][0];});/*if-consequent*/ var _if_45_consequent;_if_45_consequent=(function(_exp){return _exp[1][1][0];});/*if-alternative*/ var _if_45_alternative;_if_45_alternative=(function(_exp){return _exp[1][1][1][0];});/*true?*/ var _true_63_;_true_63_=(function(_exp){return _not(_peq_63_(_exp,_false));});/*eval-if*/ var _eval_45_if;_eval_45_if=(function(_env,_exp){return (false!==(_true_63_(_eval_45_env(_env,_if_45_predicate(_exp))))?_eval_45_env(_env,_if_45_consequent(_exp)):_eval_45_env(_env,_if_45_alternative(_exp)));});/*make-if*/ var _make_45_if;_make_45_if=(function(_predicate,_consequent,_alternative){return [["if"],[_predicate,[_consequent,[_alternative,[]]]]];});/*make-lambda*/ var _make_45_lambda;_make_45_lambda=(function(_parameters,_body){return [["lambda"],[_parameters,_body]];});/*lambda?*/ var _lambda_63_;_lambda_63_=(function(_exp){return _tagged_45_list_63_(_exp,["lambda"]);});/*check-lambda*/ var _check_45_lambda;_check_45_lambda=(function(_exp){return (false!==(__60_(_len(_exp),3))?_error(["check-lambda"],"invalid arity",_exp):(false!==((function(_predicate){return (false!==(_predicate)?_not(_pair_63_(_exp[1][0])):_predicate);})(_not(_null_63_(_exp[1][0]))))?_error(["check-lambda"],"invalid argument list",_exp):_true));});/*lambda-parameters*/ var _lambda_45_parameters;_lambda_45_parameters=(function(_exp){return _exp[1][0];});/*lambda-body*/ var _lambda_45_body;_lambda_45_body=(function(_exp){return _exp[1][1];});/*make-procedure*/ var _make_45_procedure;_make_45_procedure=(function(_parameters,_body,_env){return [["compound"],[_parameters,[_body,[_env,[]]]]];});/*begin?*/ var _begin_63_;_begin_63_=(function(_exp){return _tagged_45_list_63_(_exp,["begin"]);});/*check-begin*/ var _check_45_begin;_check_45_begin=(function(_exp){return (false!==(__60_(_len(_exp),2))?_error(["check-begin"],"invalid arity",_exp):_true);});/*begin-actions*/ var _begin_45_actions;_begin_45_actions=(function(_exp){return _exp[1];});/*eval-sequence*/ var _eval_45_sequence;_eval_45_sequence=(function(_env,_seq){return (false!==(_null_63_(_seq))?_error(["eval-sequence"],"unspecified sequence",_seq):(false!==(_null_63_(_seq[1]))?_eval_45_env(_env,_seq[0]):(function(){_eval_45_env(_env,_seq[0]);return _eval_45_sequence(_env,_seq[1]);})()));});/*make-begin*/ var _make_45_begin;_make_45_begin=(function(_seq){return [["begin"],_seq];});/*sequence->exp*/ var _sequence_45__62_exp;_sequence_45__62_exp=(function(_seq){return (false!==(_null_63_(_seq))?[]:(false!==(_null_63_(_seq[1]))?_seq[0]:_make_45_begin(_seq)));});/*cond?*/ var _cond_63_;_cond_63_=(function(_exp){return _tagged_45_list_63_(_exp,["cond"]);});/*cond-clauses*/ var _cond_45_clauses;_cond_45_clauses=(function(_exp){return _exp[1];});/*cond-else-clause?*/ var _cond_45_else_45_clause_63_;_cond_45_else_45_clause_63_=(function(_clause){return _eq_63_(_cond_45_predicate(_clause),["else"]);});/*cond-actions*/ var _cond_45_actions;_cond_45_actions=(function(_clause){return _clause[1];});/*cond-predicate*/ var _cond_45_predicate;_cond_45_predicate=(function(_clause){return _clause[0];});/*expand-clauses*/ var _expand_45_clauses;_expand_45_clauses=(function(_clauses){return (false!==(_null_63_(_clauses))?["true"]:(function(_first,_the_45_rest){return (false!==(_not(_pair_63_(_first)))?_error(["expand-clauses"],"invalid syntax",_first):(false!==(_cond_45_else_45_clause_63_(_first))?(false!==(_null_63_(_the_45_rest))?_sequence_45__62_exp(_cond_45_actions(_first)):_error(["expand-clauses"],"else clause isn't last",_clauses)):_make_45_if(_cond_45_predicate(_first),_sequence_45__62_exp(_cond_45_actions(_first)),_expand_45_clauses(_the_45_rest))));})(_clauses[0],_clauses[1]));});/*cond->if*/ var _cond_45__62_if;_cond_45__62_if=(function(_exp){return _expand_45_clauses(_cond_45_clauses(_exp));});/*and?*/ var _and_63_;_and_63_=(function(_exp){return _tagged_45_list_63_(_exp,["and"]);});/*and-expressions*/ var _and_45_expressions;_and_45_expressions=(function(_exp){return _exp[1];});/*expand-and*/ var _expand_45_and;_expand_45_and=(function(_exps){return (false!==(_null_63_(_exps))?["true"]:(function(_first,_the_45_rest){return (false!==(_null_63_(_the_45_rest))?_first:[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[_expand_45_and(_the_45_rest),[["predicate"],[]]]]],[]]]],[_first,[]]]);})(_exps[0],_exps[1]));});/*and->if*/ var _and_45__62_if;_and_45__62_if=(function(_exp){return _expand_45_and(_and_45_expressions(_exp));});/*or?*/ var _or_63_;_or_63_=(function(_exp){return _tagged_45_list_63_(_exp,["or"]);});/*or-expressions*/ var _or_45_expressions;_or_45_expressions=(function(_exp){return _exp[1];});/*expand-or*/ var _expand_45_or;_expand_45_or=(function(_exps){return (false!==(_null_63_(_exps))?["false"]:(function(_first,_the_45_rest){return (false!==(_null_63_(_the_45_rest))?_first:[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[_expand_45_or(_the_45_rest),[]]]]],[]]]],[_first,[]]]);})(_exps[0],_exps[1]));});/*or->if*/ var _or_45__62_if;_or_45__62_if=(function(_exp){return _expand_45_or(_or_45_expressions(_exp));});/*let?*/ var _let_63_;_let_63_=(function(_exp){return _tagged_45_list_63_(_exp,["let"]);});/*check-let*/ var _check_45_let;_check_45_let=(function(_exp){return (false!==(__60_(_len(_exp),3))?_error(["check-let"],"invalid arity",_exp):(false!==(_not(_pair_63_(_exp[1][0])))?_error(["check-let"],"invalid syntax",_exp):_true));});/*let-defs*/ var _let_45_defs;_let_45_defs=(function(_exp){return _exp[1][0];});/*let-variables*/ var _let_45_variables;_let_45_variables=(function(_defs){return _map(_car,_defs);});/*let-values*/ var _let_45_values;_let_45_values=(function(_defs){return _map(_cadr,_defs);});/*let-body*/ var _let_45_body;_let_45_body=(function(_exp){return _exp[1][1];});/*let->procedure*/ var _let_45__62_procedure;_let_45__62_procedure=(function(_exp){return [_make_45_lambda(_let_45_variables(_let_45_defs(_exp)),_let_45_body(_exp)),_let_45_values(_let_45_defs(_exp))];});/*application?*/ var _application_63_;_application_63_=(function(_exp){return _pair_63_(_exp);});/*operator*/ var _operator;_operator=(function(_exp){return _exp[0];});/*operands*/ var _operands;_operands=(function(_exp){return _exp[1];});/*no-operands?*/ var _no_45_operands_63_;_no_45_operands_63_=(function(_ops){return _null_63_(_ops);});/*first-operand*/ var _first_45_operand;_first_45_operand=(function(_ops){return _ops[0];});/*rest-operands*/ var _rest_45_operands;_rest_45_operands=(function(_ops){return _ops[1];});/*compound-procedure?*/ var _compound_45_procedure_63_;_compound_45_procedure_63_=(function(_p){return _tagged_45_list_63_(_p,["compound"]);});/*procedure-parameters*/ var _procedure_45_parameters;_procedure_45_parameters=(function(_p){return _p[1][0];});/*procedure-body*/ var _procedure_45_body;_procedure_45_body=(function(_p){return _p[1][1][0];});/*procedure-environment*/ var _procedure_45_environment;_procedure_45_environment=(function(_p){return _p[1][1][1][0];});/*list-of-values*/ var _list_45_of_45_values;_list_45_of_45_values=(function(_env,_exps){return (false!==(_no_45_operands_63_(_exps))?[]:[_eval_45_env(_env,_first_45_operand(_exps)),_list_45_of_45_values(_env,_rest_45_operands(_exps))]);});/*extend-procedure-environment*/ var _extend_45_procedure_45_environment;_extend_45_procedure_45_environment=(function(_env,_names,_values){/*define-args*/ var _define_45_args;_define_45_args=(function(_env,_names,_values){return (false!==(_null_63_(_names))?(false!==(_not(_null_63_(_values)))?_error(["procedure-environment"],"too many values",[_names,[_values,[]]]):_true):(false!==(_null_63_(_values))?_error(["procedure-environment"],"too many names",[_names,[_values,[]]]):(function(){_env(_names[0],_true,_values[0]);return _define_45_args(_env,_names[1],_values[1]);})()));});return (function(_env){_define_45_args(_env,_names,_values);return _env;})(_extend_45_env(_env));});/*apply*/ var _apply;_apply=(function(_proc,_args){return (false!==(_compiled_45_procedure_63_(_proc))?_capply(_proc,_args):(false!==(_compound_45_procedure_63_(_proc))?_eval_45_sequence(_extend_45_procedure_45_environment(_procedure_45_environment(_proc),_procedure_45_parameters(_proc),_args),_procedure_45_body(_proc)):_error(["apply"],"unknown procedure type",_proc)));});/*eval-env*/ var _eval_45_env;_eval_45_env=(function(_env,_exp){return (false!==(_self_45_evaluating_63_(_exp))?_exp:(false!==(_symbol_63_(_exp))?_env(_exp):(false!==(_vector_63_(_exp))?_exp:(false!==(_quote_63_(_exp))?(function(){_check_45_quote(_exp);return _quote_45_text(_exp);})():(false!==(_assignment_63_(_exp))?(function(){_check_45_assignment(_exp);return _eval_45_assignment(_env,_exp);})():(false!==(_definition_63_(_exp))?(function(){_check_45_definition(_exp);return _eval_45_definition(_env,_exp);})():(false!==(_if_63_(_exp))?(function(){_check_45_if(_exp);return _eval_45_if(_env,_exp);})():(false!==(_lambda_63_(_exp))?(function(){_check_45_lambda(_exp);return _make_45_procedure(_lambda_45_parameters(_exp),_lambda_45_body(_exp),_env);})():(false!==(_begin_63_(_exp))?(function(){_check_45_begin(_exp);return _eval_45_sequence(_env,_begin_45_actions(_exp));})():(false!==(_cond_63_(_exp))?_eval_45_env(_env,_cond_45__62_if(_exp)):(false!==(_and_63_(_exp))?_eval_45_env(_env,_and_45__62_if(_exp)):(false!==(_or_63_(_exp))?_eval_45_env(_env,_or_45__62_if(_exp)):(false!==(_let_63_(_exp))?(function(){_check_45_let(_exp);return _eval_45_env(_env,_let_45__62_procedure(_exp));})():(false!==(_application_63_(_exp))?_apply(_eval_45_env(_env,_operator(_exp)),_list_45_of_45_values(_env,_operands(_exp))):_error(["eval-env"],"unknown expression type",_exp)))))))))))))));});/*eval*/ var _eval;_eval=(function(_exp){return _eval_45_env(_mikkamakka,_exp);});/*compile-pair*/ var _compile_45_pair;_compile_45_pair=(function(_context,_p){_compile_45_write(_context,"[");_compile_45_literal(_context,_p[0]);_compile_45_write(_context,",");_compile_45_literal(_context,_p[1]);return _compile_45_write(_context,"]");});/*compile-vector*/ var _compile_45_vector;_compile_45_vector=(function(_context,_v){_compile_45_write(_context,"{vector:[");(function(_ref){return _for((function(){return (false!==(_eq_63_(_ref,_vlen(_v)))?_true:(function(){(false!==(__62_(_ref,0))?_compile_45_write(_context,","):_true);_compile_45_exp(_context,_vref(_v,_ref));_ref=__43_(_ref,1);return _false;})());}));})(0);return _compile_45_write(_context,"]}");});/*compile-literal*/ var _compile_45_literal;_compile_45_literal=(function(_context,_exp){return (false!==(_self_45_evaluating_63_(_exp))?_compile_45_write(_context,_sprint(_exp)):(false!==(_symbol_63_(_exp))?_compile_45_write(_context,_cats("[",_sprint(_symbol_45_name(_exp)),"]")):(false!==(_null_63_(_exp))?_compile_45_write(_context,"[]"):(false!==(_pair_63_(_exp))?_compile_45_pair(_context,_exp):(false!==(_vector_63_(_exp))?_compile_45_vector(_context,_exp):_error(["compile-literal"],"unknown type",_exp))))));});/*compile-variable*/ var _compile_45_variable;_compile_45_variable=(function(_context,_exp){_compile_45_write(_context,_map_45_name(_context,_exp));return _add_45_compile_45_dependency(_context,_exp);});/*compile-assignment*/ var _compile_45_assignment;_compile_45_assignment=(function(_context,_exp){_compile_45_write(_context,_map_45_name(_context,_assignment_45_variable(_exp)));_compile_45_write(_context,"=");return _compile_45_exp(_context,_assignment_45_value(_exp));});/*compile-definition*/ var _compile_45_definition;_compile_45_definition=(function(_context,_exp,_last_63_){_add_45_compile_45_definition(_context,_definition_45_variable(_exp),_exp);_push_45_compile_45_scope(_context,_definition_45_variable(_exp));_compile_45_write(_context,"/*");_compile_45_write(_context,_symbol_45_name(_definition_45_variable(_exp)));_compile_45_write(_context,"*/ var ");_compile_45_write(_context,_map_45_name(_context,_definition_45_variable(_exp)));_compile_45_write(_context,";");(false!==(_last_63_)?_compile_45_write(_context,"return "):_true);_compile_45_write(_context,_map_45_name(_context,_definition_45_variable(_exp)));_compile_45_write(_context,"=");_compile_45_exp(_context,_definition_45_value(_exp));return _pop_45_compile_45_scope(_context);});/*compile-if*/ var _compile_45_if;_compile_45_if=(function(_context,_exp){_compile_45_write(_context,"(false!==(");_compile_45_exp(_context,_if_45_predicate(_exp));_compile_45_write(_context,")?");_compile_45_exp(_context,_if_45_consequent(_exp));_compile_45_write(_context,":");_compile_45_exp(_context,_if_45_alternative(_exp));return _compile_45_write(_context,")");});/*compile-sequence*/ var _compile_45_sequence;_compile_45_sequence=(function(_context,_seq){return (false!==(_null_63_(_seq))?_error(["compile-sequence"],"unspecified sequence",_seq):(false!==(_null_63_(_seq[1]))?_compile_45_statement(_context,_seq[0],_true):(function(){_compile_45_statement(_context,_seq[0],_false);return _compile_45_sequence(_context,_seq[1]);})()));});/*compile-parameters*/ var _compile_45_parameters;_compile_45_parameters=(function(_context,_parameters){/*compile-parameters*/ var _compile_45_parameters;_compile_45_parameters=(function(_parameters,_first_63_){return (false!==(_null_63_(_parameters))?["ok"]:(function(){(false!==(_not(_first_63_))?_compile_45_write(_context,","):_true);_compile_45_exp(_context,_parameters[0]);return _compile_45_parameters(_parameters[1],_false);})());});return _compile_45_parameters(_parameters,_true);});/*compile-procedure*/ var _compile_45_procedure;_compile_45_procedure=(function(_context,_parameters,_body){_compile_45_write(_context,"(function(");_compile_45_parameters(_context,_parameters);_compile_45_write(_context,"){");_compile_45_sequence(_context,_body);return _compile_45_write(_context,"})");});/*compile-begin*/ var _compile_45_begin;_compile_45_begin=(function(_context,_actions){_compile_45_write(_context,"(function(){");_compile_45_sequence(_context,_actions);return _compile_45_write(_context,"})()");});/*car?*/ var _car_63_;_car_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?_eq_63_(_len(_exp),2):_predicate);})(_tagged_45_list_63_(_exp,["car"]));});/*compile-car*/ var _compile_45_car;_compile_45_car=(function(_context,_exp){_compile_45_exp(_context,_exp[1][0]);return _compile_45_write(_context,"[0]");});/*cdr?*/ var _cdr_63_;_cdr_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?_eq_63_(_len(_exp),2):_predicate);})(_tagged_45_list_63_(_exp,["cdr"]));});/*compile-cdr*/ var _compile_45_cdr;_compile_45_cdr=(function(_context,_exp){_compile_45_exp(_context,_exp[1][0]);return _compile_45_write(_context,"[1]");});/*c[ad]+r-rx*/ var _c_91_ad_93__43_r_45_rx;_c_91_ad_93__43_r_45_rx=_make_45_regexp("^c[ad]+r$","");/*c[ad]+r?*/ var _c_91_ad_93__43_r_63_;_c_91_ad_93__43_r_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?(function(_predicate){return (false!==(_predicate)?__62_(_vlen(_c_91_ad_93__43_r_45_rx(_symbol_45_name(_exp[0]))),0):_predicate);})(_string_63_(_symbol_45_name(_exp[0]))):_predicate);})(_eq_63_(_len(_exp),2)):_predicate);})(_pair_63_(_exp));});/*compile-c[ad]+r*/ var _compile_45_c_91_ad_93__43_r;_compile_45_c_91_ad_93__43_r=(function(_context,_exp){/*iter*/ var _iter;_iter=(function(_name,_ref){return (false!==(__60_(_ref,0))?["ok"]:(function(){_compile_45_write(_context,(false!==(_eq_63_(_char_45_at(_name,_ref),"a"))?"[0]":"[1]"));return _iter(_name,__45_(_ref,1));})());});_compile_45_exp(_context,_exp[1][0]);return (function(_name){return _iter(_subs(_name,1,__45_(_slen(_name),2)),__45_(_slen(_name),3));})(_symbol_45_name(_exp[0]));});/*cons?*/ var _cons_63_;_cons_63_=(function(_exp){return (function(_predicate){return (false!==(_predicate)?_eq_63_(_len(_exp),3):_predicate);})(_tagged_45_list_63_(_exp,["cons"]));});/*compile-cons*/ var _compile_45_cons;_compile_45_cons=(function(_context,_exp){_compile_45_write(_context,"[");_compile_45_exp(_context,_exp[1][0]);_compile_45_write(_context,",");_compile_45_exp(_context,_exp[1][1][0]);return _compile_45_write(_context,"]");});/*list-constructor?*/ var _list_45_constructor_63_;_list_45_constructor_63_=(function(_exp){return _tagged_45_list_63_(_exp,["list"]);});/*compile-list-constructor*/ var _compile_45_list_45_constructor;_compile_45_list_45_constructor=(function(_context,_exp){return (false!==(_null_63_(_exp[1]))?_compile_45_write(_context,"[]"):_compile_45_exp(_context,[["cons"],[_exp[1][0],[[["list"],_exp[1][1]],[]]]]));});/*compile-application*/ var _compile_45_application;_compile_45_application=(function(_context,_proc,_args){_compile_45_exp(_context,_proc);_compile_45_write(_context,"(");_compile_45_parameters(_context,_args);return _compile_45_write(_context,")");});/*compile-exp*/ var _compile_45_exp;_compile_45_exp=(function(_context,_exp){return (false!==(_self_45_evaluating_63_(_exp))?_compile_45_literal(_context,_exp):(false!==(_symbol_63_(_exp))?_compile_45_variable(_context,_exp):(false!==(_vector_63_(_exp))?_compile_45_literal(_context,_exp):(false!==(_quote_63_(_exp))?_compile_45_literal(_context,_quote_45_text(_exp)):(false!==(_assignment_63_(_exp))?(function(){_check_45_assignment(_exp);return _compile_45_assignment(_context,_exp);})():(false!==(_definition_63_(_exp))?_error(["compile-exp"],"definition not allowed as expression",_exp):(false!==(_if_63_(_exp))?(function(){_check_45_if(_exp);return _compile_45_if(_context,_exp);})():(false!==(_lambda_63_(_exp))?(function(){_check_45_lambda(_exp);return _compile_45_procedure(_context,_lambda_45_parameters(_exp),_lambda_45_body(_exp));})():(false!==(_begin_63_(_exp))?(function(){_check_45_begin(_exp);return _compile_45_begin(_context,_begin_45_actions(_exp));})():(false!==(_cond_63_(_exp))?_compile_45_exp(_context,_cond_45__62_if(_exp)):(false!==(_and_63_(_exp))?_compile_45_exp(_context,_and_45__62_if(_exp)):(false!==(_or_63_(_exp))?_compile_45_exp(_context,_or_45__62_if(_exp)):(false!==(_let_63_(_exp))?(function(){_check_45_let(_exp);return _compile_45_exp(_context,_let_45__62_procedure(_exp));})():(false!==(_c_91_ad_93__43_r_63_(_exp))?_compile_45_c_91_ad_93__43_r(_context,_exp):(false!==(_cons_63_(_exp))?_compile_45_cons(_context,_exp):(false!==(_list_45_constructor_63_(_exp))?_compile_45_list_45_constructor(_context,_exp):(false!==(_application_63_(_exp))?_compile_45_application(_context,_operator(_exp),_operands(_exp)):_error(["compile-exp"],"invalid expression",_exp))))))))))))))))));});/*compile-statement*/ var _compile_45_statement;_compile_45_statement=(function(_context,_exp,_last_63_){(false!==(_definition_63_(_exp))?(function(){_check_45_definition(_exp);return _compile_45_definition(_context,_exp,_last_63_);})():(false!==(_last_63_)?(function(){_compile_45_write(_context,"return ");return _compile_45_exp(_context,_exp);})():_compile_45_exp(_context,_exp)));return _compile_45_write(_context,";");});/*make-compile-scope*/ var _make_45_compile_45_scope;_make_45_compile_45_scope=(function(_name){return (function(_scope){_table_45_define(_scope,["name"],_name);_table_45_define(_scope,["definitions"],_make_45_name_45_table());_table_45_define(_scope,["dependencies"],_make_45_name_45_table());return _scope;})(_make_45_name_45_table());});/*make-name-gen*/ var _make_45_name_45_gen;_make_45_name_45_gen=(function(){/*inc*/ var _inc;_inc=(function(_base,_val){return (false!==(_null_63_(_val))?[0,[]]:(function(_lowest){return (false!==(__60_(_lowest,_base))?[_lowest,_val[1]]:[0,_inc(_base,_val[1])]);})(__43_(_val[0],1)));});/*print*/ var _print;_print=(function(_digits,_val){return (false!==(_null_63_(_val))?_sbappend(_make_45_string_45_builder(),"_"):_sbappend(_print(_digits,_val[1]),_char_45_at(_digits,_val[0])));});return (function(_digits,_ref){return (function(){_ref=_inc(_slen(_digits),_ref);return _builder_45__62_string(_print(_digits,_ref));});})("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",[]);});/*make-name-map*/ var _make_45_name_45_map;_make_45_name_45_map=(function(){return (function(_name_45_gen,_names){return (function(_name){return (false!==(_table_45_has_45_name_63_(_names,_name))?_table_45_lookup(_names,_name):(function(_mapped){_table_45_define(_names,_name,_mapped);return _mapped;})(_name_45_gen()));});})(_make_45_name_45_gen(),_make_45_name_45_table());});/*make-compile-context*/ var _make_45_compile_45_context;_make_45_compile_45_context=(function(_names){return (function(_context){_table_45_define(_context,["names"],_names);_table_45_define(_context,["expressions"],_make_45_name_45_table());_table_45_define(_context,["stack"],[_make_45_compile_45_scope(["top"]),[]]);_table_45_define(_context,["output"],_make_45_string_45_builder());return _context;})(_make_45_name_45_table());});/*context-names*/ var _context_45_names;_context_45_names=(function(_context){return _table_45_lookup(_context,["names"]);});/*map-name-gen*/ var _map_45_name_45_gen;_map_45_name_45_gen=(function(_context,_name){return _context_45_names(_context)(_name);});/*map-name*/ var _map_45_name;_map_45_name=(function(_context,_name){return _cats("_",_sreplace(_symbol_45_name(_name),"\\W",(function(_s,__,__){return _cats("_",_sprint(_char_45_code_45_at(_s,0)),"_");})));});/*scope-name*/ var _scope_45_name;_scope_45_name=(function(_scope){return _table_45_lookup(_scope,["name"]);});/*compile-expressions*/ var _compile_45_expressions;_compile_45_expressions=(function(_context){return _table_45_lookup(_context,["expressions"]);});/*compile-stack*/ var _compile_45_stack;_compile_45_stack=(function(_context){return _table_45_lookup(_context,["stack"]);});/*compile-scope*/ var _compile_45_scope;_compile_45_scope=(function(_context){return _compile_45_stack(_context)[0];});/*scope-dependencies*/ var _scope_45_dependencies;_scope_45_dependencies=(function(_scope){return _table_45_lookup(_scope,["dependencies"]);});/*compile-dependencies*/ var _compile_45_dependencies;_compile_45_dependencies=(function(_context){return _scope_45_dependencies(_compile_45_scope(_context));});/*scope-definitions*/ var _scope_45_definitions;_scope_45_definitions=(function(_scope){return _table_45_lookup(_scope,["definitions"]);});/*compile-definitions*/ var _compile_45_definitions;_compile_45_definitions=(function(_context){return _scope_45_definitions(_compile_45_scope(_context));});/*add-compile-dependency*/ var _add_45_compile_45_dependency;_add_45_compile_45_dependency=(function(_context,_name){return _table_45_define(_compile_45_dependencies(_context),_name,_true);});/*add-compile-definition*/ var _add_45_compile_45_definition;_add_45_compile_45_definition=(function(_context,_name,_exp){(false!==(_eq_63_(_scope_45_name(_compile_45_scope(_context)),["top"]))?_table_45_define(_compile_45_expressions(_context),_name,_exp):_true);return _table_45_define(_compile_45_definitions(_context),_name,_make_45_name_45_table());});/*push-compile-scope*/ var _push_45_compile_45_scope;_push_45_compile_45_scope=(function(_context,_name){return _table_45_set_33_(_context,["stack"],[_make_45_compile_45_scope(_name),_compile_45_stack(_context)]);});/*pop-compile-scope*/ var _pop_45_compile_45_scope;_pop_45_compile_45_scope=(function(_context){return (function(_current_45_scope){return (function(_parent_45_definition,_current_45_definitions){/*undefined?*/ var _undefined_63_;_undefined_63_=(function(_dep){return _not(_table_45_has_45_name_63_(_current_45_definitions,_dep));});/*copy-def-deps*/ var _copy_45_def_45_deps;_copy_45_def_45_deps=(function(_def_45_names){return (false!==(_not(_null_63_(_def_45_names)))?(function(){_copy_45_table_45_filtered(_table_45_lookup(_current_45_definitions,_def_45_names[0]),_parent_45_definition,_undefined_63_);return _copy_45_def_45_deps(_def_45_names[1]);})():_true);});_copy_45_def_45_deps(_table_45_names(_current_45_definitions));_copy_45_table_45_filtered(_scope_45_dependencies(_current_45_scope),_parent_45_definition,_undefined_63_);return _table_45_set_33_(_context,["stack"],_compile_45_stack(_context)[1]);})(_table_45_lookup(_scope_45_definitions(_compile_45_stack(_context)[1][0]),_scope_45_name(_current_45_scope)),_scope_45_definitions(_current_45_scope));})(_compile_45_scope(_context));});/*compile-buffer*/ var _compile_45_buffer;_compile_45_buffer=(function(_context){return _table_45_lookup(_context,["output"]);});/*compile-write*/ var _compile_45_write;_compile_45_write=(function(_context,_s){return _table_45_set_33_(_context,["output"],_sbappend(_compile_45_buffer(_context),_s));});/*precompile-exp*/ var _precompile_45_exp;_precompile_45_exp=(function(_exp){return [["set!"],[["shared-precompiled"],[[["cons"],[[["quote"],[_exp,[]]],[["shared-precompiled"],[]]]],[]]]];});/*copy-head*/ var _copy_45_head;_copy_45_head=(function(_clb){return _read_45_file("mm-head.js",(function(_data){_out(_data);return _clb();}));});/*compile-shared*/ var _compile_45_shared;_compile_45_shared=(function(_context){/*iterate*/ var _iterate;_iterate=(function(_context,_shared){return (false!==(_not(_null_63_(_shared)))?(function(){_compile_45_statement(_context,_shared[0],_false);(false!==(_definition_63_(_shared[0]))?(function(){_compile_45_write(_context,"env(\"");_compile_45_write(_context,_symbol_45_name(_definition_45_variable(_shared[0])));_compile_45_write(_context,"\",true,");_compile_45_write(_context,_map_45_name(_context,_definition_45_variable(_shared[0])));return _compile_45_write(_context,");");})():_true);return _iterate(_context,_shared[1]);})():_true);});return _iterate(_context,_shared_45_precompiled);});/*tokenizer-expression*/ var _tokenizer_45_expression;_tokenizer_45_expression=[";[^\\n]*\\n?|",["\\(|\\)|",["#\\(|",["'|",["\"(\\\\\\\\|\\\\\"|[^\"])*\"?|",["(\\\\.|",["\\|(\\\\\\\\|\\\\\\||[^|])*\\|?|",["[^;()'|\"\\s])+",[]]]]]]]]];/*tokenizer-rx*/ var _tokenizer_45_rx;_tokenizer_45_rx=_make_45_regexp(_apply(_cats,_tokenizer_45_expression),"g");/*token-complete-expression*/ var _token_45_complete_45_expression;_token_45_complete_45_expression=["^(;[^\\n]*\\n|",["\\(|",["\\)|",["#\\(|",["'|",["\"(\\\\\"|\\\\[^\"]|[^\\\\\"])*\"|",["(\\\\.|",["\\|(\\\\\\||\\\\[^\\|]|[^\\\\|])*\\||",["[^;()#'|\"\\s\\\\])+)$",[]]]]]]]]]];/*token-complete-rx*/ var _token_45_complete_45_rx;_token_45_complete_45_rx=_make_45_regexp(_apply(_cats,_token_45_complete_45_expression),"");/*make-read-context*/ var _make_45_read_45_context;_make_45_read_45_context=(function(){return (function(_context,_tokens){_table_45_define(_tokens,["fragments"],[]);_table_45_define(_tokens,["ref"],0);_table_45_define(_context,["tokens"],_tokens);_table_45_define(_context,["stack"],[]);_table_45_define(_context,["expressions"],[]);return _context;})(_make_45_name_45_table(),_make_45_name_45_table());});/*read-tokens*/ var _read_45_tokens;_read_45_tokens=(function(_context){return _table_45_lookup(_context,["tokens"]);});/*read-tokens-list*/ var _read_45_tokens_45_list;_read_45_tokens_45_list=(function(_context){return _table_45_lookup(_read_45_tokens(_context),["fragments"]);});/*read-token-ref*/ var _read_45_token_45_ref;_read_45_token_45_ref=(function(_context){return _table_45_lookup(_read_45_tokens(_context),["ref"]);});/*read-stack*/ var _read_45_stack;_read_45_stack=(function(_context){return _table_45_lookup(_context,["stack"]);});/*read-stack-empty?*/ var _read_45_stack_45_empty_63_;_read_45_stack_45_empty_63_=(function(_context){return _null_63_(_read_45_stack(_context));});/*current-stack-frame*/ var _current_45_stack_45_frame;_current_45_stack_45_frame=(function(_context){return _read_45_stack(_context)[0];});/*current-read-list-type*/ var _current_45_read_45_list_45_type;_current_45_read_45_list_45_type=(function(_context){return _table_45_lookup(_current_45_stack_45_frame(_context),["type"]);});/*current-read-list*/ var _current_45_read_45_list;_current_45_read_45_list=(function(_context){return _table_45_lookup(_current_45_stack_45_frame(_context),["list"]);});/*read-expressions*/ var _read_45_expressions;_read_45_expressions=(function(_context){return _table_45_lookup(_context,["expressions"]);});/*token-complete?*/ var _token_45_complete_63_;_token_45_complete_63_=(function(_token){return __62_(_vlen(_token_45_complete_45_rx(_token)),0);});/*unescape-char*/ var _unescape_45_char;_unescape_45_char=(function(_char_45_symbol){return (false!==(_peq_63_(_char_45_symbol,"b"))?"\b":(false!==(_peq_63_(_char_45_symbol,"t"))?"\t":(false!==(_peq_63_(_char_45_symbol,"n"))?"\n":(false!==(_peq_63_(_char_45_symbol,"v"))?"\v":(false!==(_peq_63_(_char_45_symbol,"f"))?"\f":(false!==(_peq_63_(_char_45_symbol,"r"))?"\r":_char_45_symbol))))));});/*unescape*/ var _unescape;_unescape=(function(_string){/*unescape*/ var _unescape;_unescape=(function(_builder,_s){_for((function(){return (function(_eref){return (false!==(__60_(_eref,0))?(function(){_builder=_sbappend(_builder,_s);return _true;})():(false!==(_eq_63_(_slen(_s),__43_(_eref,1)))?_error(["unescape"],"invalid escape sequence",_string):(function(){_builder=_sbappend(_builder,_subs(_s,0,_eref));_builder=_sbappend(_builder,_unescape_45_char(_char_45_at(_s,__43_(_eref,1))));_s=_subs(_s,__43_(_eref,2),-1);return _false;})()));})(_sidx(_s,"\\\\"));}));return _builder_45__62_string(_builder);});return _unescape(_make_45_string_45_builder(),_string);});/*unescape-symbol*/ var _unescape_45_symbol;_unescape_45_symbol=(function(_name){/*unescape*/ var _unescape;_unescape=(function(_builder,_s){(function(_escaped){return _for((function(){return (function(_eref){return (false!==(__60_(_eref,0))?(function(){_builder=_sbappend(_builder,_s);return _true;})():(function(){_builder=_sbappend(_builder,_subs(_s,0,_eref));return (function(_echar){return (false!==(_peq_63_(_echar,"|"))?(function(){_s=_subs(_s,__43_(_eref,1),-1);_escaped=_not(_escaped);return _false;})():(false!==(_eq_63_(_slen(_s),__43_(_eref,1)))?(function(){_builder=_sbappend(_builder,"\\");return _true;})():(false!==(_eq_63_(_char_45_at(_s,__43_(_eref,1)),"|"))?(function(){_builder=_sbappend(_builder,"|");_s=_subs(_s,__43_(_eref,2),-1);return _false;})():(false!==(_escaped)?(function(){_builder=_sbappend(_builder,_subs(_s,_eref,2));_s=_subs(_s,__43_(_eref,2),-1);return _false;})():(function(){_builder=_sbappend(_builder,_char_45_at(_s,__43_(_eref,1)));_s=_subs(_s,__43_(_eref,2),-1);return _false;})()))));})(_char_45_at(_s,_eref));})());})(_sidx(_s,"\\\\|\\|"));}));})(_false);return _builder_45__62_string(_builder);});return _unescape(_make_45_string_45_builder(),_name);});/*push-list-type*/ var _push_45_list_45_type;_push_45_list_45_type=(function(_context,_type){return (function(_frame){_table_45_define(_frame,["type"],_type);_table_45_define(_frame,["list"],[]);return _table_45_set_33_(_context,["stack"],[_frame,_read_45_stack(_context)]);})(_make_45_name_45_table());});/*push-list*/ var _push_45_list;_push_45_list=(function(_context){return _push_45_list_45_type(_context,["list"]);});/*push-vector*/ var _push_45_vector;_push_45_vector=(function(_context){return _push_45_list_45_type(_context,["vector"]);});/*replace-read-list*/ var _replace_45_read_45_list;_replace_45_read_45_list=(function(_context,_list){return _table_45_set_33_(_current_45_stack_45_frame(_context),["list"],_list);});/*cons-read-expression*/ var _cons_45_read_45_expression;_cons_45_read_45_expression=(function(_context,_tag){return _table_45_set_33_(_context,["expressions"],[_tag,_read_45_expressions(_context)]);});/*cons-read-tag*/ var _cons_45_read_45_tag;_cons_45_read_45_tag=(function(_context,_tag){return (false!==(_read_45_stack_45_empty_63_(_context))?_cons_45_read_45_expression:_cons_45_stack_45_tag)(_context,_tag);});/*close-current-list*/ var _close_45_current_45_list;_close_45_current_45_list=(function(_context){return (false!==(_read_45_stack_45_empty_63_(_context))?_error(["close-current-list"],"unexpected closing paren",_context):(function(_closed){_table_45_set_33_(_context,["stack"],_read_45_stack(_context)[1]);return _cons_45_read_45_tag(_context,_closed);})((false!==(_eq_63_(_current_45_read_45_list_45_type(_context),["vector"]))?_apply(_vector,_reverse(_current_45_read_45_list(_context))):_reverse(_current_45_read_45_list(_context)))));});/*push-quote*/ var _push_45_quote;_push_45_quote=(function(_context){return _push_45_list_45_type(_context,["quote"]);});/*quoted-tag?*/ var _quoted_45_tag_63_;_quoted_45_tag_63_=(function(_context){return _eq_63_(_current_45_read_45_list_45_type(_context),["quote"]);});/*cons-stack-tag*/ var _cons_45_stack_45_tag;_cons_45_stack_45_tag=(function(_context,_tag){return (function(_list){_replace_45_read_45_list(_context,_list);return (false!==(_quoted_45_tag_63_(_context))?_close_45_current_45_list(_context):_true);})([_tag,(false!==(_quoted_45_tag_63_(_context))?[["quote"],_current_45_read_45_list(_context)]:_current_45_read_45_list(_context))]);});/*cons-string*/ var _cons_45_string;_cons_45_string=(function(_context,_token){return _cons_45_read_45_tag(_context,_unescape(_subs(_token,1,__45_(_slen(_token),2))));});/*cons-token*/ var _cons_45_token;_cons_45_token=(function(_context,_token){return (function(_number){return _cons_45_read_45_tag(_context,(false!==(_number_63_(_number))?_number:_string_45__62_symbol(_unescape_45_symbol(_token))));})(_parse_45_number(_token));});/*parse-token*/ var _parse_45_token;_parse_45_token=(function(_context,_token){return (false!==(_peq_63_(_token,"("))?_push_45_list(_context):(false!==(_peq_63_(_token,"#("))?_push_45_vector(_context):(false!==(_peq_63_(_token,")"))?_close_45_current_45_list(_context):(false!==(_peq_63_(_token,"'"))?_push_45_quote(_context):(false!==(_peq_63_(_char_45_at(_token,0),"\""))?_cons_45_string(_context,_token):(false!==(_peq_63_(_char_45_at(_token,0),"#"))?_error(["parse-token"],"unrecognized type escape",_token):(false!==(_not(_peq_63_(_char_45_at(_token,0),";")))?_cons_45_token(_context,_token):_true)))))));});/*shift-tokens*/ var _shift_45_tokens;_shift_45_tokens=(function(_context){_table_45_set_33_(_read_45_tokens(_context),["fragments"],[]);return _table_45_set_33_(_read_45_tokens(_context),["ref"],0);});/*parse-tokens*/ var _parse_45_tokens;_parse_45_tokens=(function(_context){/*next-tokens*/ var _next_45_tokens;_next_45_tokens=(function(_tokens){return (false!==(_null_63_(_tokens[1]))?[]:(false!==(_eq_63_(_vlen(_tokens[1][0]),0))?_next_45_tokens(_tokens[1]):_tokens[1]));});return (function(_tokens,_ref){/*parse-incomplete*/ var _parse_45_incomplete;_parse_45_incomplete=(function(_token){return (function(_next,_exit_63_){_for((function(){return (false!==(_null_63_(_next))?(function(){_exit_63_=_true;return _true;})():(function(){_token=_sbappend(_token,(false!==(_eq_63_(_vref(_next[0],0),["eof"]))?"\n":_vref(_next[0],0)));return (function(_token_45_string){return (false!==(_token_45_complete_63_(_token_45_string))?(function(){_parse_45_token(_context,_token_45_string);_tokens=_next;_ref=1;return _true;})():(function(){_next=_next_45_tokens(_next);return _false;})());})(_builder_45__62_string(_token));})());}));return _exit_63_;})(_next_45_tokens(_tokens),_false);});return _for((function(){return (false!==(_null_63_(_tokens))?(function(){_shift_45_tokens(_context);return _true;})():(false!==(_eq_63_(_vlen(_tokens[0]),_ref))?(function(){_tokens=_next_45_tokens(_tokens);_ref=0;return _false;})():(function(_token){return (false!==(_eq_63_(_token,["eof"]))?(function(){_shift_45_tokens(_context);return _true;})():(false!==(_token_45_complete_63_(_token))?(function(){_parse_45_token(_context,_token);_ref=__43_(_ref,1);return _false;})():_parse_45_incomplete(_sbappend(_make_45_string_45_builder(),_token))));})(_vref(_tokens[0],_ref))));}));})(_read_45_tokens_45_list(_context),_read_45_token_45_ref(_context));});/*append-tokens*/ var _append_45_tokens;_append_45_tokens=(function(_context,_tokens){return _table_45_set_33_(_read_45_tokens(_context),["fragments"],_append(_read_45_tokens_45_list(_context),[_tokens,[]]));});/*read-string*/ var _read_45_string;_read_45_string=(function(_context,_string){return (function(_tokens){_append_45_tokens(_context,_tokens);return _parse_45_tokens(_context);})(_tokenizer_45_rx(_string));});/*shift-expressions*/ var _shift_45_expressions;_shift_45_expressions=(function(_context){return (function(_expressions){_table_45_set_33_(_context,["expressions"],[]);return _reverse(_expressions);})(_read_45_expressions(_context));});/*append-token*/ var _append_45_token;_append_45_token=(function(_context,_token){return _append_45_tokens(_context,_vector(_token));});/*read-complete?*/ var _read_45_complete_63_;_read_45_complete_63_=(function(_context){return (function(_predicate){return (false!==(_predicate)?_null_63_(_read_45_stack(_context)):_predicate);})(_null_63_(_read_45_tokens_45_list(_context)));});/*complete-read*/ var _complete_45_read;_complete_45_read=(function(_context){_append_45_token(_context,["eof"]);_parse_45_tokens(_context);return (false!==(_not(_read_45_complete_63_(_context)))?_error(["complete-read"],"incomplete expression",[_read_45_tokens_45_list(_context),[_read_45_stack(_context),[]]]):_shift_45_expressions(_context));});/*complete-read*/ var _complete_45_read;_complete_45_read=(function(_context){_append_45_token(_context,["eof"]);_parse_45_tokens(_context);return (false!==(_not(_null_63_(_read_45_tokens_45_list(_context))))?_error(["complete-read"],"incomplete expression",_read_45_tokens_45_list(_context)):(false!==(_not(_null_63_(_read_45_stack(_context))))?_error(["complete-read"],"incomplete expression",_read_45_stack(_context)):_shift_45_expressions(_context)));});/*sread*/ var _sread;_sread=(function(_string){return (function(_context){_read_45_string(_context,_string);return _complete_45_read(_context);})(_make_45_read_45_context());});/*command?*/ var _command_63_;_command_63_=(function(_arg){return (function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:(function(_predicate){return (false!==(_predicate)?_predicate:_peq_63_(_arg,"compile"));})(_peq_63_(_arg,"test")));})(_peq_63_(_arg,"run")));})(_peq_63_(_arg,"repl"));});/*explicit-command?*/ var _explicit_45_command_63_;_explicit_45_command_63_=(function(_argv){return _command_63_(_argv[1][1][0]);});/*compiled-run?*/ var _compiled_45_run_63_;_compiled_45_run_63_=(function(){return _compiled_45_procedure_63_(_get_45_command);});/*get-command-from*/ var _get_45_command_45_from;_get_45_command_45_from=(function(_argv){return (false!==(_null_63_(_argv[1][1]))?"repl":(false!==(_command_63_(_argv[1][1][0]))?_argv[1][1][0]:"run"));});/*get-arg-from*/ var _get_45_arg_45_from;_get_45_arg_45_from=(function(_argv){return (false!==(_null_63_(_argv[1][1]))?_error(["get-arg-from"],"missing argument",_argv):(false!==(_explicit_45_command_63_(_argv))?(false!==(_null_63_(_argv[1][1][1]))?_error(["get-arg-from"],"missing argument",_argv):_argv[1][1][1][0]):_argv[1][1][0]));});/*argv-member*/ var _argv_45_member;_argv_45_member=(function(_op){return (function(_argv){return (false!==(_compiled_45_run_63_())?_op(_argv):(false!==(_explicit_45_command_63_(_argv))?_op(_argv[1][1]):_op(_argv[1])));})(_proc_45_argv());});/*get-command*/ var _get_45_command;_get_45_command=(function(){return _argv_45_member(_get_45_command_45_from);});/*get-arg*/ var _get_45_arg;_get_45_arg=(function(){return _argv_45_member(_get_45_arg_45_from);});/*repl*/ var _repl;_repl=(function(){/*env*/ var _env;_env=_create_45_env();/*try-eval-sequence*/ var _try_45_eval_45_sequence;_try_45_eval_45_sequence=(function(_exps){return (false!==(_not(_null_63_(_exps)))?(function(){_try((function(){return _print(_eval_45_env(_env,_exps[0]));}),(function(_err){return _display(_err);}));_newline();return _try_45_eval_45_sequence(_exps[1]);})():_true);});/*read-context*/ var _read_45_context;_read_45_context=_make_45_read_45_context();/*process-line*/ var _process_45_line;_process_45_line=(function(_rl,_line){_read_45_string(_read_45_context,_line);_try_45_eval_45_sequence(_shift_45_expressions(_read_45_context));_set_45_prompt(_rl,(false!==(_read_45_complete_63_(_read_45_context))?"> ":". "));return _prompt(_rl);});/*rl*/ var _rl;_rl=_read_45_line(_process_45_line,"> ");_set_45_prompt(_rl,"> ");return _prompt(_rl);});/*run*/ var _run;_run=(function(){/*read-and-eval*/ var _read_45_and_45_eval;_read_45_and_45_eval=(function(_scm){return (function(_ctx){_read_45_string(_ctx,_scm);return (function(_exps){_complete_45_read(_ctx);return _eval_45_env(_create_45_env(),[[["lambda"],[[],_exps]],[]]);})(_shift_45_expressions(_ctx));})(_make_45_read_45_context());});return _read_45_file(_get_45_arg(),_read_45_and_45_eval);});/*compile*/ var _compile;_compile=(function(){/*compile-head-references*/ var _compile_45_head_45_references;_compile_45_head_45_references=(function(_hcontext,_head_45_names){return (false!==(_not(_null_63_(_head_45_names)))?(function(){_compile_45_write(_hcontext,"var ");_compile_45_write(_hcontext,_map_45_name(_hcontext,_head_45_names[0]));_compile_45_write(_hcontext,"=env(\"");_compile_45_write(_hcontext,_head_45_names[0]);_compile_45_write(_hcontext,"\");");return _compile_45_head_45_references(_hcontext,_head_45_names[1]);})():_true);});/*precompile*/ var _precompile;_precompile=(function(_head,_done,_ccontext,_pcontext,_shared){return (function(_shared_45_names){return (false!==(_not(_null_63_(_shared_45_names)))?(function(_name){(false!==((function(_predicate){return (false!==(_predicate)?_table_45_has_45_name_63_(_compile_45_expressions(_ccontext),_name):_predicate);})(_not(_table_45_has_45_name_63_(_done,_name))))?(function(){_compile_45_statement(_pcontext,_precompile_45_exp(_table_45_lookup(_compile_45_expressions(_ccontext),_name)),_false);return _copy_45_table_45_filtered(_table_45_lookup(_compile_45_definitions(_ccontext),_name),_shared,(function(_name){return _not((function(_predicate){return (false!==(_predicate)?_predicate:_defined_63_(_head,_name));})(_table_45_has_45_name_63_(_done,_name)));}));})():_true);_table_45_define(_done,_name,_true);_table_45_delete_33_(_shared,_name);return _precompile(_head,_done,_ccontext,_pcontext,_shared);})(_shared_45_names[0]):_true);})(_table_45_names(_shared));});/*read-and-compile*/ var _read_45_and_45_compile;_read_45_and_45_compile=(function(_names,_scm){return (function(_read_45_context,_hcontext,_ccontext){_compile_45_head_45_references(_hcontext,_head(_false,_false,_false,_true));_read_45_string(_read_45_context,_scm);return (function(_exps){_complete_45_read(_read_45_context);_compile_45_sequence(_ccontext,_exps);return (function(_pcontext){_compile_45_statement(_pcontext,[["define"],[["shared-precompiled"],[[["quote"],[[],[]]],[]]]],_false);_precompile(_extend_45_env(_head),_make_45_name_45_table(),_ccontext,_pcontext,_to_45_table(_shared(),(function(_i){return _i[0];}),_identity));_out(_builder_45__62_string(_compile_45_buffer(_hcontext)));_out(_builder_45__62_string(_compile_45_buffer(_pcontext)));return _out(_builder_45__62_string(_compile_45_buffer(_ccontext)));})(_make_45_compile_45_context(_names));})(_shift_45_expressions(_read_45_context));})(_make_45_read_45_context(),_make_45_compile_45_context(_names),_make_45_compile_45_context(_names));});return _copy_45_head((function(){return (function(_names){return (function(_ccontext){_compile_45_shared(_ccontext);_out(_builder_45__62_string(_compile_45_buffer(_ccontext)));return _read_45_file(_get_45_arg(),(function(_scm){return _read_45_and_45_compile(_names,_scm);}));})(_make_45_compile_45_context(_names));})(_make_45_name_45_map());}));});/*caar*/ var _caar;_caar=(function(_l){return _l[0][0];});/*cadr*/ var _cadr;_cadr=(function(_l){return _l[1][0];});/*cdar*/ var _cdar;_cdar=(function(_l){return _l[0][1];});/*cddr*/ var _cddr;_cddr=(function(_l){return _l[1][1];});/*caaar*/ var _caaar;_caaar=(function(_l){return _l[0][0][0];});/*caadr*/ var _caadr;_caadr=(function(_l){return _l[1][0][0];});/*cadar*/ var _cadar;_cadar=(function(_l){return _l[0][1][0];});/*cdaar*/ var _cdaar;_cdaar=(function(_l){return _l[0][0][1];});/*caddr*/ var _caddr;_caddr=(function(_l){return _l[1][1][0];});/*cdadr*/ var _cdadr;_cdadr=(function(_l){return _l[1][0][1];});/*cddar*/ var _cddar;_cddar=(function(_l){return _l[0][1][1];});/*cdddr*/ var _cdddr;_cdddr=(function(_l){return _l[1][1][1];});/*caaaar*/ var _caaaar;_caaaar=(function(_l){return _l[0][0][0][0];});/*caaadr*/ var _caaadr;_caaadr=(function(_l){return _l[1][0][0][0];});/*caadar*/ var _caadar;_caadar=(function(_l){return _l[0][1][0][0];});/*cadaar*/ var _cadaar;_cadaar=(function(_l){return _l[0][0][1][0];});/*cdaaar*/ var _cdaaar;_cdaaar=(function(_l){return _l[0][0][0][1];});/*caaddr*/ var _caaddr;_caaddr=(function(_l){return _l[1][1][0][0];});/*cadadr*/ var _cadadr;_cadadr=(function(_l){return _l[1][0][1][0];});/*cdaadr*/ var _cdaadr;_cdaadr=(function(_l){return _l[1][0][0][1];});/*caddar*/ var _caddar;_caddar=(function(_l){return _l[0][1][1][0];});/*cdadar*/ var _cdadar;_cdadar=(function(_l){return _l[0][1][0][1];});/*cddaar*/ var _cddaar;_cddaar=(function(_l){return _l[0][0][1][1];});/*cadddr*/ var _cadddr;_cadddr=(function(_l){return _l[1][1][1][0];});/*cdaddr*/ var _cdaddr;_cdaddr=(function(_l){return _l[1][1][0][1];});/*cddadr*/ var _cddadr;_cddadr=(function(_l){return _l[1][0][1][1];});/*cdddar*/ var _cdddar;_cdddar=(function(_l){return _l[0][1][1][1];});/*cddddr*/ var _cddddr;_cddddr=(function(_l){return _l[1][1][1][1];});/*shared*/ var _shared;_shared=(function(){return [[["eval"],[_eval,[]]],[[["apply"],[_apply,[]]],[[["log"],[_log,[]]],[[["print"],[_print,[]]],[[["eq?"],[_eq_63_,[]]],[[["newline"],[_newline,[]]],[[["error"],[_error,[]]],[[["not"],[_not,[]]],[[["make-name-table"],[_make_45_name_45_table,[]]],[[["table-define"],[_table_45_define,[]]],[[["table-lookup"],[_table_45_lookup,[]]],[[["table-set!"],[_table_45_set_33_,[]]],[[["append"],[_append,[]]],[[["sprint"],[_sprint,[]]],[[["reverse"],[_reverse,[]]],[[["display"],[_display,[]]],[[["sescape"],[_sescape,[]]],[[["caar"],[_caar,[]]],[[["cadr"],[_cadr,[]]],[[["cdar"],[_cdar,[]]],[[["cddr"],[_cddr,[]]],[[["caaar"],[_caaar,[]]],[[["caadr"],[_caadr,[]]],[[["cadar"],[_cadar,[]]],[[["cdaar"],[_cdaar,[]]],[[["caddr"],[_caddr,[]]],[[["cdadr"],[_cdadr,[]]],[[["cddar"],[_cddar,[]]],[[["cdddr"],[_cdddr,[]]],[[["caaaar"],[_caaaar,[]]],[[["caaadr"],[_caaadr,[]]],[[["caadar"],[_caadar,[]]],[[["cadaar"],[_cadaar,[]]],[[["cdaaar"],[_cdaaar,[]]],[[["caaddr"],[_caaddr,[]]],[[["cadadr"],[_cadadr,[]]],[[["cdaadr"],[_cdaadr,[]]],[[["caddar"],[_caddar,[]]],[[["cdadar"],[_cdadar,[]]],[[["cddaar"],[_cddaar,[]]],[[["cadddr"],[_cadddr,[]]],[[["cdaddr"],[_cdaddr,[]]],[[["cddadr"],[_cddadr,[]]],[[["cdddar"],[_cdddar,[]]],[[["cddddr"],[_cddddr,[]]],[[["shared-precompiled"],[_shared_45_precompiled,[]]],[]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]];});/*create-env*/ var _create_45_env;_create_45_env=(function(){/*list->table*/ var _list_45__62_table;_list_45__62_table=(function(_t,_l){return (false!==(_null_63_(_l))?_t:(function(){_table_45_define(_t,_l[0][0],_l[0][1][0]);return _list_45__62_table(_t,_l[1]);})());});return _extend_45_env(_mikkamakka,_list_45__62_table(_make_45_name_45_table(),_shared()));});(function(_cmd){return (false!==(_peq_63_(_cmd,"repl"))?_repl():(false!==(_peq_63_(_cmd,"run"))?_run():(false!==(_peq_63_(_cmd,"compile"))?_compile():_true)));})(_get_45_command());/*last-test-name*/ var _last_45_test_45_name;_last_45_test_45_name=_false;/*string-contains?*/ var _string_45_contains_63_;_string_45_contains_63_=(function(_val,_pattern){return __62__61_(_sidx(_sprint(_val),_pattern),0);});/*list-eq?*/ var _list_45_eq_63_;_list_45_eq_63_=(function(_left,_right){return (false!==((function(_predicate){return (false!==(_predicate)?_predicate:_not(_pair_63_(_right)));})(_not(_pair_63_(_left))))?_eq_63_(_left,_right):(false!==(_not(_list_45_eq_63_(_left[0],_right[0])))?_false:_list_45_eq_63_(_left[1],_right[1])));});/*assert*/ var _assert;_assert=(function(_val,_msg){return (false!==(_val)?_val:(function(){_print(_cats(_last_45_test_45_name,": failed: ",_msg));return _exit(-1);})());});/*fail*/ var _fail;_fail=(function(_msg,_f){return _try((function(){_f();return _assert(_false,_msg);}),(function(_error){return (false!==(_not(_string_45_contains_63_(_error,_msg)))?(function(){_print_45_stack(_error);return _assert(_false,_msg);})():_true);}));});/*test*/ var _test;_test=(function(_name,_f){_last_45_test_45_name=_name;return (function(_env){return _try((function(){return _f((function(_exp){return _eval_45_env(_env,_exp);}));}),(function(_error){_print(_cats(_name,": error during test:"));_print_45_stack(_error);return _exit();}));})(_create_45_env());});/*run-tests*/ var _run_45_tests;_run_45_tests=(function(){_test("symbol?",(function(__){_assert(_symbol_63_(["a"]),"true");return _assert(_not(_symbol_63_("a")),"false");}));_test("len",(function(__){_assert(_eq_63_(_len([1,[2,[3,[]]]]),3),"3");return _assert(_eq_63_(_len([]),0),"0");}));_test("quote-eq?",(function(__){_assert(_quote_45_eq_63_([["quote"],[["a"],[]]],[["quote"],[["a"],[]]]),"eq");return _assert(_not(_quote_45_eq_63_([["quote"],[["a"],[]]],[["quote"],[["b"],[]]])),"not eq");}));_test("eq",(function(__){_assert(_eq_63_([],[]),"null");_assert(_eq_63_(["a"],["a"]),"symbol");_assert(_eq_63_([["quote"],[["a"],[]]],[["quote"],[["a"],[]]]),"quote");_assert(_eq_63_(1,1),"primitive");return (function(_a){return (function(_b){return _assert(_eq_63_(_a,_b),"reference");})(_a);})((function(){return 1;}));}));_test("tagged-list?",(function(__){_assert(_tagged_45_list_63_([["a"],[]],["a"]),"true");_assert(_not(_tagged_45_list_63_([["a"],[]],["b"])),"wrong tag");return _assert(_not(_tagged_45_list_63_(1,["a"])),"not list");}));_test("check-quote",(function(__){return _assert(_eq_63_(_check_45_quote([["quote"],[["a"],[]]]),_true),"ok");}));_test("escape",(function(__){_assert(_eq_63_(_sescape("\b\t\v\f\n\r\\\""),"\\b\\t\\v\\f\\n\\r\\\\\\\""),"escape");_assert(_list_45_eq_63_(_sread("\"\b\t\v\f\n\r\\\\\\\"\""),["\b\t\v\f\n\r\\\"",[]]),"read");_assert(_eq_63_(_sunescape("\\b\\t\\v\\f\\n\\r\\\\\\\""),"\b\t\v\f\n\r\\\""),"unescape");_assert(_list_45_eq_63_(_sread("\"\\b\\t\\v\\f\\n\\r\\\\\\\"\""),["\b\t\v\f\n\r\\\"",[]]),"read escaped");_assert(_eq_63_(_sescape_45_symbol_45_name("a"),"a"),"symbol name normal");return _assert(_eq_63_(_sescape_45_symbol_45_name("a\na"),"|a\na|"),"symbol name escaped");}));_test("sprint",(function(__){_assert(_eq_63_(_sprint(1),"1"),"number");_assert(_eq_63_(_sprint("some string"),"\"some string\""),"string");_assert(_eq_63_(_sprint("some string with \"apostrophs\" in it"),"\"some string with \\\"apostrophs\\\" in it\""),"string, apostrophs");_assert(_eq_63_(_sprint(["a"]),"'a"),"quote");_assert(_eq_63_(_sprint([["a"],[["b"],[["c"],[]]]]),"'(a b c)"),"list");_assert(_eq_63_(_sprint([["a"],[["b"],[[["c"],[[["quote"],[["d"],[]]],[]]],[]]]]),"'(a b (c 'd))"),"list, embedded list");_assert(_eq_63_(_sprint([["a"],[["b"],[[["quote"],[[["c"],[[["quote"],[["d"],[]]],[]]],[]]],[]]]]),"'(a b '(c 'd))"),"list, embedded quoted list");return _assert(_eq_63_(_sprint([["a"],[["b"],[[["quote"],[[["c"],[[["quote"],[["d"],[]]],[[["quote"],[[["quote"],[["d"],[]]],[]]],[]]]],[]]],[]]]]),"'(a b '(c 'd ''d))"),"list, double quote");}));_test("self-evaluating?",(function(__){_assert(_self_45_evaluating_63_(_false),"false");_assert(_self_45_evaluating_63_(_true),"true");_assert(_self_45_evaluating_63_(1),"number");_assert(_self_45_evaluating_63_("some string"),"string");return _assert(_not(_self_45_evaluating_63_((function(){return _false;}))),"lambda");}));_test("check-assignment",(function(__){_assert(_eq_63_(_check_45_assignment([["set!"],[["a"],[1,[]]]]),_true),"valid");_fail("invalid arity",(function(){return _check_45_assignment([["set!"],[["a"],[]]]);}));return _fail("invalid variable name",(function(){return _check_45_assignment([["set!"],[1,[1,[]]]]);}));}));_test("definition-variable",(function(__){_assert(_eq_63_(_definition_45_variable([["define"],[["a"],[1,[]]]]),["a"]),"variable");return _assert(_eq_63_(_definition_45_variable([["define"],[[["a"],[]],[1,[]]]]),["a"]),"procedure");}));_test("definition-value",(function(__){_assert(_eq_63_(_definition_45_value([["define"],[["a"],[1,[]]]]),1),"variable");return _assert(_list_45_eq_63_(_definition_45_value([["define"],[[["a"],[]],[1,[2,[]]]]]),[["lambda"],[[],[1,[2,[]]]]]),"procedure");}));_test("check-definition",(function(__){_assert(_eq_63_(_check_45_definition([["define"],[["a"],[1,[]]]]),_true),"variable");_assert(_eq_63_(_check_45_definition([["define"],[[["a"],[]],[1,[]]]]),_true),"procedure");_fail("invalid format",(function(){return _check_45_definition([["define"],[["a"],[]]]);}));return _fail("invalid variable name",(function(){return _check_45_definition([["define"],[[1,[]],[1,[]]]]);}));}));_test("validate-if",(function(__){_assert(_eq_63_(_check_45_if([["if"],[1,[2,[3,[]]]]]),_true),"valid");return _fail("invalid arity",(function(){return _check_45_if([["if"],[1,[2,[3,[4,[]]]]]]);}));}));_test("check-lambda",(function(__){_assert(_eq_63_(_check_45_lambda([["lambda"],[[],[1,[]]]]),_true),"valid");_fail("invalid arity",(function(){return _check_45_lambda([["lambda"],[[],[]]]);}));return _fail("invalid argument list",(function(){return _check_45_lambda([["lambda"],[1,[2,[]]]]);}));}));_test("validate-begin",(function(__){_assert(_check_45_begin([["begin"],[1,[]]]),"valid");return _fail("invalid arity",(function(){return _check_45_begin([["begin"],[]]);}));}));_test("sequence->exp",(function(__){_assert(_eq_63_(_sequence_45__62_exp([]),[]),"null");_assert(_eq_63_(_sequence_45__62_exp([1,[]]),1),"single item");return _assert(_list_45_eq_63_(_sequence_45__62_exp([1,[2,[]]]),[["begin"],[1,[2,[]]]]),"sequence");}));_test("expand-clauses",(function(__){_assert(_list_45_eq_63_(_expand_45_clauses([[1,[1,[]]],[[2,[2,[]]],[[["else"],[3,[]]],[]]]]),[["if"],[1,[1,[[["if"],[2,[2,[3,[]]]]],[]]]]]),"ok");_fail("invalid syntax",(function(){return _expand_45_clauses([1,[[2,[2,[]]],[[["else"],[3,[]]],[]]]]);}));return _fail("else clause isn't last",(function(){return _expand_45_clauses([[1,[1,[]]],[[["else"],[2,[]]],[[3,[3,[]]],[]]]]);}));}));_test("expand-and",(function(__){_assert(_list_45_eq_63_(_expand_45_and([]),["true"]),"null");return _assert(_list_45_eq_63_(_expand_45_and([1,[2,[3,[]]]]),[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[3,[["predicate"],[]]]]],[]]]],[2,[]]],[["predicate"],[]]]]],[]]]],[1,[]]]),"list");}));_test("expand-or",(function(__){_assert(_list_45_eq_63_(_expand_45_or([]),["false"]),"null");return _assert(_list_45_eq_63_(_expand_45_or([1,[2,[3,[]]]]),[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[3,[]]]]],[]]]],[2,[]]],[]]]]],[]]]],[1,[]]]),"list");}));_test("validate-let",(function(__){_assert(_eq_63_(_check_45_let([["let"],[[[["a"],[1,[]]],[]],[["a"],[]]]]),_true),"ok");_fail("invalid arity",(function(){return _check_45_let([["let"],[[[["a"],[1,[]]],[]],[]]]);}));return _fail("invalid syntax",(function(){return _check_45_let([["let"],[1,[1,[]]]]);}));}));_test("let->procedure",(function(__){return _assert(_list_45_eq_63_(_let_45__62_procedure([["let"],[[[["a"],[1,[]]],[]],[["a"],[]]]]),[[["lambda"],[[["a"],[]],[["a"],[]]]],[1,[]]]),"transform");}));_test("false, true",(function(_eval){_assert(_eq_63_(_eval(["false"]),_false),"false");return _assert(_eq_63_(_eval(["true"]),_true),"true");}));_test("self evaluation",(function(_eval){_assert(_eq_63_(_eval(1),1),"number");return _assert(_eq_63_(_eval("some string"),"some string"),"string");}));_test("variable",(function(_eval){_fail(".*",(function(){return _eval(["a"]);}));_assert(_eq_63_(_eval([["define"],[["a"],[1,[]]]]),1),"definition");return _assert(_eq_63_(_eval(["a"]),1),"lookup");}));_test("quote",(function(_eval){_fail("invalid quotation",(function(){return _eval([["quote"],[]]);}));_assert(_eq_63_(_eval(1),1),"number");_assert(_eq_63_(_eval("some string"),"some string"),"string");return _assert(_eq_63_(_eval([["quote"],[["a"],[]]]),["a"]),"quote");}));_test("assignment",(function(_eval){_assert(_eq_63_(_eval([["define"],[["a"],[1,[]]]]),1),"define");_assert(_eq_63_(_eval([["set!"],[["a"],[2,[]]]]),2),"assign");_assert(_eq_63_(_eval(["a"]),2),"lookup");_assert(_eq_63_(_eval([[["lambda"],[[],[[["define"],[["a"],[3,[]]]],[[["set!"],[["a"],[4,[]]]],[["a"],[]]]]]],[]]),4),"in lambda");return _assert(_eq_63_(_eval([["apply"],[[["lambda"],[[],[[["define"],[["a"],[3,[]]]],[[["set!"],[["a"],[4,[]]]],[["a"],[]]]]]],[[["quote"],[[],[]]],[]]]]),4),"in apply");}));_test("define",(function(_eval){_assert(_eq_63_(_eval([["define"],[["a"],[1,[]]]]),1),"define variable");_assert(_eq_63_(_eval(["a"]),1),"verify variable");return _eval([["define"],[[["a"],[]],[2,[]]]]);}));_test("if",(function(_eval){_assert(_eq_63_(_eval([["if"],[["false"],[1,[0,[]]]]]),0),"false");_assert(_eq_63_(_eval([["if"],[["true"],[1,[0,[]]]]]),1),"true");return _assert(_eq_63_(_eval([["if"],["anything else",[1,[0,[]]]]]),1),"anything else");}));_test("lambda",(function(_eval){return _assert(_eq_63_(_eval([[["lambda"],[[],[1,[]]]],[]]),1),"create and call lambda");}));_test("begin",(function(_eval){_assert(_eq_63_(_eval([["begin"],[[["define"],[["a"],[1,[]]]],[2,[]]]]),2),"execute sequence");_assert(_eq_63_(_eval(["a"]),1),"verify side effect");return _fail("arity",(function(){return _eval([["begin"],[]]);}));}));_test("cond",(function(_eval){_assert(_eq_63_(_eval([["cond"],[[["true"],[0,[]]],[[["false"],[1,[]]],[[["else"],[2,[]]],[]]]]]),0),"first");_assert(_eq_63_(_eval([["cond"],[[["false"],[0,[]]],[[["true"],[1,[]]],[[["else"],[2,[]]],[]]]]]),1),"second");_assert(_eq_63_(_eval([["cond"],[[["false"],[0,[]]],[[["false"],[1,[]]],[[["else"],[2,[]]],[]]]]]),2),"else");_assert(_eq_63_(_eval([["cond"],[]]),_true),"no clauses");_assert(_eq_63_(_eval([["cond"],[[["false"],[]],[]]]),_true),"implicit else clause");return _fail("invalid syntax",(function(){return _eval([["cond"],[1,[]]]);}));}));_test("and",(function(_eval){_assert(_eq_63_(_eval([["and"],[]]),_true),"no expression");_assert(_eq_63_(_eval([["and"],[["false"],[]]]),_false),"single, false");_assert(_eq_63_(_eval([["and"],[["true"],[]]]),_true),"single, true");_assert(_eq_63_(_eval([["and"],["something",[]]]),"something"),"single, string");_assert(_eq_63_(_eval([["and"],[1,[2,[]]]]),2),"two");_assert(_eq_63_(_eval([["and"],[1,[2,[3,[]]]]]),3),"three");_assert(_eq_63_(_eval([["and"],[1,[2,[["false"],[]]]]]),_false),"three, false");_assert(_eq_63_(_eval([["and"],[1,[["false"],[2,[]]]]]),_false),"two, false");return _assert(_eq_63_(_eval([["and"],[["false"],[1,[2,[]]]]]),_false),"one, false");}));_test("or",(function(_eval){_assert(_eq_63_(_eval([["or"],[]]),_false),"no expression");_assert(_eq_63_(_eval([["or"],[["false"],[]]]),_false),"single, false");_assert(_eq_63_(_eval([["or"],[["true"],[]]]),_true),"single, true");_assert(_eq_63_(_eval([["or"],["something",[]]]),"something"),"something");_assert(_eq_63_(_eval([["or"],[1,[]]]),1),"number");_assert(_eq_63_(_eval([["or"],[1,[2,[]]]]),1),"two");_assert(_eq_63_(_eval([["or"],[1,[2,[3,[]]]]]),1),"three");_assert(_eq_63_(_eval([["or"],[1,[["false"],[]]]]),1),"first");_assert(_eq_63_(_eval([["or"],[["false"],[1,[]]]]),1),"second");return _assert(_eq_63_(_eval([["or"],[["false"],[["false"],[1,[]]]]]),1),"third");}));_test("let",(function(_eval){_assert(_eq_63_(_eval([["let"],[[[["a"],[1,[]]],[[["b"],[2,[]]],[]]],[["b"],[["a"],[]]]]]),1),"sequence");_assert(_eq_63_(_eval([["let"],[[[["a"],[1,[]]],[[["b"],[2,[]]],[]]],[[["and"],[["a"],[["b"],[]]]],[]]]]),2),"operation");_fail("invalid arity",(function(){return _eval([["let"],[]]);}));_fail("invalid syntax",(function(){return _eval([["let"],[1,[2,[3,[]]]]]);}));return _fail(".*",(function(){return _eval([["let"],[[1,[]],[2,[3,[]]]]]);}));}));_test("application",(function(_eval){_assert(_eq_63_(_eval([[["lambda"],[[],[1,[]]]],[]]),1),"lambda");_eval([["define"],[[["a"],[]],[1,[]]]]);_assert(_eq_63_(_eval([["a"],[]]),1),"procedure from shortcut");_eval([["define"],[["a"],[[["lambda"],[[],[2,[]]]],[]]]]);_assert(_eq_63_(_eval([["a"],[]]),2),"procedure from variable");_eval([["define"],[[["a"],[["x"],[]]],[[["if"],[["x"],["it's true",["it's false",[]]]]],[]]]]);_assert(_eq_63_(_eval([["a"],[["true"],[]]]),"it's true"),"with args, true");_assert(_eq_63_(_eval([["a"],[["false"],[]]]),"it's false"),"with args, false");return _assert(_eq_63_(_eval([["a"],["just anything",[]]]),"it's true"),"with args, anything");}));_test("primitive procedures",(function(_eval){return _assert(_eq_63_(_eval([["+"],[1,[2,[]]]]),3),"add");}));_test("try",(function(_eval){_assert(_eq_63_(_try((function(){return 1;}),(function(_err){return 2;})),1),"try");_assert(_eq_63_(_try((function(){return _error(["try"],"err","test");}),(function(_err){return 1;})),1),"catch");_assert(_eq_63_(_eval([["try"],[[["lambda"],[[],[1,[]]]],[[["lambda"],[[["err"],[]],[2,[]]]],[]]]]),1),"eval, try");_assert(_eq_63_(_eval([["try"],[[["lambda"],[[],[[["error"],[[["quote"],[["try"],[]]],["err",["test",[]]]]],[]]]],[[["lambda"],[[["err"],[]],[1,[]]]],[]]]]),1),"eval, catch");_assert(_eq_63_(_eval([["try"],[[["lambda"],[[],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]]],[[["lambda"],[[["err"],[]],[2,[]]]],[]]]]),1),"primitive call, try");return _assert(_eq_63_(_eval([["try"],[[["lambda"],[[],[[["error"],[[["quote"],[["try"],[]]],["err",["test",[]]]]],[]]]],[[["lambda"],[[["error"],[]],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]]],[]]]]),1),"primitive call, catch");}));_test("for",(function(_eval){_assert(_eq_63_(_for((function(){return _true;})),_true),"exit immediately");_assert(_eq_63_((function(_n){return _for((function(){_n=__43_(_n,1);return (function(_predicate){return (false!==(_predicate)?_n:_predicate);})(__62_(_n,2));}));})(0),3),"count to 3");_assert(_eq_63_(_eval([["for"],[[["lambda"],[[],[["true"],[]]]],[]]]),_true),"eval, exit immediately");return _assert(_eq_63_(_eval([["let"],[[[["n"],[0,[]]],[]],[[["for"],[[["lambda"],[[],[[["set!"],[["n"],[[["+"],[["n"],[1,[]]]],[]]]],[[["and"],[[[">"],[["n"],[2,[]]]],[["n"],[]]]],[]]]]],[]]],[]]]]),3),"eval, count to 3");}));_test("eval",(function(_eval){return _assert(_eq_63_(_eval([["eval"],[[["quote"],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]],[]]]),1),"inner eval");}));_test("apply",(function(_eval){return _assert(_eq_63_(_eval([["apply"],[["car"],[[["quote"],[[[1,[2,[]]],[]],[]]],[]]]]),1),"inner apply");}));_test("vector",(function(_eval){_assert(_vector_63_({vector:[1,2,3]}),"vector literal");_assert(_vector_63_(_sread("#(1 2 3)")[0]),"read vector");_assert(_vector_63_(_eval(_sread("#(1 2 3)")[0])),"eval vector");_assert(_eq_63_(_sprint(_sread("#(1 2 3)")[0]),"#(1 2 3)"),"print vector");return _assert(_eq_63_(_sprint(_sread("'(a b #(1 2 (1 2 3) c #(1 2 3 4)))")[0]),"'(a b #(1 2 (1 2 3) c #(1 2 3 4)))"),"compose vector");}));return ["end-tests"];});return (false!==(_peq_63_(_get_45_command(),"test"))?_run_45_tests():_true);