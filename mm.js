var env = (function () {
    var isSymbol = function (s) {
        return !!s &&
            s instanceof Array &&
            s.length === 1 &&
            typeof s[0] === "string";
    };

    var symbolName = function (symbol) {
        return symbol[0];
    };

    var stringToSymbol = function (name) {
        return [name];
    };

    var peq = function (left, right) {
        return left === right;
    };

    var filter = function (pred, l) {
        if (isNull(l)) {
            return list();
        }
        return pred(car(l)) ?
            cons(car(l), filter(pred, cdr(l))) :
            filter(pred, cdr(l));
    };

    var isTable = function (t) {
        return !!(t && t.isTable);
    };

    var makeNameTable = function () {
        var names = [];
        var table = {};
        var t = function (modNames, op) {
            names = modNames(names, table);
            return op(names, table);
        };
        t.isTable = true;
        return t;
    };

    var tableNoop = function (names, _) {
        return names;
    };

    var tableNames = function (table) {
        return table(tableNoop, tableNoop);
    };

    var tableHasName = function (table, name) {
        return table(tableNoop, function (_, table) {
            return symbolName(name) in table;
        });
    };

    var tableLookup = function (table, name) {
        return table(tableNoop, function (_, table) {
            name = symbolName(name);
            var val = table[name];
            if (val === undefined) {
                return cerror("tableLookup", "name is not defined", name);
            }
            return val;
        });
    };

    var tableDefine = function (table, name, val) {
        var sname = symbolName(name);
        return table(function (names, table) {
            return sname in table ? names : [name, names];
        }, function (_, table) {
            table[sname] = val;
            return val;
        });
    };

    var tableSet = function (table, name, val) {
        return table(tableNoop, function (_, table) {
            name = symbolName(name);
            if (!(name in table)) {
                return cerror("tableSet", "name is not defined", name);
            }
            table[name] = val;
            return val;
        });
    };

    var tableDelete = function (table, name) {
        return table(function (names, _) {
            return filter(function (i) { return i[0] !== name[0]; }, names);
        }, function (_, table) {
            var has = name[0] in table;
            delete table[name[0]];
            return has;
        });
    };

    var isNull = function (l) {
        return !!l &&
            l instanceof Array &&
            l.length === 0;
    };

    var cons = function (left, right) {
        return [left, right];
    };

    var isPair = function (p) {
        return !!p &&
            p instanceof Array &&
            p.length === 2;
    };

    var car = function (p) {
        return p[0];
    };

    var cdr = function (p) {
        return p[1];
    };

    var list = function () {
        var l = [];
        for (var i = arguments.length - 1; i >= 0; i--) {
            l = cons(arguments[i], l);
        }
        return l;
    };

    var isCompiledProcedure = function (p) {
        return !!p && typeof p === "function";
    };

    var capply = function (p, args) {
        var jsArgs = [];
        for (;;) {
            if (isNull(args)) {
                break;
            }
            jsArgs[jsArgs.length] = car(args);
            args = cdr(args);
        }
        return p.apply(undefined, jsArgs);
    };

    var tryc = function (t, c) {
        try {
            return env("apply")(t, list());
        } catch (error) {
            return env("apply")(c, list(error));
        }
    };

    var forLoop = function (body) {
        for (;;) {
            var result = env("apply")(body, list());
            if (false !== result) {
                return result;
            }
        }
    };

    var readFile = function (f, clb) {
        require("fs").readFile(f, function (err, data) {
            if (err) {
                return cerror("readFile", "error while reading file", err);
            }
            return env("apply")(clb, list(data.toString()));
        });
        return noPrint;
    };

    var readLine = function (clb, prompt) {
        var rl = require("readline").createInterface(process.stdin, process.stdout);
        var frl = function (f) {
            return f(rl);
        };
        rl.on("line", function (l) {
            env("apply")(clb, list(frl, l));
        });
        return frl;
    };

    var prompt = function (rl) {
        return rl(function (rrl) {
            rrl.prompt();
            return noPrint;
        });
    };

    var setPrompt = function (rl, p) {
        return rl(function (rrl) {
            rrl.setPrompt(p);
            return noPrint;
        });
    };

    var isNumber = function (n) {
        return typeof n === "number" && !Number.isNaN(n);
    };

    var parseNumber = function (s) {
        var num = parseFloat(s);
        if (isNumber(num)) {
            return num;
        }
        return s;
    };

    var identity = function (x) { return x; };

    var mkNumOp = function (initial, single, reduce) {
        return function () {
            var args = Array.prototype.slice.call(arguments);
            if (!args.length) {
                return initial;
            }
            if (args.length === 1) {
                return single(args[0]);
            }
            return args.slice(1).reduce(function (previous, current) {
                return reduce(previous, current);
            }, args[0]);
        };
    };

    var add = mkNumOp(0, identity, function (x, y) { return x + y; });

    var sub = mkNumOp(0, function (x) {
        return 0 - x;
    }, function (x, y) {
        return x - y;
    });

    var mul = mkNumOp(1, identity, function (x, y) { return x * y; });

    var div = mkNumOp(1, function (x) {
        return 1 / x;
    }, function (x, y) {
        return x / y;
    });

    var mod = function (dnd, dvs) {
        return dnd % dvs;
    };

    var gt = function (left, right) {
        return left > right;
    };

    var lt = function (left, right) {
        return left < right;
    };

    var gte = function (left, right) {
        return left >= right;
    };

    var lte = function (left, right) {
        return left <= right;
    };

    var isString = function (s) {
        return typeof s === "string";
    };

    var slen = function (s) {
        return s.length;
    };

    var sidx = function (s, expression) {
        var m = s.match(new RegExp(expression), "");
        if (!m) {
            return -1;
        }
        return m.index;
    };

    var charAt = function (s, i) {
        return s[i];
    };

    var subs = function (s, offset, count) {
        if (count < 0) {
            return s.substr(offset);
        }
        return s.substr(offset, count);
    };

    var sreplace = function (s, expression, replace) {
        return s.replace(new RegExp(expression, "g"), replace);
    };

    var mkStringBuilder = function () {
        return {sb: []};
    };

    var isStringBuilder = function (b) {
        return !!b && b.sb;
    };

    var sbempty = function (b) {
        for (var i = 0; i < b.sb.length; i++) {
            if (b.sb[i].length) {
                return false;
            }
        }
        return true;
    };

    var sbappend = function (b, s) {
        if (isStringBuilder(s)) {
            return {
                sb: b.sb.concat(s.sb)
            };
        }
        return {
            sb: b.sb.concat(s)
        }
    };

    var builderToString = function (b) {
        return b.sb.join("");
    };

    // no-head, once variadic arguments
    var cats = function () {
        var b = mkStringBuilder();
        for (var i = 0; i < arguments.length; i++) {
            b = sbappend(b, arguments[i]);
        }
        return builderToString(b);
    };

    var noPrint = function () { return noPrint; };

    var out = process && process.stdout && function (str) {
        if (str !== noPrint) {
            process.stdout.write(String(str));
        }
        return noPrint;
    };

    var log = process && process.stderr && function (s) {
        if (s !== noPrint) {
            process.stderr.write(String(s));
        }
        process.stderr.write("\n");
        return noPrint;
    } || function (s) {
        if (s !== noPrint) {
            console.log(s);
        } else {
            console.log();
        }
        return noPrint;
    };

    var cerror = function (where, what, arg) {
        throw new Error(String(where) + ":" + String(what) + ":" + String(arg));
        return noPrint;
    };

    var isError = function (error) {
        return error instanceof Error;
    };

    var sprintError = function (error) {
        return error && error.message || "error";
    };

    var sprintStack = function (error) {
        return error && error.stack || "";
    };

    var now = function () {
        return {t: new Date()};
    };

    var isTime = function (t) {
        return !!t && t.t instanceof Date;
    };

    var numberToTime = function (n) {
        return new Date(n);
    };

    var timeToNumber = function (t) {
        return t.t.valueOf();
    };

    var timeToString = function (t) {
        return t.t.toString();
    };

    var exit = function (val) {
        process.exit(val);
    };

    var argv = function () {
        return list.apply(undefined, process.argv);
    };

    var makeRegexp = function (expression, flags) {
        var regexp = new RegExp(expression, flags);
        return function (text) {
            return vector.apply(undefined, text.match(regexp) || []);
        };
    };

    var isVector = function (exp) {
        return !!exp &&
            exp.vector instanceof Array;
    };

    var vector = function () {
        return {vector: Array.prototype.slice.call(arguments)};
    };

    var vlen = function (v) {
        return v.vector.length;
    };

    var vref = function (v, i) {
        return v.vector[i];
    };

    var listToVector = function (list, reverse) {
        var v = vector();
        for (;;) {
            if (isNull(list)) {
                return v;
            }
            v.vector[reverse ? "unshift" : "push"](car(list));
            list = cdr(list);
        }
    };

    var vectorToList = function (v, reverse) {
        var l = list();
        var len = vlen(v);
        for (var i = 0; i < len; i++) {
            l = cons(vref(reverse ? len - i - 1 : i), l);
        }
        return l;
    };

    var head = makeNameTable();
    var share = function (name, member) {
        return tableDefine(head, [name], member);
    };
    share("compiled-procedure?", isCompiledProcedure);
    share("capply", capply);
    share("symbol?", isSymbol);
    share("symbol-name", symbolName);
    share("string->symbol", stringToSymbol);
    share("identity", identity);
    share("null?", isNull);
    share("cons", cons);
    share("pair?", isPair);
    share("car", car);
    share("cdr", cdr);
    share("list", list);
    share("peq?", peq);
    share("try", tryc);
    share("for", forLoop);
    share("read-file", readFile);
    share("read-line", readLine);
    share("prompt", prompt);
    share("set-prompt", setPrompt);
    share("number?", isNumber);
    share("parse-number", parseNumber);
    share("+", add);
    share("-", sub);
    share("*", mul);
    share("/", div);
    share("%", mod);
    share(">", gt);
    share("<", lt);
    share(">=", gte);
    share("<=", lte);
    share("string?", isString);
    share("number->string", String);
    share("slen", slen);
    share("sidx", sidx);
    share("char-at", charAt);
    share("subs", subs);
    share("sreplace", sreplace);
    share("make-string-builder", mkStringBuilder);
    share("string-builder?", isStringBuilder);
    share("sbempty?", sbempty);
    share("sbappend", sbappend);
    share("builder->string", builderToString);
    share("cats", cats);
    share("out", out);
    share("clog", log);
    share("now", now);
    share("time?", isTime);
    share("number->time", numberToTime);
    share("time->number", timeToNumber);
    share("time->string", timeToString);
    share("filter", filter);
    share("table?", isTable);
    share("make-name-table", makeNameTable);
    share("table-has-name?", tableHasName);
    share("table-names", tableNames);
    share("table-lookup", tableLookup);
    share("table-define", tableDefine);
    share("table-set!", tableSet);
    share("table-delete!", tableDelete);
    share("cerror", cerror);
    share("error?", isError);
    share("sprint-error", sprintError);
    share("sprint-stack", sprintStack);
    share("exit", exit);
    share("proc-argv", argv);
    share("make-regexp", makeRegexp);
    share("true", true);
    share("false", false);
    share("no-print", noPrint);
    share("vector?", isVector);
    share("vector", vector);
    share("vlen", vlen);
    share("vref", vref);
    share("list->vector", listToVector);
    share("vector->list", vectorToList);

    // patch
    var extendEnv = function (env, shared) {
        var current = {
            parent: env,
            shared: shared || makeNameTable()
        };
        return function () {
            if (arguments.length === 1) {
                if (tableHasName(current.shared, [arguments[0]])) {
                    return tableLookup(current.shared, [arguments[0]]);
                }
                if (!current.parent) {
                    return cerror("extend-env", "unbound variable", arguments[0]);
                }
                return current.parent(arguments[0]);
            }
            if (arguments[1]) {
                return tableDefine(current.shared, [arguments[0]], arguments[2]);
            }
            if (tableHasName(current.shared, [arguments[0]])) {
                return tableSet(current.shared, [arguments[0]], arguments[2]);
            }
            if (!current.parent) {
                return cerror("extend-env", "unbound variable", arguments[0]);
            }
            return current.parent(arguments[0], false, arguments[2]);
        };
    };
    var isDefined = function (env, name) {
        try {
            env(name);
            return true;
        } catch (_) {
            return false;
        }
    };
    var lang = extendEnv(null, head);
    share("extend-env", extendEnv);
    share("defined?", isDefined);
    share("lang", lang);
    return lang;
})();
env("eval",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("eval-env"))(env("lang"),env("exp"));};})(env));env("apply",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("proc",true,arguments[0]);env("args",true,arguments[1]);return (false!==((env("compiled-procedure?"))(env("proc")))?(env("capply"))(env("proc"),env("args")):(false!==((env("compound-procedure?"))(env("proc")))?(env("eval-sequence"))((env("extend-procedure-environment"))((env("procedure-environment"))(env("proc")),(env("procedure-parameters"))(env("proc")),env("args")),(env("procedure-body"))(env("proc"))):(env("error"))(["apply"],"unknown procedure type",env("proc"))));};})(env));env("log",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("clog"))((env("sprint"))(env("exp")));};})(env));env("print",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);return (env("out"))((env("sprint"))(env("s")));};})(env));env("eq?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("peq?"))(env("left"),env("right")));};})(env))((env("quote-eq?"))(env("left"),env("right"))));};})(env))((env("symbol-eq?"))(env("left"),env("right"))));};})(env))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("null?"))(env("right")):env("predicate"));};})(env))((env("null?"))(env("left"))));};})(env));env("newline",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("out"))("\n");};})(env));env("error",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("where",true,arguments[0]);env("what",true,arguments[1]);env("arg",true,arguments[2]);return (env("cerror"))((env("sprint-quoted"))(env("where")),env("what"),(env("sprint"))(env("arg")));};})(env));env("not",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("peq?"))(env("exp"),env("false")))?env("true"):env("false"));};})(env));env("append",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return (false!==((env("null?"))(env("left")))?env("right"):(env("cons"))((env("car"))(env("left")),(env("append"))((env("cdr"))(env("left")),env("right"))));};})(env));env("sprint",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("sprintq"))(env("exp"),env("false"),env("false"));};})(env));env("reverse",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (false!==((env("null?"))(env("l")))?[]:(env("append"))((env("reverse"))((env("cdr"))(env("l"))),(env("list"))((env("car"))(env("l")))));};})(env));env("display",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);return (env("out"))((env("sunescape"))((env("sprint"))(env("s"))));};})(env));env("sescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);env("sescapes",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("ss",true,arguments[0]);env("ps",true,arguments[1]);return (false!==((env("peq?"))((env("slen"))(env("ss")),0))?env("ps"):(env("sescapes"))((env("subs"))(env("ss"),1,-1),(env("cats"))(env("ps"),(env("sescape-char"))((env("subs"))(env("ss"),0,1)))));};})(env));return (env("sescapes"))(env("s"),"");};})(env));env("caar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))(env("l")));};})(env));env("cadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))(env("l")));};})(env));env("cdar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))(env("l")));};})(env));env("cddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))(env("l")));};})(env));env("caaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))(env("l"))));};})(env));env("caadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))(env("l"))));};})(env));env("cadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))(env("l"))));};})(env));env("cdaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))(env("l"))));};})(env));env("caddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))(env("l"))));};})(env));env("cdadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))(env("l"))));};})(env));env("cddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))(env("l"))));};})(env));env("cdddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))(env("l"))));};})(env));env("caaaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))((env("car"))(env("l")))));};})(env));env("caaadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("caadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cadaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))((env("car"))(env("l")))));};})(env));env("cdaaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))((env("car"))(env("l")))));};})(env));env("caaddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cadadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("cdaadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("caddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cdadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cddaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))((env("car"))(env("l")))));};})(env));env("cadddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cdaddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cddadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("cdddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cddddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("shared-precompiled",true,[]);env("shared-precompiled",false,(env("cons"))([["define"],[[["cddddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdddar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cddadr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdaddr"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cadddr"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cddaar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdadar"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caddar"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdaadr"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cadadr"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caaddr"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdaaar"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cadaar"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caadar"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caaadr"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caaaar"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cddar"],[["l"],[]]],[[["cdr"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdadr"],[["l"],[]]],[[["cdr"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caddr"],[["l"],[]]],[[["car"],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdaar"],[["l"],[]]],[[["cdr"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cadar"],[["l"],[]]],[[["car"],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caadr"],[["l"],[]]],[[["car"],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caaar"],[["l"],[]]],[[["car"],[[["car"],[[["car"],[["l"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cddr"],[["l"],[]]],[[["cdr"],[[["cdr"],[["l"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cdar"],[["l"],[]]],[[["cdr"],[[["car"],[["l"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["cadr"],[["l"],[]]],[[["car"],[[["cdr"],[["l"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["caar"],[["l"],[]]],[[["car"],[[["car"],[["l"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["sescape"],[["s"],[]]],[[["define"],[[["sescapes"],[["ss"],[["ps"],[]]]],[[["if"],[[["peq?"],[[["slen"],[["ss"],[]]],[0,[]]]],[["ps"],[[["sescapes"],[[["subs"],[["ss"],[1,[-1,[]]]]],[[["cats"],[["ps"],[[["sescape-char"],[[["subs"],[["ss"],[0,[1,[]]]]],[]]],[]]]],[]]]],[]]]]],[]]]],[[["sescapes"],[["s"],["",[]]]],[]]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["display"],[["s"],[]]],[[["out"],[[["sunescape"],[[["sprint"],[["s"],[]]],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["reverse"],[["l"],[]]],[[["if"],[[["null?"],[["l"],[]]],[[["quote"],[[],[]]],[[["append"],[[["reverse"],[[["cdr"],[["l"],[]]],[]]],[[["list"],[[["car"],[["l"],[]]],[]]],[]]]],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["sprint"],[["exp"],[]]],[[["sprintq"],[["exp"],[["false"],[["false"],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["append"],[["left"],[["right"],[]]]],[[["if"],[[["null?"],[["left"],[]]],[["right"],[[["cons"],[[["car"],[["left"],[]]],[[["append"],[[["cdr"],[["left"],[]]],[["right"],[]]]],[]]]],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["not"],[["exp"],[]]],[[["if"],[[["peq?"],[["exp"],[["false"],[]]]],[["true"],[["false"],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["error"],[["where"],[["what"],[["arg"],[]]]]],[[["cerror"],[[["sprint-quoted"],[["where"],[]]],[["what"],[[["sprint"],[["arg"],[]]],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["newline"],[]],[[["out"],["\n",[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["eq?"],[["left"],[["right"],[]]]],[[["or"],[[["and"],[[["null?"],[["left"],[]]],[[["null?"],[["right"],[]]],[]]]],[[["symbol-eq?"],[["left"],[["right"],[]]]],[[["quote-eq?"],[["left"],[["right"],[]]]],[[["peq?"],[["left"],[["right"],[]]]],[]]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["print"],[["s"],[]]],[[["out"],[[["sprint"],[["s"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["log"],[["exp"],[]]],[[["clog"],[[["sprint"],[["exp"],[]]],[]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["apply"],[["proc"],[["args"],[]]]],[[["cond"],[[[["compiled-procedure?"],[["proc"],[]]],[[["capply"],[["proc"],[["args"],[]]]],[]]],[[[["compound-procedure?"],[["proc"],[]]],[[["eval-sequence"],[[["extend-procedure-environment"],[[["procedure-environment"],[["proc"],[]]],[[["procedure-parameters"],[["proc"],[]]],[["args"],[]]]]],[[["procedure-body"],[["proc"],[]]],[]]]],[]]],[[["else"],[[["error"],[[["quote"],[["apply"],[]]],["unknown procedure type",[["proc"],[]]]]],[]]],[]]]]],[]]]],env("shared-precompiled")));env("shared-precompiled",false,(env("cons"))([["define"],[[["eval"],[["exp"],[]]],[[["eval-env"],[["lang"],[["exp"],[]]]],[]]]],env("shared-precompiled")));env("error",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("where",true,arguments[0]);env("what",true,arguments[1]);env("arg",true,arguments[2]);return (env("cerror"))((env("sprint-quoted"))(env("where")),env("what"),(env("sprint"))(env("arg")));};})(env));env("symbol-eq?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("peq?"))((env("symbol-name"))(env("left")),(env("symbol-name"))(env("right"))):env("predicate"));};})(env))((env("symbol?"))(env("right"))):env("predicate"));};})(env))((env("symbol?"))(env("left")));};})(env));env("print",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);return (env("out"))((env("sprint"))(env("s")));};})(env));env("log",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("clog"))((env("sprint"))(env("exp")));};})(env));env("newline",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("out"))("\n");};})(env));env("print-stack",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("error",true,arguments[0]);(env("out"))((env("sprint-stack"))(env("error")));return (env("newline"))();};})(env));env("display",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);return (env("out"))((env("sunescape"))((env("sprint"))(env("s"))));};})(env));env("self-evaluating?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("string?"))(env("exp")));};})(env))((env("number?"))(env("exp"))));};})(env))((env("peq?"))(env("exp"),env("no-print"))));};})(env))((env("peq?"))(env("exp"),env("false"))));};})(env))((env("peq?"))(env("exp"),env("true")));};})(env));env("quote-text",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("q",true,arguments[0]);return (env("cadr"))(env("q"));};})(env));env("quote-eq?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("eq?"))((env("quote-text"))(env("left")),(env("quote-text"))(env("right"))));};})(env))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("null?"))((env("cdr"))(env("right"))):env("predicate"));};})(env))((env("null?"))((env("cdr"))(env("left"))))):env("predicate"));};})(env))((env("quote?"))(env("right"))):env("predicate"));};})(env))((env("quote?"))(env("left")));};})(env));env("eq?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("peq?"))(env("left"),env("right")));};})(env))((env("quote-eq?"))(env("left"),env("right"))));};})(env))((env("symbol-eq?"))(env("left"),env("right"))));};})(env))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("null?"))(env("right")):env("predicate"));};})(env))((env("null?"))(env("left"))));};})(env));env("not",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("peq?"))(env("exp"),env("false")))?env("true"):env("false"));};})(env));env("sescape-char",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("char",true,arguments[0]);return (false!==((env("peq?"))(env("char"),"\b"))?"\\b":(false!==((env("peq?"))(env("char"),"\t"))?"\\t":(false!==((env("peq?"))(env("char"),"\n"))?"\\n":(false!==((env("peq?"))(env("char"),"\v"))?"\\v":(false!==((env("peq?"))(env("char"),"\f"))?"\\f":(false!==((env("peq?"))(env("char"),"\r"))?"\\r":(false!==((env("peq?"))(env("char"),"\""))?"\\\"":(false!==((env("peq?"))(env("char"),"\\"))?"\\\\":env("char")))))))));};})(env));env("escape-char?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("char",true,arguments[0]);return (env("not"))((env("peq?"))((env("sescape-char"))(env("char")),env("char")));};})(env));env("sescaped-char",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("char-symbol",true,arguments[0]);return (false!==((env("peq?"))(env("char-symbol"),"b"))?"\b":(false!==((env("peq?"))(env("char-symbol"),"t"))?"\t":(false!==((env("peq?"))(env("char-symbol"),"n"))?"\n":(false!==((env("peq?"))(env("char-symbol"),"v"))?"\v":(false!==((env("peq?"))(env("char-symbol"),"f"))?"\f":(false!==((env("peq?"))(env("char-symbol"),"r"))?"\r":env("char-symbol")))))));};})(env));env("sescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);env("sescapes",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("ss",true,arguments[0]);env("ps",true,arguments[1]);return (false!==((env("peq?"))((env("slen"))(env("ss")),0))?env("ps"):(env("sescapes"))((env("subs"))(env("ss"),1,-1),(env("cats"))(env("ps"),(env("sescape-char"))((env("subs"))(env("ss"),0,1)))));};})(env));return (env("sescapes"))(env("s"),"");};})(env));env("sescape-symbol-name",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("sn",true,arguments[0]);env("find-escape-char",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ss",true,arguments[0]);return (false!==((env("peq?"))((env("slen"))(env("ss")),0))?env("sn"):(false!==((env("escape-char?"))((env("subs"))(env("ss"),0,1)))?(env("cats"))("|",env("sn"),"|"):(env("find-escape-char"))((env("subs"))(env("ss"),1,-1))));};})(env));return (env("find-escape-char"))(env("sn"));};})(env));env("sunescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("s",true,arguments[0]);env("sunescapes",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("ss",true,arguments[0]);env("ps",true,arguments[1]);env("escaped",true,arguments[2]);return (false!==((env("peq?"))((env("slen"))(env("ss")),0))?(false!==(env("escaped"))?(env("error"))(["sunescape"],"invalid escape sequence",env("s")):env("ps")):(false!==(env("escaped"))?(env("sunescapes"))((env("subs"))(env("ss"),1,-1),(env("cats"))(env("ps"),(env("sescaped-char"))((env("subs"))(env("ss"),0,1))),env("false")):(false!==((env("peq?"))((env("subs"))(env("ss"),0,1),"\\"))?(env("sunescapes"))((env("subs"))(env("ss"),1,-1),env("ps"),env("true")):(env("sunescapes"))((env("subs"))(env("ss"),1,-1),(env("cats"))(env("ps"),(env("subs"))(env("ss"),0,1)),env("false")))));};})(env));return (env("sunescapes"))(env("s"),"",env("false"));};})(env));env("sprintq-vector",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("vector",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("builder",true,arguments[0]);env("builder",false,(env("sbappend"))(env("builder"),"#("));((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("ref",true,arguments[0]);env("in-list?",true,arguments[1]);return (env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (false!==((env("eq?"))(env("ref"),(env("vlen"))(env("vector"))))?env("true"):(function(){(false!==((env(">"))(env("ref"),0))?env("builder",false,(env("sbappend"))(env("builder")," ")):env("true"));env("builder",false,(env("sbappend"))(env("builder"),(env("sprintq"))((env("vref"))(env("vector"),env("ref")),env("true"),env("false"))));env("in-list?",false,env("true"));env("ref",false,(env("+"))(env("ref"),1));return env("false");})());};})(env));};})(env))(0,env("false"));env("builder",false,(env("sbappend"))(env("builder"),")"));return (env("builder->string"))(env("builder"));};})(env))((env("make-string-builder"))());};})(env));env("sprintq",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("exp",true,arguments[0]);env("quoted?",true,arguments[1]);env("in-list?",true,arguments[2]);return (false!==((env("peq?"))(env("exp"),env("false")))?"false":(false!==((env("peq?"))(env("exp"),env("true")))?"true":(false!==((env("peq?"))(env("exp"),env("no-print")))?"":(false!==((env("number?"))(env("exp")))?(env("number->string"))(env("exp")):(false!==((env("string?"))(env("exp")))?(env("cats"))("\"",(env("sescape"))(env("exp")),"\""):(false!==((env("symbol?"))(env("exp")))?(false!==(env("quoted?"))?(env("sescape-symbol-name"))((env("symbol-name"))(env("exp"))):(env("cats"))("'",(env("sescape-symbol-name"))((env("symbol-name"))(env("exp"))))):(false!==((env("null?"))(env("exp")))?(false!==(env("quoted?"))?"()":"'()"):(false!==((env("quote?"))(env("exp")))?((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("text",true,arguments[0]);return (env("cats"))("'",(env("sprintq"))(env("text"),env("true"),env("false")));};})(env))((env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("quote-text"))(env("exp"));};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);return "???";};})(env))):(false!==((env("vector?"))(env("exp")))?(env("sprintq-vector"))(env("exp")):(false!==((env("pair?"))(env("exp")))?(env("cats"))((false!==((env("not"))(env("quoted?")))?"'(":(false!==((env("not"))(env("in-list?")))?"(":"")),(false!==(env("in-list?"))?" ":""),(env("sprintq"))((env("car"))(env("exp")),env("true"),env("false")),(false!==((env("null?"))((env("cdr"))(env("exp"))))?")":(false!==((env("pair?"))((env("cdr"))(env("exp"))))?(env("sprintq"))((env("cdr"))(env("exp")),env("true"),env("true")):(env("cats"))(" . ",(env("sprintq"))((env("cdr"))(env("exp")),env("true"),env("true")),")")))):(false!==((env("table?"))(env("exp")))?"[table]":(false!==((env("error?"))(env("exp")))?(env("sprint-error"))(env("exp")):"unknown type"))))))))))));};})(env));env("sprint",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("sprintq"))(env("exp"),env("false"),env("false"));};})(env));env("sprint-quoted",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("sprintq"))(env("exp"),env("true"),env("false"));};})(env));env("tagged-list?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("exp",true,arguments[0]);env("tag",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("eq?"))((env("car"))(env("exp")),env("tag")):env("predicate"));};})(env))((env("pair?"))(env("exp")));};})(env));env("len",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (false!==((env("null?"))(env("l")))?0:(env("+"))(1,(env("len"))((env("cdr"))(env("l")))));};})(env));env("append",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return (false!==((env("null?"))(env("left")))?env("right"):(env("cons"))((env("car"))(env("left")),(env("append"))((env("cdr"))(env("left")),env("right"))));};})(env));env("reverse",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (false!==((env("null?"))(env("l")))?[]:(env("append"))((env("reverse"))((env("cdr"))(env("l"))),(env("list"))((env("car"))(env("l")))));};})(env));env("map",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("p",true,arguments[0]);env("l",true,arguments[1]);return (false!==((env("null?"))(env("l")))?[]:(env("cons"))((env("p"))((env("car"))(env("l"))),(env("map"))(env("p"),(env("cdr"))(env("l")))));};})(env));env("deep-reverse",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("map"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("i",true,arguments[0]);return (false!==((env("pair?"))(env("i")))?(env("deep-reverse"))(env("i")):env("i"));};})(env),(env("reverse"))(env("l")));};})(env));env("copy-table-filtered",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("from",true,arguments[0]);env("to",true,arguments[1]);env("f",true,arguments[2]);env("iterate",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("names",true,arguments[0]);env("copied-names",true,arguments[1]);return (false!==((env("null?"))(env("names")))?env("copied-names"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);(false!==((env("f"))(env("name")))?(function(){(env("table-define"))(env("to"),env("name"),(env("table-lookup"))(env("from"),env("name")));return env("copied-names",false,(env("cons"))(env("name"),env("copied-names")));})():env("true"));return (env("iterate"))((env("cdr"))(env("names")),env("copied-names"));};})(env))((env("car"))(env("names"))));};})(env));return (env("iterate"))((env("table-names"))(env("from")),[]);};})(env));env("to-table",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("l",true,arguments[0]);env("map-name",true,arguments[1]);env("map-value",true,arguments[2]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("table",true,arguments[0]);(env("map"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("i",true,arguments[0]);return (env("table-define"))(env("table"),(env("map-name"))(env("i")),(env("map-value"))(env("i")));};})(env),env("l"));return env("table");};})(env))((env("make-name-table"))());};})(env));env("quote?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["quote"]);};})(env));env("check-quote",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("not"))((env("peq?"))((env("len"))(env("exp")),2)));};})(env))((env("not"))((env("tagged-list?"))(env("exp"),["quote"]))))?(env("error"))(["check-quote"],"invalid quotation",["???"]):env("true"));};})(env));env("assignment-variable",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadr"))(env("exp"));};})(env));env("assignment?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["set!"]);};})(env));env("check-assignment",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("not"))((env("peq?"))((env("len"))(env("exp")),3)))?(env("error"))(["check-assignment"],"invalid arity",env("exp")):(false!==((env("not"))((env("symbol?"))((env("assignment-variable"))(env("exp")))))?(env("error"))(["check-assignment"],"invalid variable name",env("exp")):env("true")));};})(env));env("assignment-variable",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadr"))(env("exp"));};})(env));env("assignment-value",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("caddr"))(env("exp"));};})(env));env("eval-assignment",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("exp",true,arguments[1]);return (env("env"))((env("assignment-variable"))(env("exp")),env("false"),(env("eval-env"))(env("env"),(env("assignment-value"))(env("exp"))));};})(env));env("definition?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["define"]);};})(env));env("definition-variable",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("symbol?"))((env("cadr"))(env("exp"))))?(env("cadr"))(env("exp")):(env("caadr"))(env("exp")));};})(env));env("definition-value",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("symbol?"))((env("cadr"))(env("exp"))))?(env("caddr"))(env("exp")):(env("make-lambda"))((env("cdadr"))(env("exp")),(env("cddr"))(env("exp"))));};})(env));env("check-definition",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("not"))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env(">"))((env("len"))(env("exp")),2):env("predicate"));};})(env))((env("pair?"))((env("cadr"))(env("exp")))));};})(env))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("peq?"))((env("len"))(env("exp")),3):env("predicate"));};})(env))((env("symbol?"))((env("cadr"))(env("exp")))))))?(env("error"))(["check-definition"],"invalid format",env("exp")):(false!==((env("not"))((env("symbol?"))((env("definition-variable"))(env("exp")))))?(env("error"))(["check-definition"],"invalid variable name",env("exp")):env("true")));};})(env));env("eval-definition",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("exp",true,arguments[1]);return (env("env"))((env("definition-variable"))(env("exp")),env("true"),(env("eval-env"))(env("env"),(env("definition-value"))(env("exp"))));};})(env));env("if?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["if"]);};})(env));env("check-if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("not"))((env("peq?"))((env("len"))(env("exp")),4)))?(env("error"))(["check-if"],"invalid arity",env("exp")):env("true"));};})(env));env("if-predicate",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadr"))(env("exp"));};})(env));env("if-consequent",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("caddr"))(env("exp"));};})(env));env("if-alternative",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadddr"))(env("exp"));};})(env));env("true?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("not"))((env("peq?"))(env("exp"),env("false")));};})(env));env("eval-if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("exp",true,arguments[1]);return (false!==((env("true?"))((env("eval-env"))(env("env"),(env("if-predicate"))(env("exp")))))?(env("eval-env"))(env("env"),(env("if-consequent"))(env("exp"))):(env("eval-env"))(env("env"),(env("if-alternative"))(env("exp"))));};})(env));env("make-if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("predicate",true,arguments[0]);env("consequent",true,arguments[1]);env("alternative",true,arguments[2]);return (env("list"))(["if"],env("predicate"),env("consequent"),env("alternative"));};})(env));env("make-lambda",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("parameters",true,arguments[0]);env("body",true,arguments[1]);return (env("cons"))(["lambda"],(env("cons"))(env("parameters"),env("body")));};})(env));env("lambda?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["lambda"]);};})(env));env("check-lambda",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("<"))((env("len"))(env("exp")),3))?(env("error"))(["check-lambda"],"invalid arity",env("exp")):(false!==(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("not"))((env("pair?"))((env("cadr"))(env("exp")))):env("predicate"));};})(env))((env("not"))((env("null?"))((env("cadr"))(env("exp"))))))?(env("error"))(["check-lambda"],"invalid argument list",env("exp")):env("true")));};})(env));env("lambda-parameters",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadr"))(env("exp"));};})(env));env("lambda-body",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cddr"))(env("exp"));};})(env));env("make-procedure",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("parameters",true,arguments[0]);env("body",true,arguments[1]);env("env",true,arguments[2]);return (env("list"))(["compound"],env("parameters"),env("body"),env("env"));};})(env));env("begin?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["begin"]);};})(env));env("check-begin",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("<"))((env("len"))(env("exp")),2))?(env("error"))(["check-begin"],"invalid arity",env("exp")):env("true"));};})(env));env("begin-actions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cdr"))(env("exp"));};})(env));env("eval-sequence",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("seq",true,arguments[1]);return (false!==((env("null?"))(env("seq")))?(env("error"))(["eval-sequence"],"unspecified sequence",env("seq")):(false!==((env("null?"))((env("cdr"))(env("seq"))))?(env("eval-env"))(env("env"),(env("car"))(env("seq"))):(function(){(env("eval-env"))(env("env"),(env("car"))(env("seq")));return (env("eval-sequence"))(env("env"),(env("cdr"))(env("seq")));})()));};})(env));env("make-begin",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("seq",true,arguments[0]);return (env("cons"))(["begin"],env("seq"));};})(env));env("sequence->exp",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("seq",true,arguments[0]);return (false!==((env("null?"))(env("seq")))?[]:(false!==((env("null?"))((env("cdr"))(env("seq"))))?(env("car"))(env("seq")):(env("make-begin"))(env("seq"))));};})(env));env("cond?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["cond"]);};})(env));env("cond-clauses",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cdr"))(env("exp"));};})(env));env("cond-else-clause?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("clause",true,arguments[0]);return (env("eq?"))((env("cond-predicate"))(env("clause")),["else"]);};})(env));env("cond-actions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("clause",true,arguments[0]);return (env("cdr"))(env("clause"));};})(env));env("cond-predicate",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("clause",true,arguments[0]);return (env("car"))(env("clause"));};})(env));env("expand-clauses",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("clauses",true,arguments[0]);return (false!==((env("null?"))(env("clauses")))?["true"]:((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("first",true,arguments[0]);env("the-rest",true,arguments[1]);return (false!==((env("not"))((env("pair?"))(env("first"))))?(env("error"))(["expand-clauses"],"invalid syntax",env("first")):(false!==((env("cond-else-clause?"))(env("first")))?(false!==((env("null?"))(env("the-rest")))?(env("sequence->exp"))((env("cond-actions"))(env("first"))):(env("error"))(["expand-clauses"],"else clause isn't last",env("clauses"))):(env("make-if"))((env("cond-predicate"))(env("first")),(env("sequence->exp"))((env("cond-actions"))(env("first"))),(env("expand-clauses"))(env("the-rest")))));};})(env))((env("car"))(env("clauses")),(env("cdr"))(env("clauses"))));};})(env));env("cond->if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("expand-clauses"))((env("cond-clauses"))(env("exp")));};})(env));env("and?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["and"]);};})(env));env("and-expressions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cdr"))(env("exp"));};})(env));env("expand-and",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exps",true,arguments[0]);return (false!==((env("null?"))(env("exps")))?["true"]:((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("first",true,arguments[0]);env("the-rest",true,arguments[1]);return (false!==((env("null?"))(env("the-rest")))?env("first"):(env("list"))((env("list"))(["lambda"],[["predicate"],[]],(env("list"))(["if"],["predicate"],(env("expand-and"))(env("the-rest")),["predicate"])),env("first")));};})(env))((env("car"))(env("exps")),(env("cdr"))(env("exps"))));};})(env));env("and->if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("expand-and"))((env("and-expressions"))(env("exp")));};})(env));env("or?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["or"]);};})(env));env("or-expressions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cdr"))(env("exp"));};})(env));env("expand-or",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exps",true,arguments[0]);return (false!==((env("null?"))(env("exps")))?["false"]:((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("first",true,arguments[0]);env("the-rest",true,arguments[1]);return (false!==((env("null?"))(env("the-rest")))?env("first"):(env("list"))((env("list"))(["lambda"],[["predicate"],[]],(env("list"))(["if"],["predicate"],["predicate"],(env("expand-or"))(env("the-rest")))),env("first")));};})(env))((env("car"))(env("exps")),(env("cdr"))(env("exps"))));};})(env));env("or->if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("expand-or"))((env("or-expressions"))(env("exp")));};})(env));env("let?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("tagged-list?"))(env("exp"),["let"]);};})(env));env("check-let",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (false!==((env("<"))((env("len"))(env("exp")),3))?(env("error"))(["check-let"],"invalid arity",env("exp")):(false!==((env("not"))((env("pair?"))((env("cadr"))(env("exp")))))?(env("error"))(["check-let"],"invalid syntax",env("exp")):env("true")));};})(env));env("let-defs",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cadr"))(env("exp"));};})(env));env("let-variables",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("defs",true,arguments[0]);return (env("map"))(env("car"),env("defs"));};})(env));env("let-values",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("defs",true,arguments[0]);return (env("map"))(env("cadr"),env("defs"));};})(env));env("let-body",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cddr"))(env("exp"));};})(env));env("let->procedure",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cons"))((env("make-lambda"))((env("let-variables"))((env("let-defs"))(env("exp"))),(env("let-body"))(env("exp"))),(env("let-values"))((env("let-defs"))(env("exp"))));};})(env));env("application?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("pair?"))(env("exp"));};})(env));env("operator",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("car"))(env("exp"));};})(env));env("operands",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("cdr"))(env("exp"));};})(env));env("no-operands?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ops",true,arguments[0]);return (env("null?"))(env("ops"));};})(env));env("first-operand",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ops",true,arguments[0]);return (env("car"))(env("ops"));};})(env));env("rest-operands",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ops",true,arguments[0]);return (env("cdr"))(env("ops"));};})(env));env("compound-procedure?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("p",true,arguments[0]);return (env("tagged-list?"))(env("p"),["compound"]);};})(env));env("procedure-parameters",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("p",true,arguments[0]);return (env("cadr"))(env("p"));};})(env));env("procedure-body",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("p",true,arguments[0]);return (env("caddr"))(env("p"));};})(env));env("procedure-environment",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("p",true,arguments[0]);return (env("cadddr"))(env("p"));};})(env));env("list-of-values",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("exps",true,arguments[1]);return (false!==((env("no-operands?"))(env("exps")))?[]:(env("cons"))((env("eval-env"))(env("env"),(env("first-operand"))(env("exps"))),(env("list-of-values"))(env("env"),(env("rest-operands"))(env("exps")))));};})(env));env("extend-procedure-environment",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("env",true,arguments[0]);env("names",true,arguments[1]);env("values",true,arguments[2]);env("define-args",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("env",true,arguments[0]);env("names",true,arguments[1]);env("values",true,arguments[2]);return (false!==((env("null?"))(env("names")))?(false!==((env("not"))((env("null?"))(env("values"))))?(env("error"))(["procedure-environment"],"too many values",(env("list"))(env("names"),env("values"))):env("true")):(false!==((env("null?"))(env("values")))?(env("error"))(["procedure-environment"],"too many names",(env("list"))(env("names"),env("values"))):(function(){(env("env"))((env("car"))(env("names")),env("true"),(env("car"))(env("values")));return (env("define-args"))(env("env"),(env("cdr"))(env("names")),(env("cdr"))(env("values")));})()));};})(env));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("env",true,arguments[0]);(env("define-args"))(env("env"),env("names"),env("values"));return env("env");};})(env))((env("extend-env"))(env("env")));};})(env));env("apply",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("proc",true,arguments[0]);env("args",true,arguments[1]);return (false!==((env("compiled-procedure?"))(env("proc")))?(env("capply"))(env("proc"),env("args")):(false!==((env("compound-procedure?"))(env("proc")))?(env("eval-sequence"))((env("extend-procedure-environment"))((env("procedure-environment"))(env("proc")),(env("procedure-parameters"))(env("proc")),env("args")),(env("procedure-body"))(env("proc"))):(env("error"))(["apply"],"unknown procedure type",env("proc"))));};})(env));env("eval-env",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("env",true,arguments[0]);env("exp",true,arguments[1]);return (false!==((env("self-evaluating?"))(env("exp")))?env("exp"):(false!==((env("symbol?"))(env("exp")))?(env("env"))(env("exp")):(false!==((env("vector?"))(env("exp")))?env("exp"):(false!==((env("quote?"))(env("exp")))?(function(){(env("check-quote"))(env("exp"));return (env("quote-text"))(env("exp"));})():(false!==((env("assignment?"))(env("exp")))?(function(){(env("check-assignment"))(env("exp"));return (env("eval-assignment"))(env("env"),env("exp"));})():(false!==((env("definition?"))(env("exp")))?(function(){(env("check-definition"))(env("exp"));return (env("eval-definition"))(env("env"),env("exp"));})():(false!==((env("if?"))(env("exp")))?(function(){(env("check-if"))(env("exp"));return (env("eval-if"))(env("env"),env("exp"));})():(false!==((env("lambda?"))(env("exp")))?(function(){(env("check-lambda"))(env("exp"));return (env("make-procedure"))((env("lambda-parameters"))(env("exp")),(env("lambda-body"))(env("exp")),env("env"));})():(false!==((env("begin?"))(env("exp")))?(function(){(env("check-begin"))(env("exp"));return (env("eval-sequence"))(env("env"),(env("begin-actions"))(env("exp")));})():(false!==((env("cond?"))(env("exp")))?(env("eval-env"))(env("env"),(env("cond->if"))(env("exp"))):(false!==((env("and?"))(env("exp")))?(env("eval-env"))(env("env"),(env("and->if"))(env("exp"))):(false!==((env("or?"))(env("exp")))?(env("eval-env"))(env("env"),(env("or->if"))(env("exp"))):(false!==((env("let?"))(env("exp")))?(function(){(env("check-let"))(env("exp"));return (env("eval-env"))(env("env"),(env("let->procedure"))(env("exp")));})():(false!==((env("application?"))(env("exp")))?(env("apply"))((env("eval-env"))(env("env"),(env("operator"))(env("exp"))),(env("list-of-values"))(env("env"),(env("operands"))(env("exp")))):(env("error"))(["eval-env"],"unknown expression type",env("exp"))))))))))))))));};})(env));env("eval",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("eval-env"))(env("lang"),env("exp"));};})(env));env("compile-pair",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("p",true,arguments[1]);(env("compile-write"))(env("context"),"[");(env("compile-literal"))(env("context"),(env("car"))(env("p")));(env("compile-write"))(env("context"),",");(env("compile-literal"))(env("context"),(env("cdr"))(env("p")));return (env("compile-write"))(env("context"),"]");};})(env));env("compile-vector",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("v",true,arguments[1]);(env("compile-write"))(env("context"),"{vector:[");((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ref",true,arguments[0]);return (env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (false!==((env("eq?"))(env("ref"),(env("vlen"))(env("v"))))?env("true"):(function(){(false!==((env(">"))(env("ref"),0))?(env("compile-write"))(env("context"),","):env("true"));(env("compile-exp"))(env("context"),(env("vref"))(env("v"),env("ref")));env("ref",false,(env("+"))(env("ref"),1));return env("false");})());};})(env));};})(env))(0);return (env("compile-write"))(env("context"),"]}");};})(env));env("compile-literal",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);return (false!==((env("self-evaluating?"))(env("exp")))?(env("compile-write"))(env("context"),(env("sprint"))(env("exp"))):(false!==((env("symbol?"))(env("exp")))?(env("compile-write"))(env("context"),(env("cats"))("[",(env("sprint"))((env("symbol-name"))(env("exp"))),"]")):(false!==((env("null?"))(env("exp")))?(env("compile-write"))(env("context"),"[]"):(false!==((env("pair?"))(env("exp")))?(env("compile-pair"))(env("context"),env("exp")):(false!==((env("vector?"))(env("exp")))?(env("compile-vector"))(env("context"),env("exp")):(env("error"))(["compile-literal"],"unknown type",env("exp")))))));};})(env));env("compile-variable",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);(env("compile-write"))(env("context"),"env(");(env("compile-write"))(env("context"),(env("sprint"))((env("symbol-name"))(env("exp"))));(env("compile-write"))(env("context"),")");return (env("add-compile-dependency"))(env("context"),env("exp"));};})(env));env("compile-assignment",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);(env("compile-write"))(env("context"),"env(");(env("compile-write"))(env("context"),(env("sprint"))((env("symbol-name"))((env("assignment-variable"))(env("exp")))));(env("compile-write"))(env("context"),",false,");(env("compile-exp"))(env("context"),(env("assignment-value"))(env("exp")));return (env("compile-write"))(env("context"),")");};})(env));env("compile-definition",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);(env("add-compile-definition"))(env("context"),(env("definition-variable"))(env("exp")),env("exp"));(env("push-compile-scope"))(env("context"),(env("definition-variable"))(env("exp")));(env("compile-write"))(env("context"),"env(");(env("compile-write"))(env("context"),(env("sprint"))((env("symbol-name"))((env("definition-variable"))(env("exp")))));(env("compile-write"))(env("context"),",true,");(env("compile-exp"))(env("context"),(env("definition-value"))(env("exp")));(env("compile-write"))(env("context"),")");return (env("pop-compile-scope"))(env("context"));};})(env));env("compile-if",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);(env("compile-write"))(env("context"),"(false!==(");(env("compile-exp"))(env("context"),(env("if-predicate"))(env("exp")));(env("compile-write"))(env("context"),")?");(env("compile-exp"))(env("context"),(env("if-consequent"))(env("exp")));(env("compile-write"))(env("context"),":");(env("compile-exp"))(env("context"),(env("if-alternative"))(env("exp")));return (env("compile-write"))(env("context"),")");};})(env));env("compile-sequence",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("seq",true,arguments[1]);return (false!==((env("null?"))(env("seq")))?(env("error"))(["compile-sequence"],"unspecified sequence",env("seq")):(false!==((env("null?"))((env("cdr"))(env("seq"))))?(function(){(env("compile-write"))(env("context"),"return ");return (env("compile-statement"))(env("context"),(env("car"))(env("seq")));})():(function(){(env("compile-statement"))(env("context"),(env("car"))(env("seq")));return (env("compile-sequence"))(env("context"),(env("cdr"))(env("seq")));})()));};})(env));env("compile-procedure",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("context",true,arguments[0]);env("parameters",true,arguments[1]);env("body",true,arguments[2]);env("compile-parameters",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("params",true,arguments[0]);env("params-out",true,arguments[1]);env("count",true,arguments[2]);return (false!==((env("null?"))(env("params")))?(function(){(env("compile-write"))(env("context"),"(arguments.length===");(env("compile-write"))(env("context"),(env("sprint"))(env("count")));(env("compile-write"))(env("context"),")?false:env(\"cerror\")(\"arguments\",\"invalid arity\",");(env("compile-write"))(env("context"),(env("sprint"))(env("count")));(env("compile-write"))(env("context"),");");return (env("compile-write"))(env("context"),(env("builder->string"))(env("params-out")));})():(function(){(env("add-compile-definition"))(env("context"),(env("car"))(env("params")),["argument"]);return (env("compile-parameters"))((env("cdr"))(env("params")),(env("sbappend"))((env("sbappend"))((env("sbappend"))((env("sbappend"))((env("sbappend"))((env("sbappend"))(env("params-out"),"env("),(env("sprint"))((env("symbol-name"))((env("car"))(env("params"))))),",true,"),"arguments["),(env("sprint"))(env("count"))),"]);"),(env("+"))(env("count"),1));})());};})(env));(env("compile-write"))(env("context"),"(function(penv){");(env("compile-write"))(env("context"),"return function(){");(env("compile-write"))(env("context"),"var env=penv(\"extend-env\")(penv);");(env("compile-parameters"))(env("parameters"),(env("make-string-builder"))(),0);(env("compile-sequence"))(env("context"),env("body"));return (env("compile-write"))(env("context"),"};})(env)");};})(env));env("compile-begin",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("actions",true,arguments[1]);(env("compile-write"))(env("context"),"(function(){");(env("compile-sequence"))(env("context"),env("actions"));return (env("compile-write"))(env("context"),"})()");};})(env));env("compile-application",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("context",true,arguments[0]);env("proc",true,arguments[1]);env("args",true,arguments[2]);env("compile-args",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("args",true,arguments[0]);env("first",true,arguments[1]);return (false!==((env("not"))((env("null?"))(env("args"))))?(function(){(false!==((env("not"))(env("first")))?(env("compile-write"))(env("context"),","):env("true"));(env("compile-exp"))(env("context"),(env("car"))(env("args")));return (env("compile-args"))((env("cdr"))(env("args")),env("false"));})():env("true"));};})(env));(env("compile-write"))(env("context"),"(");(env("compile-exp"))(env("context"),env("proc"));(env("compile-write"))(env("context"),")(");(env("compile-args"))(env("args"),env("true"));return (env("compile-write"))(env("context"),")");};})(env));env("compile-exp",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);return (false!==((env("self-evaluating?"))(env("exp")))?(env("compile-literal"))(env("context"),env("exp")):(false!==((env("symbol?"))(env("exp")))?(env("compile-variable"))(env("context"),env("exp")):(false!==((env("vector?"))(env("exp")))?(env("compile-literal"))(env("context"),env("exp")):(false!==((env("quote?"))(env("exp")))?(env("compile-literal"))(env("context"),(env("quote-text"))(env("exp"))):(false!==((env("assignment?"))(env("exp")))?(function(){(env("check-assignment"))(env("exp"));return (env("compile-assignment"))(env("context"),env("exp"));})():(false!==((env("definition?"))(env("exp")))?(function(){(env("check-definition"))(env("exp"));return (env("compile-definition"))(env("context"),env("exp"));})():(false!==((env("if?"))(env("exp")))?(function(){(env("check-if"))(env("exp"));return (env("compile-if"))(env("context"),env("exp"));})():(false!==((env("lambda?"))(env("exp")))?(function(){(env("check-lambda"))(env("exp"));return (env("compile-procedure"))(env("context"),(env("lambda-parameters"))(env("exp")),(env("lambda-body"))(env("exp")));})():(false!==((env("begin?"))(env("exp")))?(function(){(env("check-begin"))(env("exp"));return (env("compile-begin"))(env("context"),(env("begin-actions"))(env("exp")));})():(false!==((env("cond?"))(env("exp")))?(env("compile-exp"))(env("context"),(env("cond->if"))(env("exp"))):(false!==((env("and?"))(env("exp")))?(env("compile-exp"))(env("context"),(env("and->if"))(env("exp"))):(false!==((env("or?"))(env("exp")))?(env("compile-exp"))(env("context"),(env("or->if"))(env("exp"))):(false!==((env("let?"))(env("exp")))?(function(){(env("check-let"))(env("exp"));return (env("compile-exp"))(env("context"),(env("let->procedure"))(env("exp")));})():(false!==((env("application?"))(env("exp")))?(env("compile-application"))(env("context"),(env("operator"))(env("exp")),(env("operands"))(env("exp"))):(env("error"))(["compile-exp"],"invalid expression",env("exp"))))))))))))))));};})(env));env("compile-statement",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("exp",true,arguments[1]);(env("compile-exp"))(env("context"),env("exp"));return (env("compile-write"))(env("context"),";");};})(env));env("make-compile-scope",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scope",true,arguments[0]);(env("table-define"))(env("scope"),["name"],env("name"));(env("table-define"))(env("scope"),["definitions"],(env("make-name-table"))());(env("table-define"))(env("scope"),["dependencies"],(env("make-name-table"))());return env("scope");};})(env))((env("make-name-table"))());};})(env));env("make-name-gen",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("inc",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("base",true,arguments[0]);env("val",true,arguments[1]);return (false!==((env("null?"))(env("val")))?[0,[]]:((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("lowest",true,arguments[0]);return (false!==((env("<"))(env("lowest"),env("base")))?(env("cons"))(env("lowest"),(env("cdr"))(env("val"))):(env("cons"))(0,(env("inc"))(env("base"),(env("cdr"))(env("val")))));};})(env))((env("+"))((env("car"))(env("val")),1)));};})(env));env("print",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("digits",true,arguments[0]);env("val",true,arguments[1]);return (false!==((env("null?"))(env("val")))?(env("make-string-builder"))():(env("sbappend"))((env("print"))(env("digits"),(env("cdr"))(env("val"))),(env("char-at"))(env("digits"),(env("car"))(env("val")))));};})(env));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("digits",true,arguments[0]);env("ref",true,arguments[1]);return (function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("ref",false,(env("inc"))((env("slen"))(env("digits")),env("ref")));return (env("builder->string"))((env("print"))(env("digits"),env("ref")));};})(env);};})(env))("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",[]);};})(env));env("make-name-map",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("name-gen",true,arguments[0]);env("names",true,arguments[1]);return (function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);return (false!==((env("table-has-name?"))(env("names"),env("name")))?(env("table-lookup"))(env("names"),env("name")):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("mapped",true,arguments[0]);(env("table-define"))(env("names"),env("name"),env("mapped"));return env("mapped");};})(env))((env("name-gen"))()));};})(env);};})(env))((env("make-name-gen"))(),(env("make-name-table"))());};})(env));env("make-compile-context",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("names",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);(env("table-define"))(env("context"),["names"],env("names"));(env("table-define"))(env("context"),["expressions"],(env("make-name-table"))());(env("table-define"))(env("context"),["stack"],(env("list"))((env("make-compile-scope"))(["top"])));(env("table-define"))(env("context"),["output"],(env("make-string-builder"))());return env("context");};})(env))((env("make-name-table"))());};})(env));env("context-names",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["names"]);};})(env));env("map-name",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("name",true,arguments[1]);return ((env("context-names"))(env("context")))(env("name"));};})(env));env("scope-name",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scope",true,arguments[0]);return (env("table-lookup"))(env("scope"),["name"]);};})(env));env("compile-expressions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["expressions"]);};})(env));env("compile-stack",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["stack"]);};})(env));env("compile-scope",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("car"))((env("compile-stack"))(env("context")));};})(env));env("scope-dependencies",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scope",true,arguments[0]);return (env("table-lookup"))(env("scope"),["dependencies"]);};})(env));env("compile-dependencies",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("scope-dependencies"))((env("compile-scope"))(env("context")));};})(env));env("scope-definitions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scope",true,arguments[0]);return (env("table-lookup"))(env("scope"),["definitions"]);};})(env));env("compile-definitions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("scope-definitions"))((env("compile-scope"))(env("context")));};})(env));env("add-compile-dependency",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("name",true,arguments[1]);return (env("table-define"))((env("compile-dependencies"))(env("context")),env("name"),env("true"));};})(env));env("add-compile-definition",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===3)?false:env("cerror")("arguments","invalid arity",3);env("context",true,arguments[0]);env("name",true,arguments[1]);env("exp",true,arguments[2]);(false!==((env("eq?"))((env("scope-name"))((env("compile-scope"))(env("context"))),["top"]))?(env("table-define"))((env("compile-expressions"))(env("context")),env("name"),env("exp")):env("true"));return (env("table-define"))((env("compile-definitions"))(env("context")),env("name"),(env("make-name-table"))());};})(env));env("push-compile-scope",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("name",true,arguments[1]);return (env("table-set!"))(env("context"),["stack"],(env("cons"))((env("make-compile-scope"))(env("name")),(env("compile-stack"))(env("context"))));};})(env));env("pop-compile-scope",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("current-scope",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("parent-definition",true,arguments[0]);env("current-definitions",true,arguments[1]);env("undefined?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("dep",true,arguments[0]);return (env("not"))((env("table-has-name?"))(env("current-definitions"),env("dep")));};})(env));env("copy-def-deps",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("def-names",true,arguments[0]);return (false!==((env("not"))((env("null?"))(env("def-names"))))?(function(){(env("copy-table-filtered"))((env("table-lookup"))(env("current-definitions"),(env("car"))(env("def-names"))),env("parent-definition"),env("undefined?"));return (env("copy-def-deps"))((env("cdr"))(env("def-names")));})():env("true"));};})(env));(env("copy-def-deps"))((env("table-names"))(env("current-definitions")));(env("copy-table-filtered"))((env("scope-dependencies"))(env("current-scope")),env("parent-definition"),env("undefined?"));return (env("table-set!"))(env("context"),["stack"],(env("cdr"))((env("compile-stack"))(env("context"))));};})(env))((env("table-lookup"))((env("scope-definitions"))((env("cadr"))((env("compile-stack"))(env("context")))),(env("scope-name"))(env("current-scope"))),(env("scope-definitions"))(env("current-scope")));};})(env))((env("compile-scope"))(env("context")));};})(env));env("compile-buffer",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["output"]);};})(env));env("compile-write",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("s",true,arguments[1]);return (env("table-set!"))(env("context"),["output"],(env("sbappend"))((env("compile-buffer"))(env("context")),env("s")));};})(env));env("precompile-exp",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("list"))(["set!"],["shared-precompiled"],(env("list"))(["cons"],(env("list"))(["quote"],env("exp")),["shared-precompiled"]));};})(env));env("compile-head",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("clb",true,arguments[0]);return (env("read-file"))("mm-head.js",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("data",true,arguments[0]);(env("out"))(env("data"));return (env("clb"))();};})(env));};})(env));env("compile-shared",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);env("iterate",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("shared",true,arguments[1]);return (false!==((env("not"))((env("null?"))(env("shared"))))?(function(){(env("compile-statement"))(env("context"),(env("car"))(env("shared")));return (env("iterate"))(env("context"),(env("cdr"))(env("shared")));})():env("true"));};})(env));return (false!==((env("table-has-name?"))(env("lang"),["shared-precompiled"]))?(env("iterate"))(env("context"),env("shared-precompiled")):env("true"));};})(env));env("tokenizer-expression",true,[";[^\\n]*\\n?|",["\\(|\\)|",["#\\(|",["'|",["\"(\\\\\\\\|\\\\\"|[^\"])*\"?|",["(\\\\.|",["\\|(\\\\\\\\|\\\\\\||[^|])*\\|?|",["[^;()'|\"\\s])+",[]]]]]]]]]);env("tokenizer-rx",true,(env("make-regexp"))((env("apply"))(env("cats"),env("tokenizer-expression")),"g"));env("token-complete-expression",true,["^(;[^\\n]*\\n|",["\\(|",["\\)|",["#\\(|",["'|",["\"(\\\\\"|\\\\[^\"]|[^\\\\\"])*\"|",["(\\\\.|",["\\|(\\\\\\||\\\\[^\\|]|[^\\\\|])*\\||",["[^;()#'|\"\\s\\\\])+)$",[]]]]]]]]]]);env("token-complete-rx",true,(env("make-regexp"))((env("apply"))(env("cats"),env("token-complete-expression")),""));env("make-read-context",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("tokens",true,arguments[1]);(env("table-define"))(env("tokens"),["vectors"],[]);(env("table-define"))(env("tokens"),["ref"],0);(env("table-define"))(env("context"),["tokens"],env("tokens"));(env("table-define"))(env("context"),["stack"],[]);(env("table-define"))(env("context"),["expressions"],[]);return env("context");};})(env))((env("make-name-table"))(),(env("make-name-table"))());};})(env));env("read-tokens",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["tokens"]);};})(env));env("read-tokens-list",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))((env("read-tokens"))(env("context")),["vectors"]);};})(env));env("read-token-ref",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))((env("read-tokens"))(env("context")),["ref"]);};})(env));env("read-stack",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["stack"]);};})(env));env("read-stack-empty?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("null?"))((env("read-stack"))(env("context")));};})(env));env("current-stack-frame",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("car"))((env("read-stack"))(env("context")));};})(env));env("current-read-list-type",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))((env("current-stack-frame"))(env("context")),["type"]);};})(env));env("current-read-list",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))((env("current-stack-frame"))(env("context")),["list"]);};})(env));env("read-expressions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("table-lookup"))(env("context"),["expressions"]);};})(env));env("token-complete?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("token",true,arguments[0]);return (env(">"))((env("vlen"))((env("token-complete-rx"))(env("token"))),0);};})(env));env("unescape-char",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("char-symbol",true,arguments[0]);return (false!==((env("peq?"))(env("char-symbol"),"b"))?"\b":(false!==((env("peq?"))(env("char-symbol"),"t"))?"\t":(false!==((env("peq?"))(env("char-symbol"),"n"))?"\n":(false!==((env("peq?"))(env("char-symbol"),"v"))?"\v":(false!==((env("peq?"))(env("char-symbol"),"f"))?"\f":(false!==((env("peq?"))(env("char-symbol"),"r"))?"\r":env("char-symbol")))))));};})(env));env("unescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("string",true,arguments[0]);env("unescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("builder",true,arguments[0]);env("s",true,arguments[1]);(env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eref",true,arguments[0]);return (false!==((env("<"))(env("eref"),0))?(function(){env("builder",false,(env("sbappend"))(env("builder"),env("s")));return env("true");})():(false!==((env("eq?"))((env("slen"))(env("s")),(env("+"))(env("eref"),1)))?(env("error"))(["unescape"],"invalid escape sequence",env("string")):(function(){env("builder",false,(env("sbappend"))(env("builder"),(env("subs"))(env("s"),0,env("eref"))));env("builder",false,(env("sbappend"))(env("builder"),(env("unescape-char"))((env("char-at"))(env("s"),(env("+"))(env("eref"),1)))));env("s",false,(env("subs"))(env("s"),(env("+"))(env("eref"),2),-1));return env("false");})()));};})(env))((env("sidx"))(env("s"),"\\\\"));};})(env));return (env("builder->string"))(env("builder"));};})(env));return (env("unescape"))((env("make-string-builder"))(),env("string"));};})(env));env("unescape-symbol",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);env("unescape",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("builder",true,arguments[0]);env("s",true,arguments[1]);((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("escaped",true,arguments[0]);return (env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eref",true,arguments[0]);return (false!==((env("<"))(env("eref"),0))?(function(){env("builder",false,(env("sbappend"))(env("builder"),env("s")));return env("true");})():(function(){env("builder",false,(env("sbappend"))(env("builder"),(env("subs"))(env("s"),0,env("eref"))));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("echar",true,arguments[0]);return (false!==((env("peq?"))(env("echar"),"|"))?(function(){env("s",false,(env("subs"))(env("s"),(env("+"))(env("eref"),1),-1));env("escaped",false,(env("not"))(env("escaped")));return env("false");})():(false!==((env("eq?"))((env("slen"))(env("s")),(env("+"))(env("eref"),1)))?(function(){env("builder",false,(env("sbappend"))(env("builder"),"\\"));return env("true");})():(false!==((env("eq?"))((env("char-at"))(env("s"),(env("+"))(env("eref"),1)),"|"))?(function(){env("builder",false,(env("sbappend"))(env("builder"),"|"));env("s",false,(env("subs"))(env("s"),(env("+"))(env("eref"),2),-1));return env("false");})():(false!==(env("escaped"))?(function(){env("builder",false,(env("sbappend"))(env("builder"),(env("subs"))(env("s"),env("eref"),2)));env("s",false,(env("subs"))(env("s"),(env("+"))(env("eref"),2),-1));return env("false");})():(function(){env("builder",false,(env("sbappend"))(env("builder"),(env("char-at"))(env("s"),(env("+"))(env("eref"),1))));env("s",false,(env("subs"))(env("s"),(env("+"))(env("eref"),2),-1));return env("false");})()))));};})(env))((env("char-at"))(env("s"),env("eref")));})());};})(env))((env("sidx"))(env("s"),"\\\\|\\|"));};})(env));};})(env))(env("false"));return (env("builder->string"))(env("builder"));};})(env));return (env("unescape"))((env("make-string-builder"))(),env("name"));};})(env));env("push-list-type",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("type",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("frame",true,arguments[0]);(env("table-define"))(env("frame"),["type"],env("type"));(env("table-define"))(env("frame"),["list"],[]);return (env("table-set!"))(env("context"),["stack"],(env("cons"))(env("frame"),(env("read-stack"))(env("context"))));};})(env))((env("make-name-table"))());};})(env));env("push-list",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("push-list-type"))(env("context"),["list"]);};})(env));env("push-vector",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("push-list-type"))(env("context"),["vector"]);};})(env));env("replace-read-list",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("list",true,arguments[1]);return (env("table-set!"))((env("current-stack-frame"))(env("context")),["list"],env("list"));};})(env));env("cons-read-expression",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("tag",true,arguments[1]);return (env("table-set!"))(env("context"),["expressions"],(env("cons"))(env("tag"),(env("read-expressions"))(env("context"))));};})(env));env("cons-read-tag",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("tag",true,arguments[1]);return ((false!==((env("read-stack-empty?"))(env("context")))?env("cons-read-expression"):env("cons-stack-tag")))(env("context"),env("tag"));};})(env));env("close-current-list",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (false!==((env("read-stack-empty?"))(env("context")))?(env("error"))(["close-current-list"],"unexpected closing paren",env("context")):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("closed",true,arguments[0]);(env("table-set!"))(env("context"),["stack"],(env("cdr"))((env("read-stack"))(env("context"))));return (env("cons-read-tag"))(env("context"),env("closed"));};})(env))((false!==((env("eq?"))((env("current-read-list-type"))(env("context")),["vector"]))?(env("apply"))(env("vector"),(env("reverse"))((env("current-read-list"))(env("context")))):(env("reverse"))((env("current-read-list"))(env("context"))))));};})(env));env("push-quote",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("push-list-type"))(env("context"),["quote"]);};})(env));env("quoted-tag?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return (env("eq?"))((env("current-read-list-type"))(env("context")),["quote"]);};})(env));env("cons-stack-tag",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("tag",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("list",true,arguments[0]);(env("replace-read-list"))(env("context"),env("list"));return (false!==((env("quoted-tag?"))(env("context")))?(env("close-current-list"))(env("context")):env("true"));};})(env))((env("cons"))(env("tag"),(false!==((env("quoted-tag?"))(env("context")))?(env("cons"))(["quote"],(env("current-read-list"))(env("context"))):(env("current-read-list"))(env("context")))));};})(env));env("cons-string",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("token",true,arguments[1]);return (env("cons-read-tag"))(env("context"),(env("unescape"))((env("subs"))(env("token"),1,(env("-"))((env("slen"))(env("token")),2))));};})(env));env("cons-token",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("token",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("number",true,arguments[0]);return (env("cons-read-tag"))(env("context"),(false!==((env("number?"))(env("number")))?env("number"):(env("string->symbol"))((env("unescape-symbol"))(env("token")))));};})(env))((env("parse-number"))(env("token")));};})(env));env("parse-token",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("token",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("char0",true,arguments[0]);return (false!==((env("peq?"))(env("token"),"("))?(env("push-list"))(env("context")):(false!==((env("peq?"))(env("token"),"#("))?(env("push-vector"))(env("context")):(false!==((env("peq?"))(env("token"),")"))?(env("close-current-list"))(env("context")):(false!==((env("peq?"))(env("token"),"'"))?(env("push-quote"))(env("context")):(false!==((env("peq?"))((env("char-at"))(env("token"),0),"\""))?(env("cons-string"))(env("context"),env("token")):(false!==((env("peq?"))((env("char-at"))(env("token"),0),"#"))?(env("error"))(["parse-token"],"unrecognized type escape",env("token")):(false!==((env("not"))((env("peq?"))((env("char-at"))(env("token"),0),";")))?(env("cons-token"))(env("context"),env("token")):env("true"))))))));};})(env))((env("char-at"))(env("token"),0));};})(env));env("shift-tokens",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);(env("table-set!"))((env("read-tokens"))(env("context")),["vectors"],[]);return (env("table-set!"))((env("read-tokens"))(env("context")),["ref"],0);};})(env));env("parse-tokens",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);env("next-tokens",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("tokens",true,arguments[0]);return (false!==((env("null?"))((env("cdr"))(env("tokens"))))?[]:(false!==((env("eq?"))((env("vlen"))((env("cadr"))(env("tokens"))),0))?(env("next-tokens"))((env("cdr"))(env("tokens"))):(env("cdr"))(env("tokens"))));};})(env));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("tokens",true,arguments[0]);env("ref",true,arguments[1]);env("parse-incomplete",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("token",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("next",true,arguments[0]);env("exit?",true,arguments[1]);(env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (false!==((env("null?"))(env("next")))?(function(){env("exit?",false,env("true"));return env("true");})():(function(){env("token",false,(env("sbappend"))(env("token"),(false!==((env("eq?"))((env("vref"))((env("car"))(env("next")),0),["eof"]))?"\n":(env("vref"))((env("car"))(env("next")),0))));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("token-string",true,arguments[0]);return (false!==((env("token-complete?"))(env("token-string")))?(function(){(env("parse-token"))(env("context"),env("token-string"));env("tokens",false,env("next"));env("ref",false,1);return env("true");})():(function(){env("next",false,(env("next-tokens"))(env("next")));return env("false");})());};})(env))((env("builder->string"))(env("token")));})());};})(env));return env("exit?");};})(env))((env("next-tokens"))(env("tokens")),env("false"));};})(env));return (env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (false!==((env("null?"))(env("tokens")))?(function(){(env("shift-tokens"))(env("context"));return env("true");})():(false!==((env("eq?"))((env("vlen"))((env("car"))(env("tokens"))),env("ref")))?(function(){env("tokens",false,(env("next-tokens"))(env("tokens")));env("ref",false,0);return env("false");})():((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("token",true,arguments[0]);return (false!==((env("eq?"))(env("token"),["eof"]))?(function(){(env("shift-tokens"))(env("context"));return env("true");})():(false!==((env("token-complete?"))(env("token")))?(function(){(env("parse-token"))(env("context"),env("token"));env("ref",false,(env("+"))(env("ref"),1));return env("false");})():(env("parse-incomplete"))((env("sbappend"))((env("make-string-builder"))(),env("token")))));};})(env))((env("vref"))((env("car"))(env("tokens")),env("ref")))));};})(env));};})(env))((env("read-tokens-list"))(env("context")),(env("read-token-ref"))(env("context")));};})(env));env("append-tokens",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("tokens",true,arguments[1]);return (env("table-set!"))((env("read-tokens"))(env("context")),["vectors"],(env("append"))((env("read-tokens-list"))(env("context")),(env("list"))(env("tokens"))));};})(env));env("read-string",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("string",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("tokens",true,arguments[0]);(env("append-tokens"))(env("context"),env("tokens"));return (env("parse-tokens"))(env("context"));};})(env))((env("tokenizer-rx"))(env("string")));};})(env));env("shift-expressions",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("expressions",true,arguments[0]);(env("table-set!"))(env("context"),["expressions"],[]);return (env("reverse"))(env("expressions"));};})(env))((env("read-expressions"))(env("context")));};})(env));env("append-token",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("context",true,arguments[0]);env("token",true,arguments[1]);return (env("append-tokens"))(env("context"),(env("vector"))(env("token")));};})(env));env("read-complete?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("null?"))((env("read-stack"))(env("context"))):env("predicate"));};})(env))((env("null?"))((env("read-tokens-list"))(env("context"))));};})(env));env("complete-read",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);(env("append-token"))(env("context"),["eof"]);(env("parse-tokens"))(env("context"));return (false!==((env("not"))((env("read-complete?"))(env("context"))))?(env("error"))(["complete-read"],"incomplete expression",(env("list"))((env("read-tokens-list"))(env("context")),(env("read-stack"))(env("context")))):(env("shift-expressions"))(env("context")));};})(env));env("complete-read",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);(env("append-token"))(env("context"),["eof"]);(env("parse-tokens"))(env("context"));return (false!==((env("not"))((env("null?"))((env("read-tokens-list"))(env("context")))))?(env("error"))(["complete-read"],"incomplete expression",(env("read-tokens-list"))(env("context"))):(false!==((env("not"))((env("null?"))((env("read-stack"))(env("context")))))?(env("error"))(["complete-read"],"incomplete expression",(env("read-stack"))(env("context"))):(env("shift-expressions"))(env("context"))));};})(env));env("sread",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("string",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("context",true,arguments[0]);(env("read-string"))(env("context"),env("string"));return (env("complete-read"))(env("context"));};})(env))((env("make-read-context"))());};})(env));env("command?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("arg",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("peq?"))(env("arg"),"compile"));};})(env))((env("peq?"))(env("arg"),"test")));};})(env))((env("peq?"))(env("arg"),"run")));};})(env))((env("peq?"))(env("arg"),"repl"));};})(env));env("explicit-command?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("argv",true,arguments[0]);return (env("command?"))((env("caddr"))(env("argv")));};})(env));env("compiled-run?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("compiled-procedure?"))(env("get-command"));};})(env));env("get-command-from",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("argv",true,arguments[0]);return (false!==((env("null?"))((env("cddr"))(env("argv"))))?"repl":(false!==((env("command?"))((env("caddr"))(env("argv"))))?(env("caddr"))(env("argv")):"run"));};})(env));env("get-arg-from",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("argv",true,arguments[0]);return (false!==((env("null?"))((env("cddr"))(env("argv"))))?(env("error"))(["get-arg-from"],"missing argument",env("argv")):(false!==((env("explicit-command?"))(env("argv")))?(false!==((env("null?"))((env("cdddr"))(env("argv"))))?(env("error"))(["get-arg-from"],"missing argument",env("argv")):(env("cadddr"))(env("argv"))):(env("caddr"))(env("argv"))));};})(env));env("argv-member",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("op",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("argv",true,arguments[0]);return (false!==((env("compiled-run?"))())?(env("op"))(env("argv")):(false!==((env("explicit-command?"))(env("argv")))?(env("op"))((env("cddr"))(env("argv"))):(env("op"))((env("cdr"))(env("argv")))));};})(env))((env("proc-argv"))());};})(env));env("get-command",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("argv-member"))(env("get-command-from"));};})(env));env("get-arg",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("argv-member"))(env("get-arg-from"));};})(env));env("repl",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("env",true,(env("create-env"))());env("try-eval-sequence",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exps",true,arguments[0]);return (false!==((env("not"))((env("null?"))(env("exps"))))?(function(){(env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("print"))((env("eval-env"))(env("env"),(env("car"))(env("exps"))));};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("err",true,arguments[0]);return (env("display"))(env("err"));};})(env));(env("newline"))();return (env("try-eval-sequence"))((env("cdr"))(env("exps")));})():env("true"));};})(env));env("read-context",true,(env("make-read-context"))());env("process-line",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("rl",true,arguments[0]);env("line",true,arguments[1]);(env("read-string"))(env("read-context"),env("line"));(env("try-eval-sequence"))((env("shift-expressions"))(env("read-context")));(env("set-prompt"))(env("rl"),(false!==((env("read-complete?"))(env("read-context")))?"> ":". "));return (env("prompt"))(env("rl"));};})(env));env("rl",true,(env("read-line"))(env("process-line"),"> "));(env("set-prompt"))(env("rl"),"> ");return (env("prompt"))(env("rl"));};})(env));env("run",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("read-and-eval",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scm",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ctx",true,arguments[0]);(env("read-string"))(env("ctx"),env("scm"));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exps",true,arguments[0]);(env("complete-read"))(env("ctx"));return (env("eval-env"))((env("create-env"))(),(env("list"))((env("cons"))(["lambda"],(env("cons"))([],env("exps")))));};})(env))((env("shift-expressions"))(env("ctx")));};})(env))((env("make-read-context"))());};})(env));return (env("read-file"))((env("get-arg"))(),env("read-and-eval"));};})(env));env("compile",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("precompile",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===5)?false:env("cerror")("arguments","invalid arity",5);env("head",true,arguments[0]);env("done",true,arguments[1]);env("ccontext",true,arguments[2]);env("pcontext",true,arguments[3]);env("shared",true,arguments[4]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("shared-names",true,arguments[0]);return (false!==((env("not"))((env("null?"))(env("shared-names"))))?((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);(false!==(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?(env("table-has-name?"))((env("compile-expressions"))(env("ccontext")),env("name")):env("predicate"));};})(env))((env("not"))((env("table-has-name?"))(env("done"),env("name")))))?(function(){(env("compile-statement"))(env("pcontext"),(env("precompile-exp"))((env("table-lookup"))((env("compile-expressions"))(env("ccontext")),env("name"))));return (env("copy-table-filtered"))((env("table-lookup"))((env("compile-definitions"))(env("ccontext")),env("name")),env("shared"),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("name",true,arguments[0]);return (env("not"))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("defined?"))(env("head"),env("name")));};})(env))((env("table-has-name?"))(env("done"),env("name"))));};})(env));})():env("true"));(env("table-define"))(env("done"),env("name"),env("true"));(env("table-delete!"))(env("shared"),env("name"));return (env("precompile"))(env("head"),env("done"),env("ccontext"),env("pcontext"),env("shared"));};})(env))((env("car"))(env("shared-names"))):env("true"));};})(env))((env("table-names"))(env("shared")));};})(env));env("read-and-compile",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("names",true,arguments[0]);env("scm",true,arguments[1]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("read-context",true,arguments[0]);env("ccontext",true,arguments[1]);(env("read-string"))(env("read-context"),env("scm"));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exps",true,arguments[0]);(env("complete-read"))(env("read-context"));(env("compile-sequence"))(env("ccontext"),env("exps"));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("pcontext",true,arguments[0]);(env("compile-statement"))(env("pcontext"),[["define"],[["shared-precompiled"],[[["quote"],[[],[]]],[]]]]);(env("precompile"))((env("extend-env"))(env("lang")),(env("make-name-table"))(),env("ccontext"),env("pcontext"),(env("to-table"))((env("shared"))(),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("i",true,arguments[0]);return (env("car"))(env("i"));};})(env),env("identity")));(env("out"))((env("builder->string"))((env("compile-buffer"))(env("pcontext"))));return (env("out"))((env("builder->string"))((env("compile-buffer"))(env("ccontext"))));};})(env))((env("make-compile-context"))(env("names")));};})(env))((env("shift-expressions"))(env("read-context")));};})(env))((env("make-read-context"))(),(env("make-compile-context"))(env("names")));};})(env));return (env("compile-head"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("names",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("ccontext",true,arguments[0]);(env("compile-shared"))(env("ccontext"));(env("out"))((env("builder->string"))((env("compile-buffer"))(env("ccontext"))));return (env("read-file"))((env("get-arg"))(),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("scm",true,arguments[0]);return (env("read-and-compile"))(env("names"),env("scm"));};})(env));};})(env))((env("make-compile-context"))(env("names")));};})(env))((env("make-name-map"))());};})(env));};})(env));env("caar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))(env("l")));};})(env));env("cadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))(env("l")));};})(env));env("cdar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))(env("l")));};})(env));env("cddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))(env("l")));};})(env));env("caaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))(env("l"))));};})(env));env("caadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))(env("l"))));};})(env));env("cadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))(env("l"))));};})(env));env("cdaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))(env("l"))));};})(env));env("caddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))(env("l"))));};})(env));env("cdadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))(env("l"))));};})(env));env("cddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))(env("l"))));};})(env));env("cdddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))(env("l"))));};})(env));env("caaaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))((env("car"))(env("l")))));};})(env));env("caaadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("caadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cadaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))((env("car"))(env("l")))));};})(env));env("cdaaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))((env("car"))(env("l")))));};})(env));env("caaddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("car"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cadadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("cdaadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("caddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cdadar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cddaar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))((env("car"))(env("l")))));};})(env));env("cadddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("car"))((env("cdr"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cdaddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("car"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("cddadr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("car"))((env("cdr"))(env("l")))));};})(env));env("cdddar",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))((env("car"))(env("l")))));};})(env));env("cddddr",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("l",true,arguments[0]);return (env("cdr"))((env("cdr"))((env("cdr"))((env("cdr"))(env("l")))));};})(env));env("shared",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("list"))((env("list"))(["eval"],env("eval")),(env("list"))(["apply"],env("apply")),(env("list"))(["log"],env("log")),(env("list"))(["print"],env("print")),(env("list"))(["eq?"],env("eq?")),(env("list"))(["newline"],env("newline")),(env("list"))(["error"],env("error")),(env("list"))(["not"],env("not")),(env("list"))(["make-name-table"],env("make-name-table")),(env("list"))(["table-define"],env("table-define")),(env("list"))(["table-lookup"],env("table-lookup")),(env("list"))(["table-set!"],env("table-set!")),(env("list"))(["append"],env("append")),(env("list"))(["sprint"],env("sprint")),(env("list"))(["reverse"],env("reverse")),(env("list"))(["display"],env("display")),(env("list"))(["sescape"],env("sescape")),(env("list"))(["caar"],env("caar")),(env("list"))(["cadr"],env("cadr")),(env("list"))(["cdar"],env("cdar")),(env("list"))(["cddr"],env("cddr")),(env("list"))(["caaar"],env("caaar")),(env("list"))(["caadr"],env("caadr")),(env("list"))(["cadar"],env("cadar")),(env("list"))(["cdaar"],env("cdaar")),(env("list"))(["caddr"],env("caddr")),(env("list"))(["cdadr"],env("cdadr")),(env("list"))(["cddar"],env("cddar")),(env("list"))(["cdddr"],env("cdddr")),(env("list"))(["caaaar"],env("caaaar")),(env("list"))(["caaadr"],env("caaadr")),(env("list"))(["caadar"],env("caadar")),(env("list"))(["cadaar"],env("cadaar")),(env("list"))(["cdaaar"],env("cdaaar")),(env("list"))(["caaddr"],env("caaddr")),(env("list"))(["cadadr"],env("cadadr")),(env("list"))(["cdaadr"],env("cdaadr")),(env("list"))(["caddar"],env("caddar")),(env("list"))(["cdadar"],env("cdadar")),(env("list"))(["cddaar"],env("cddaar")),(env("list"))(["cadddr"],env("cadddr")),(env("list"))(["cdaddr"],env("cdaddr")),(env("list"))(["cddadr"],env("cddadr")),(env("list"))(["cdddar"],env("cdddar")),(env("list"))(["cddddr"],env("cddddr")));};})(env));env("create-env",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("list->table",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("t",true,arguments[0]);env("l",true,arguments[1]);return (false!==((env("null?"))(env("l")))?env("t"):(function(){(env("table-define"))(env("t"),(env("caar"))(env("l")),(env("cadar"))(env("l")));return (env("list->table"))(env("t"),(env("cdr"))(env("l")));})());};})(env));return (env("extend-env"))(env("lang"),(env("list->table"))((env("make-name-table"))(),(env("shared"))()));};})(env));((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("cmd",true,arguments[0]);return (false!==((env("peq?"))(env("cmd"),"repl"))?(env("repl"))():(false!==((env("peq?"))(env("cmd"),"run"))?(env("run"))():(false!==((env("peq?"))(env("cmd"),"compile"))?(env("compile"))():env("true"))));};})(env))((env("get-command"))());env("last-test-name",true,env("false"));env("string-contains?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("val",true,arguments[0]);env("pattern",true,arguments[1]);return (env(">="))((env("sidx"))((env("sprint"))(env("val")),env("pattern")),0);};})(env));env("list-eq?",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("left",true,arguments[0]);env("right",true,arguments[1]);return (false!==(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("predicate"):(env("not"))((env("pair?"))(env("right"))));};})(env))((env("not"))((env("pair?"))(env("left")))))?(env("eq?"))(env("left"),env("right")):(false!==((env("not"))((env("list-eq?"))((env("car"))(env("left")),(env("car"))(env("right")))))?env("false"):(env("list-eq?"))((env("cdr"))(env("left")),(env("cdr"))(env("right")))));};})(env));env("assert",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("val",true,arguments[0]);env("msg",true,arguments[1]);return (false!==(env("val"))?env("val"):(function(){(env("print"))((env("cats"))(env("last-test-name"),": failed: ",env("msg")));return (env("exit"))(-1);})());};})(env));env("fail",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("msg",true,arguments[0]);env("f",true,arguments[1]);return (env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);(env("f"))();return (env("assert"))(env("false"),env("msg"));};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("error",true,arguments[0]);return (false!==((env("not"))((env("string-contains?"))(env("error"),env("msg"))))?(function(){(env("print-stack"))(env("error"));return (env("assert"))(env("false"),env("msg"));})():env("true"));};})(env));};})(env));env("test",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===2)?false:env("cerror")("arguments","invalid arity",2);env("name",true,arguments[0]);env("f",true,arguments[1]);env("last-test-name",false,env("name"));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("env",true,arguments[0]);return (env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("f"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("exp",true,arguments[0]);return (env("eval-env"))(env("env"),env("exp"));};})(env));};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("error",true,arguments[0]);(env("print"))((env("cats"))(env("name"),": error during test:"));(env("print-stack"))(env("error"));return (env("exit"))();};})(env));};})(env))((env("create-env"))());};})(env));env("run-tests",true,(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);(env("test"))("symbol?",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("symbol?"))(["a"]),"true");return (env("assert"))((env("not"))((env("symbol?"))("a")),"false");};})(env));(env("test"))("len",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("len"))([1,[2,[3,[]]]]),3),"3");return (env("assert"))((env("eq?"))((env("len"))([]),0),"0");};})(env));(env("test"))("quote-eq?",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("quote-eq?"))([["quote"],[["a"],[]]],[["quote"],[["a"],[]]]),"eq");return (env("assert"))((env("not"))((env("quote-eq?"))([["quote"],[["a"],[]]],[["quote"],[["b"],[]]])),"not eq");};})(env));(env("test"))("eq",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))([],[]),"null");(env("assert"))((env("eq?"))(["a"],["a"]),"symbol");(env("assert"))((env("eq?"))([["quote"],[["a"],[]]],[["quote"],[["a"],[]]]),"quote");(env("assert"))((env("eq?"))(1,1),"primitive");return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("a",true,arguments[0]);return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("b",true,arguments[0]);return (env("assert"))((env("eq?"))(env("a"),env("b")),"reference");};})(env))(env("a"));};})(env))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return 1;};})(env));};})(env));(env("test"))("tagged-list?",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("tagged-list?"))((env("list"))(["a"]),["a"]),"true");(env("assert"))((env("not"))((env("tagged-list?"))((env("list"))(["a"]),["b"])),"wrong tag");return (env("assert"))((env("not"))((env("tagged-list?"))(1,["a"])),"not list");};})(env));(env("test"))("check-quote",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);return (env("assert"))((env("eq?"))((env("check-quote"))((env("list"))(["quote"],["a"])),env("true")),"ok");};})(env));(env("test"))("escape",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("sescape"))("\b\t\v\f\n\r\\\""),"\\b\\t\\v\\f\\n\\r\\\\\\\""),"escape");(env("assert"))((env("list-eq?"))((env("sread"))("\"\b\t\v\f\n\r\\\\\\\"\""),["\b\t\v\f\n\r\\\"",[]]),"read");(env("assert"))((env("eq?"))((env("sunescape"))("\\b\\t\\v\\f\\n\\r\\\\\\\""),"\b\t\v\f\n\r\\\""),"unescape");(env("assert"))((env("list-eq?"))((env("sread"))("\"\\b\\t\\v\\f\\n\\r\\\\\\\"\""),["\b\t\v\f\n\r\\\"",[]]),"read escaped");(env("assert"))((env("eq?"))((env("sescape-symbol-name"))("a"),"a"),"symbol name normal");return (env("assert"))((env("eq?"))((env("sescape-symbol-name"))("a\na"),"|a\na|"),"symbol name escaped");};})(env));(env("test"))("sprint",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("sprint"))(1),"1"),"number");(env("assert"))((env("eq?"))((env("sprint"))("some string"),"\"some string\""),"string");(env("assert"))((env("eq?"))((env("sprint"))("some string with \"apostrophs\" in it"),"\"some string with \\\"apostrophs\\\" in it\""),"string, apostrophs");(env("assert"))((env("eq?"))((env("sprint"))(["a"]),"'a"),"quote");(env("assert"))((env("eq?"))((env("sprint"))([["a"],[["b"],[["c"],[]]]]),"'(a b c)"),"list");(env("assert"))((env("eq?"))((env("sprint"))([["a"],[["b"],[[["c"],[[["quote"],[["d"],[]]],[]]],[]]]]),"'(a b (c 'd))"),"list, embedded list");(env("assert"))((env("eq?"))((env("sprint"))([["a"],[["b"],[[["quote"],[[["c"],[[["quote"],[["d"],[]]],[]]],[]]],[]]]]),"'(a b '(c 'd))"),"list, embedded quoted list");return (env("assert"))((env("eq?"))((env("sprint"))([["a"],[["b"],[[["quote"],[[["c"],[[["quote"],[["d"],[]]],[[["quote"],[[["quote"],[["d"],[]]],[]]],[]]]],[]]],[]]]]),"'(a b '(c 'd ''d))"),"list, double quote");};})(env));(env("test"))("self-evaluating?",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("self-evaluating?"))(env("false")),"false");(env("assert"))((env("self-evaluating?"))(env("true")),"true");(env("assert"))((env("self-evaluating?"))(1),"number");(env("assert"))((env("self-evaluating?"))("some string"),"string");return (env("assert"))((env("not"))((env("self-evaluating?"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return env("false");};})(env))),"lambda");};})(env));(env("test"))("check-assignment",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("check-assignment"))((env("list"))(["set!"],["a"],1)),env("true")),"valid");(env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-assignment"))((env("list"))(["set!"],["a"]));};})(env));return (env("fail"))("invalid variable name",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-assignment"))((env("list"))(["set!"],1,1));};})(env));};})(env));(env("test"))("definition-variable",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("definition-variable"))((env("list"))(["define"],["a"],1)),["a"]),"variable");return (env("assert"))((env("eq?"))((env("definition-variable"))((env("list"))(["define"],(env("list"))(["a"]),1)),["a"]),"procedure");};})(env));(env("test"))("definition-value",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("definition-value"))((env("list"))(["define"],["a"],1)),1),"variable");return (env("assert"))((env("list-eq?"))((env("definition-value"))((env("list"))(["define"],(env("list"))(["a"]),1,2)),(env("list"))(["lambda"],[],1,2)),"procedure");};})(env));(env("test"))("check-definition",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("check-definition"))((env("list"))(["define"],["a"],1)),env("true")),"variable");(env("assert"))((env("eq?"))((env("check-definition"))((env("list"))(["define"],(env("list"))(["a"]),1)),env("true")),"procedure");(env("fail"))("invalid format",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-definition"))((env("list"))(["define"],["a"]));};})(env));return (env("fail"))("invalid variable name",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-definition"))((env("list"))(["define"],(env("list"))(1),1));};})(env));};})(env));(env("test"))("validate-if",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("check-if"))((env("list"))(["if"],1,2,3)),env("true")),"valid");return (env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-if"))((env("list"))(["if"],1,2,3,4));};})(env));};})(env));(env("test"))("check-lambda",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("check-lambda"))((env("list"))(["lambda"],[],1)),env("true")),"valid");(env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-lambda"))((env("list"))(["lambda"],[]));};})(env));return (env("fail"))("invalid argument list",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-lambda"))((env("list"))(["lambda"],1,2));};})(env));};})(env));(env("test"))("validate-begin",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("check-begin"))((env("list"))(["begin"],1)),"valid");return (env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-begin"))((env("list"))(["begin"]));};})(env));};})(env));(env("test"))("sequence->exp",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("sequence->exp"))([]),[]),"null");(env("assert"))((env("eq?"))((env("sequence->exp"))([1,[]]),1),"single item");return (env("assert"))((env("list-eq?"))((env("sequence->exp"))([1,[2,[]]]),[["begin"],[1,[2,[]]]]),"sequence");};})(env));(env("test"))("expand-clauses",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("list-eq?"))((env("expand-clauses"))([[1,[1,[]]],[[2,[2,[]]],[[["else"],[3,[]]],[]]]]),[["if"],[1,[1,[[["if"],[2,[2,[3,[]]]]],[]]]]]),"ok");(env("fail"))("invalid syntax",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("expand-clauses"))([1,[[2,[2,[]]],[[["else"],[3,[]]],[]]]]);};})(env));return (env("fail"))("else clause isn't last",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("expand-clauses"))([[1,[1,[]]],[[["else"],[2,[]]],[[3,[3,[]]],[]]]]);};})(env));};})(env));(env("test"))("expand-and",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("list-eq?"))((env("expand-and"))([]),["true"]),"null");return (env("assert"))((env("list-eq?"))((env("expand-and"))([1,[2,[3,[]]]]),[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[3,[["predicate"],[]]]]],[]]]],[2,[]]],[["predicate"],[]]]]],[]]]],[1,[]]]),"list");};})(env));(env("test"))("expand-or",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("list-eq?"))((env("expand-or"))([]),["false"]),"null");return (env("assert"))((env("list-eq?"))((env("expand-or"))([1,[2,[3,[]]]]),[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[[[["lambda"],[[["predicate"],[]],[[["if"],[["predicate"],[["predicate"],[3,[]]]]],[]]]],[2,[]]],[]]]]],[]]]],[1,[]]]),"list");};})(env));(env("test"))("validate-let",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);(env("assert"))((env("eq?"))((env("check-let"))([["let"],[[[["a"],[1,[]]],[]],[["a"],[]]]]),env("true")),"ok");(env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-let"))([["let"],[[[["a"],[1,[]]],[]],[]]]);};})(env));return (env("fail"))("invalid syntax",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("check-let"))([["let"],[1,[1,[]]]]);};})(env));};})(env));(env("test"))("let->procedure",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("_",true,arguments[0]);return (env("assert"))((env("list-eq?"))((env("let->procedure"))([["let"],[[[["a"],[1,[]]],[]],[["a"],[]]]]),[[["lambda"],[[["a"],[]],[["a"],[]]]],[1,[]]]),"transform");};})(env));(env("test"))("false, true",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))(["false"]),env("false")),"false");return (env("assert"))((env("eq?"))((env("eval"))(["true"]),env("true")),"true");};})(env));(env("test"))("self evaluation",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))(1),1),"number");return (env("assert"))((env("eq?"))((env("eval"))("some string"),"some string"),"string");};})(env));(env("test"))("variable",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("fail"))(".*",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))(["a"]);};})(env));(env("assert"))((env("eq?"))((env("eval"))([["define"],[["a"],[1,[]]]]),1),"definition");return (env("assert"))((env("eq?"))((env("eval"))(["a"]),1),"lookup");};})(env));(env("test"))("quote",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("fail"))("invalid quotation",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["quote"],[]]);};})(env));(env("assert"))((env("eq?"))((env("eval"))(1),1),"number");(env("assert"))((env("eq?"))((env("eval"))("some string"),"some string"),"string");return (env("assert"))((env("eq?"))((env("eval"))([["quote"],[["a"],[]]]),["a"]),"quote");};})(env));(env("test"))("assignment",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["define"],[["a"],[1,[]]]]),1),"define");(env("assert"))((env("eq?"))((env("eval"))([["set!"],[["a"],[2,[]]]]),2),"assign");(env("assert"))((env("eq?"))((env("eval"))(["a"]),2),"lookup");(env("assert"))((env("eq?"))((env("eval"))([[["lambda"],[[],[[["define"],[["a"],[3,[]]]],[[["set!"],[["a"],[4,[]]]],[["a"],[]]]]]],[]]),4),"in lambda");return (env("assert"))((env("eq?"))((env("eval"))([["apply"],[[["lambda"],[[],[[["define"],[["a"],[3,[]]]],[[["set!"],[["a"],[4,[]]]],[["a"],[]]]]]],[[["quote"],[[],[]]],[]]]]),4),"in apply");};})(env));(env("test"))("define",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["define"],[["a"],[1,[]]]]),1),"define variable");(env("assert"))((env("eq?"))((env("eval"))(["a"]),1),"verify variable");return (env("eval"))([["define"],[[["a"],[]],[2,[]]]]);};})(env));(env("test"))("if",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["if"],[["false"],[1,[0,[]]]]]),0),"false");(env("assert"))((env("eq?"))((env("eval"))([["if"],[["true"],[1,[0,[]]]]]),1),"true");return (env("assert"))((env("eq?"))((env("eval"))([["if"],["anything else",[1,[0,[]]]]]),1),"anything else");};})(env));(env("test"))("lambda",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);return (env("assert"))((env("eq?"))((env("eval"))([[["lambda"],[[],[1,[]]]],[]]),1),"create and call lambda");};})(env));(env("test"))("begin",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["begin"],[[["define"],[["a"],[1,[]]]],[2,[]]]]),2),"execute sequence");(env("assert"))((env("eq?"))((env("eval"))(["a"]),1),"verify side effect");return (env("fail"))("arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["begin"],[]]);};})(env));};})(env));(env("test"))("cond",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["cond"],[[["true"],[0,[]]],[[["false"],[1,[]]],[[["else"],[2,[]]],[]]]]]),0),"first");(env("assert"))((env("eq?"))((env("eval"))([["cond"],[[["false"],[0,[]]],[[["true"],[1,[]]],[[["else"],[2,[]]],[]]]]]),1),"second");(env("assert"))((env("eq?"))((env("eval"))([["cond"],[[["false"],[0,[]]],[[["false"],[1,[]]],[[["else"],[2,[]]],[]]]]]),2),"else");(env("assert"))((env("eq?"))((env("eval"))([["cond"],[]]),env("true")),"no clauses");(env("assert"))((env("eq?"))((env("eval"))([["cond"],[[["false"],[]],[]]]),env("true")),"implicit else clause");return (env("fail"))("invalid syntax",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["cond"],[1,[]]]);};})(env));};})(env));(env("test"))("and",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["and"],[]]),env("true")),"no expression");(env("assert"))((env("eq?"))((env("eval"))([["and"],[["false"],[]]]),env("false")),"single, false");(env("assert"))((env("eq?"))((env("eval"))([["and"],[["true"],[]]]),env("true")),"single, true");(env("assert"))((env("eq?"))((env("eval"))([["and"],["something",[]]]),"something"),"single, string");(env("assert"))((env("eq?"))((env("eval"))([["and"],[1,[2,[]]]]),2),"two");(env("assert"))((env("eq?"))((env("eval"))([["and"],[1,[2,[3,[]]]]]),3),"three");(env("assert"))((env("eq?"))((env("eval"))([["and"],[1,[2,[["false"],[]]]]]),env("false")),"three, false");(env("assert"))((env("eq?"))((env("eval"))([["and"],[1,[["false"],[2,[]]]]]),env("false")),"two, false");return (env("assert"))((env("eq?"))((env("eval"))([["and"],[["false"],[1,[2,[]]]]]),env("false")),"one, false");};})(env));(env("test"))("or",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["or"],[]]),env("false")),"no expression");(env("assert"))((env("eq?"))((env("eval"))([["or"],[["false"],[]]]),env("false")),"single, false");(env("assert"))((env("eq?"))((env("eval"))([["or"],[["true"],[]]]),env("true")),"single, true");(env("assert"))((env("eq?"))((env("eval"))([["or"],["something",[]]]),"something"),"something");(env("assert"))((env("eq?"))((env("eval"))([["or"],[1,[]]]),1),"number");(env("assert"))((env("eq?"))((env("eval"))([["or"],[1,[2,[]]]]),1),"two");(env("assert"))((env("eq?"))((env("eval"))([["or"],[1,[2,[3,[]]]]]),1),"three");(env("assert"))((env("eq?"))((env("eval"))([["or"],[1,[["false"],[]]]]),1),"first");(env("assert"))((env("eq?"))((env("eval"))([["or"],[["false"],[1,[]]]]),1),"second");return (env("assert"))((env("eq?"))((env("eval"))([["or"],[["false"],[["false"],[1,[]]]]]),1),"third");};})(env));(env("test"))("let",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([["let"],[[[["a"],[1,[]]],[[["b"],[2,[]]],[]]],[["b"],[["a"],[]]]]]),1),"sequence");(env("assert"))((env("eq?"))((env("eval"))([["let"],[[[["a"],[1,[]]],[[["b"],[2,[]]],[]]],[[["and"],[["a"],[["b"],[]]]],[]]]]),2),"operation");(env("fail"))("invalid arity",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["let"],[]]);};})(env));(env("fail"))("invalid syntax",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["let"],[1,[2,[3,[]]]]]);};})(env));return (env("fail"))(".*",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("eval"))([["let"],[[1,[]],[2,[3,[]]]]]);};})(env));};})(env));(env("test"))("application",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("eval"))([[["lambda"],[[],[1,[]]]],[]]),1),"lambda");(env("eval"))([["define"],[[["a"],[]],[1,[]]]]);(env("assert"))((env("eq?"))((env("eval"))([["a"],[]]),1),"procedure from shortcut");(env("eval"))([["define"],[["a"],[[["lambda"],[[],[2,[]]]],[]]]]);(env("assert"))((env("eq?"))((env("eval"))([["a"],[]]),2),"procedure from variable");(env("eval"))([["define"],[[["a"],[["x"],[]]],[[["if"],[["x"],["it's true",["it's false",[]]]]],[]]]]);(env("assert"))((env("eq?"))((env("eval"))([["a"],[["true"],[]]]),"it's true"),"with args, true");(env("assert"))((env("eq?"))((env("eval"))([["a"],[["false"],[]]]),"it's false"),"with args, false");return (env("assert"))((env("eq?"))((env("eval"))([["a"],["just anything",[]]]),"it's true"),"with args, anything");};})(env));(env("test"))("primitive procedures",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);return (env("assert"))((env("eq?"))((env("eval"))([["+"],[1,[2,[]]]]),3),"add");};})(env));(env("test"))("try",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return 1;};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("err",true,arguments[0]);return 2;};})(env)),1),"try");(env("assert"))((env("eq?"))((env("try"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return (env("error"))(["try"],"err","test");};})(env),(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("err",true,arguments[0]);return 1;};})(env)),1),"catch");(env("assert"))((env("eq?"))((env("eval"))([["try"],[[["lambda"],[[],[1,[]]]],[[["lambda"],[[["err"],[]],[2,[]]]],[]]]]),1),"eval, try");(env("assert"))((env("eq?"))((env("eval"))([["try"],[[["lambda"],[[],[[["error"],[[["quote"],[["try"],[]]],["err",["test",[]]]]],[]]]],[[["lambda"],[[["err"],[]],[1,[]]]],[]]]]),1),"eval, catch");(env("assert"))((env("eq?"))((env("eval"))([["try"],[[["lambda"],[[],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]]],[[["lambda"],[[["err"],[]],[2,[]]]],[]]]]),1),"primitive call, try");return (env("assert"))((env("eq?"))((env("eval"))([["try"],[[["lambda"],[[],[[["error"],[[["quote"],[["try"],[]]],["err",["test",[]]]]],[]]]],[[["lambda"],[[["error"],[]],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]]],[]]]]),1),"primitive call, catch");};})(env));(env("test"))("for",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("eq?"))((env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);return env("true");};})(env)),env("true")),"exit immediately");(env("assert"))((env("eq?"))(((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("n",true,arguments[0]);return (env("for"))((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===0)?false:env("cerror")("arguments","invalid arity",0);env("n",false,(env("+"))(env("n"),1));return ((function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("predicate",true,arguments[0]);return (false!==(env("predicate"))?env("n"):env("predicate"));};})(env))((env(">"))(env("n"),2));};})(env));};})(env))(0),3),"count to 3");(env("assert"))((env("eq?"))((env("eval"))([["for"],[[["lambda"],[[],[["true"],[]]]],[]]]),env("true")),"eval, exit immediately");return (env("assert"))((env("eq?"))((env("eval"))([["let"],[[[["n"],[0,[]]],[]],[[["for"],[[["lambda"],[[],[[["set!"],[["n"],[[["+"],[["n"],[1,[]]]],[]]]],[[["and"],[[[">"],[["n"],[2,[]]]],[["n"],[]]]],[]]]]],[]]],[]]]]),3),"eval, count to 3");};})(env));(env("test"))("eval",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);return (env("assert"))((env("eq?"))((env("eval"))([["eval"],[[["quote"],[[["car"],[[["quote"],[[1,[2,[]]],[]]],[]]],[]]],[]]]),1),"inner eval");};})(env));(env("test"))("apply",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);return (env("assert"))((env("eq?"))((env("eval"))([["apply"],[["car"],[[["quote"],[[[1,[2,[]]],[]],[]]],[]]]]),1),"inner apply");};})(env));(env("test"))("vector",(function(penv){return function(){var env=penv("extend-env")(penv);(arguments.length===1)?false:env("cerror")("arguments","invalid arity",1);env("eval",true,arguments[0]);(env("assert"))((env("vector?"))({vector:[1,2,3]}),"vector literal");(env("assert"))((env("vector?"))((env("car"))((env("sread"))("#(1 2 3)"))),"read vector");(env("assert"))((env("vector?"))((env("eval"))((env("car"))((env("sread"))("#(1 2 3)")))),"eval vector");(env("assert"))((env("eq?"))((env("sprint"))((env("car"))((env("sread"))("#(1 2 3)"))),"#(1 2 3)"),"print vector");return (env("assert"))((env("eq?"))((env("sprint"))((env("car"))((env("sread"))("'(a b #(1 2 (1 2 3) c #(1 2 3 4)))"))),"'(a b #(1 2 (1 2 3) c #(1 2 3 4)))"),"compose vector");};})(env));return ["end-tests"];};})(env));return (false!==((env("peq?"))((env("get-command"))(),"test"))?(env("run-tests"))():env("true"));